var Cw=Object.defineProperty;var Pw=(t,e,n)=>e in t?Cw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var d=(t,e,n)=>Pw(t,typeof e!="symbol"?e+"":e,n);function xw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var CD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Iw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sm={exports:{}},Bl={},Am={exports:{}},Q={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var co=Symbol.for("react.element"),Mw=Symbol.for("react.portal"),kw=Symbol.for("react.fragment"),Nw=Symbol.for("react.strict_mode"),Ow=Symbol.for("react.profiler"),Dw=Symbol.for("react.provider"),Fw=Symbol.for("react.context"),Uw=Symbol.for("react.forward_ref"),Bw=Symbol.for("react.suspense"),Lw=Symbol.for("react.memo"),Vw=Symbol.for("react.lazy"),Zd=Symbol.iterator;function zw(t){return t===null||typeof t!="object"?null:(t=Zd&&t[Zd]||t["@@iterator"],typeof t=="function"?t:null)}var Rm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},bm=Object.assign,Cm={};function ji(t,e,n){this.props=t,this.context=e,this.refs=Cm,this.updater=n||Rm}ji.prototype.isReactComponent={};ji.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ji.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Pm(){}Pm.prototype=ji.prototype;function of(t,e,n){this.props=t,this.context=e,this.refs=Cm,this.updater=n||Rm}var af=of.prototype=new Pm;af.constructor=of;bm(af,ji.prototype);af.isPureReactComponent=!0;var Qd=Array.isArray,xm=Object.prototype.hasOwnProperty,lf={current:null},Im={key:!0,ref:!0,__self:!0,__source:!0};function Mm(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)xm.call(e,r)&&!Im.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:co,type:t,key:s,ref:o,props:i,_owner:lf.current}}function jw(t,e){return{$$typeof:co,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cf(t){return typeof t=="object"&&t!==null&&t.$$typeof===co}function Hw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Jd=/\/+/g;function Ec(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Hw(""+t.key):e.toString(36)}function fa(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case co:case Mw:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ec(o,0):r,Qd(i)?(n="",t!=null&&(n=t.replace(Jd,"$&/")+"/"),fa(i,e,n,"",function(c){return c})):i!=null&&(cf(i)&&(i=jw(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Jd,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Qd(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Ec(s,a);o+=fa(s,e,n,l,i)}else if(l=zw(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Ec(s,a++),o+=fa(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Oo(t,e,n){if(t==null)return t;var r=[],i=0;return fa(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Ww(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ke={current:null},da={transition:null},$w={ReactCurrentDispatcher:Ke,ReactCurrentBatchConfig:da,ReactCurrentOwner:lf};function km(){throw Error("act(...) is not supported in production builds of React.")}Q.Children={map:Oo,forEach:function(t,e,n){Oo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Oo(t,function(){e++}),e},toArray:function(t){return Oo(t,function(e){return e})||[]},only:function(t){if(!cf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Q.Component=ji;Q.Fragment=kw;Q.Profiler=Ow;Q.PureComponent=of;Q.StrictMode=Nw;Q.Suspense=Bw;Q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$w;Q.act=km;Q.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=bm({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=lf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)xm.call(e,l)&&!Im.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:co,type:t.type,key:i,ref:s,props:r,_owner:o}};Q.createContext=function(t){return t={$$typeof:Fw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Dw,_context:t},t.Consumer=t};Q.createElement=Mm;Q.createFactory=function(t){var e=Mm.bind(null,t);return e.type=t,e};Q.createRef=function(){return{current:null}};Q.forwardRef=function(t){return{$$typeof:Uw,render:t}};Q.isValidElement=cf;Q.lazy=function(t){return{$$typeof:Vw,_payload:{_status:-1,_result:t},_init:Ww}};Q.memo=function(t,e){return{$$typeof:Lw,type:t,compare:e===void 0?null:e}};Q.startTransition=function(t){var e=da.transition;da.transition={};try{t()}finally{da.transition=e}};Q.unstable_act=km;Q.useCallback=function(t,e){return Ke.current.useCallback(t,e)};Q.useContext=function(t){return Ke.current.useContext(t)};Q.useDebugValue=function(){};Q.useDeferredValue=function(t){return Ke.current.useDeferredValue(t)};Q.useEffect=function(t,e){return Ke.current.useEffect(t,e)};Q.useId=function(){return Ke.current.useId()};Q.useImperativeHandle=function(t,e,n){return Ke.current.useImperativeHandle(t,e,n)};Q.useInsertionEffect=function(t,e){return Ke.current.useInsertionEffect(t,e)};Q.useLayoutEffect=function(t,e){return Ke.current.useLayoutEffect(t,e)};Q.useMemo=function(t,e){return Ke.current.useMemo(t,e)};Q.useReducer=function(t,e,n){return Ke.current.useReducer(t,e,n)};Q.useRef=function(t){return Ke.current.useRef(t)};Q.useState=function(t){return Ke.current.useState(t)};Q.useSyncExternalStore=function(t,e,n){return Ke.current.useSyncExternalStore(t,e,n)};Q.useTransition=function(){return Ke.current.useTransition()};Q.version="18.3.1";Am.exports=Q;var L=Am.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xw=L,Yw=Symbol.for("react.element"),Kw=Symbol.for("react.fragment"),qw=Object.prototype.hasOwnProperty,Zw=Xw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qw={key:!0,ref:!0,__self:!0,__source:!0};function Nm(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)qw.call(e,r)&&!Qw.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Yw,type:t,key:s,ref:o,props:i,_owner:Zw.current}}Bl.Fragment=Kw;Bl.jsx=Nm;Bl.jsxs=Nm;Sm.exports=Bl;var oe=Sm.exports,Om={exports:{}},lt={},Dm={exports:{}},Fm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,$){var X=V.length;V.push($);e:for(;0<X;){var Y=X-1>>>1,G=V[Y];if(0<i(G,$))V[Y]=$,V[X]=G,X=Y;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var $=V[0],X=V.pop();if(X!==$){V[0]=X;e:for(var Y=0,G=V.length,he=G>>>1;Y<he;){var Fe=2*(Y+1)-1,St=V[Fe],en=Fe+1,we=V[en];if(0>i(St,X))en<G&&0>i(we,St)?(V[Y]=we,V[en]=X,Y=en):(V[Y]=St,V[Fe]=X,Y=Fe);else if(en<G&&0>i(we,X))V[Y]=we,V[en]=X,Y=en;else break e}}return $}function i(V,$){var X=V.sortIndex-$.sortIndex;return X!==0?X:V.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,f=3,p=!1,T=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(V){for(var $=n(c);$!==null;){if($.callback===null)r(c);else if($.startTime<=V)r(c),$.sortIndex=$.expirationTime,e(l,$);else break;$=n(c)}}function R(V){if(v=!1,y(V),!T)if(n(l)!==null)T=!0,vn(P);else{var $=n(c);$!==null&&Et(R,$.startTime-V)}}function P(V,$){T=!1,v&&(v=!1,m(N),N=-1),p=!0;var X=f;try{for(y($),h=n(l);h!==null&&(!(h.expirationTime>$)||V&&!H());){var Y=h.callback;if(typeof Y=="function"){h.callback=null,f=h.priorityLevel;var G=Y(h.expirationTime<=$);$=t.unstable_now(),typeof G=="function"?h.callback=G:h===n(l)&&r(l),y($)}else r(l);h=n(l)}if(h!==null)var he=!0;else{var Fe=n(c);Fe!==null&&Et(R,Fe.startTime-$),he=!1}return he}finally{h=null,f=X,p=!1}}var I=!1,k=null,N=-1,F=5,O=-1;function H(){return!(t.unstable_now()-O<F)}function W(){if(k!==null){var V=t.unstable_now();O=V;var $=!0;try{$=k(!0,V)}finally{$?q():(I=!1,k=null)}}else I=!1}var q;if(typeof g=="function")q=function(){g(W)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,We=K.port2;K.port1.onmessage=W,q=function(){We.postMessage(null)}}else q=function(){S(W,0)};function vn(V){k=V,I||(I=!0,q())}function Et(V,$){N=S(function(){V(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){T||p||(T=!0,vn(P))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var $=3;break;default:$=f}var X=f;f=$;try{return V()}finally{f=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,$){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var X=f;f=V;try{return $()}finally{f=X}},t.unstable_scheduleCallback=function(V,$,X){var Y=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?Y+X:Y):X=Y,V){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=X+G,V={id:u++,callback:$,priorityLevel:V,startTime:X,expirationTime:G,sortIndex:-1},X>Y?(V.sortIndex=X,e(c,V),n(l)===null&&V===n(c)&&(v?(m(N),N=-1):v=!0,Et(R,X-Y))):(V.sortIndex=G,e(l,V),T||p||(T=!0,vn(P))),V},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(V){var $=f;return function(){var X=f;f=$;try{return V.apply(this,arguments)}finally{f=X}}}})(Fm);Dm.exports=Fm;var Jw=Dm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gw=L,at=Jw;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Um=new Set,Ls={};function Ir(t,e){Ai(t,e),Ai(t+"Capture",e)}function Ai(t,e){for(Ls[t]=e,t=0;t<e.length;t++)Um.add(e[t])}var fn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bu=Object.prototype.hasOwnProperty,eE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gd={},ep={};function tE(t){return bu.call(ep,t)?!0:bu.call(Gd,t)?!1:eE.test(t)?ep[t]=!0:(Gd[t]=!0,!1)}function nE(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function rE(t,e,n,r){if(e===null||typeof e>"u"||nE(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qe(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var De={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){De[t]=new qe(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];De[e]=new qe(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){De[t]=new qe(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){De[t]=new qe(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){De[t]=new qe(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){De[t]=new qe(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){De[t]=new qe(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){De[t]=new qe(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){De[t]=new qe(t,5,!1,t.toLowerCase(),null,!1,!1)});var uf=/[\-:]([a-z])/g;function hf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(uf,hf);De[e]=new qe(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(uf,hf);De[e]=new qe(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(uf,hf);De[e]=new qe(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){De[t]=new qe(t,1,!1,t.toLowerCase(),null,!1,!1)});De.xlinkHref=new qe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){De[t]=new qe(t,1,!1,t.toLowerCase(),null,!0,!0)});function ff(t,e,n,r){var i=De.hasOwnProperty(e)?De[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(rE(e,n,i,r)&&(n=null),r||i===null?tE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var mn=Gw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Do=Symbol.for("react.element"),qr=Symbol.for("react.portal"),Zr=Symbol.for("react.fragment"),df=Symbol.for("react.strict_mode"),Cu=Symbol.for("react.profiler"),Bm=Symbol.for("react.provider"),Lm=Symbol.for("react.context"),pf=Symbol.for("react.forward_ref"),Pu=Symbol.for("react.suspense"),xu=Symbol.for("react.suspense_list"),gf=Symbol.for("react.memo"),Cn=Symbol.for("react.lazy"),Vm=Symbol.for("react.offscreen"),tp=Symbol.iterator;function Gi(t){return t===null||typeof t!="object"?null:(t=tp&&t[tp]||t["@@iterator"],typeof t=="function"?t:null)}var me=Object.assign,Sc;function ps(t){if(Sc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Sc=e&&e[1]||""}return`
`+Sc+t}var Ac=!1;function Rc(t,e){if(!t||Ac)return"";Ac=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Ac=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ps(t):""}function iE(t){switch(t.tag){case 5:return ps(t.type);case 16:return ps("Lazy");case 13:return ps("Suspense");case 19:return ps("SuspenseList");case 0:case 2:case 15:return t=Rc(t.type,!1),t;case 11:return t=Rc(t.type.render,!1),t;case 1:return t=Rc(t.type,!0),t;default:return""}}function Iu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Zr:return"Fragment";case qr:return"Portal";case Cu:return"Profiler";case df:return"StrictMode";case Pu:return"Suspense";case xu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Lm:return(t.displayName||"Context")+".Consumer";case Bm:return(t._context.displayName||"Context")+".Provider";case pf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gf:return e=t.displayName||null,e!==null?e:Iu(t.type)||"Memo";case Cn:e=t._payload,t=t._init;try{return Iu(t(e))}catch{}}return null}function sE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Iu(e);case 8:return e===df?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Kn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zm(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function oE(t){var e=zm(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fo(t){t._valueTracker||(t._valueTracker=oE(t))}function jm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=zm(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ca(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Mu(t,e){var n=e.checked;return me({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function np(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Kn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Hm(t,e){e=e.checked,e!=null&&ff(t,"checked",e,!1)}function ku(t,e){Hm(t,e);var n=Kn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Nu(t,e.type,n):e.hasOwnProperty("defaultValue")&&Nu(t,e.type,Kn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Nu(t,e,n){(e!=="number"||Ca(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var gs=Array.isArray;function pi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Kn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Ou(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return me({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ip(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(gs(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Kn(n)}}function Wm(t,e){var n=Kn(e.value),r=Kn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function sp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $m(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Du(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$m(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Uo,Xm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Uo=Uo||document.createElement("div"),Uo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Uo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Vs(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aE=["Webkit","ms","Moz","O"];Object.keys(Es).forEach(function(t){aE.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Es[e]=Es[t]})});function Ym(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Es.hasOwnProperty(t)&&Es[t]?(""+e).trim():e+"px"}function Km(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Ym(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var lE=me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fu(t,e){if(e){if(lE[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Uu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bu=null;function _f(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Lu=null,gi=null,_i=null;function op(t){if(t=fo(t)){if(typeof Lu!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Hl(e),Lu(t.stateNode,t.type,e))}}function qm(t){gi?_i?_i.push(t):_i=[t]:gi=t}function Zm(){if(gi){var t=gi,e=_i;if(_i=gi=null,op(t),e)for(t=0;t<e.length;t++)op(e[t])}}function Qm(t,e){return t(e)}function Jm(){}var bc=!1;function Gm(t,e,n){if(bc)return t(e,n);bc=!0;try{return Qm(t,e,n)}finally{bc=!1,(gi!==null||_i!==null)&&(Jm(),Zm())}}function zs(t,e){var n=t.stateNode;if(n===null)return null;var r=Hl(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var Vu=!1;if(fn)try{var es={};Object.defineProperty(es,"passive",{get:function(){Vu=!0}}),window.addEventListener("test",es,es),window.removeEventListener("test",es,es)}catch{Vu=!1}function cE(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Ss=!1,Pa=null,xa=!1,zu=null,uE={onError:function(t){Ss=!0,Pa=t}};function hE(t,e,n,r,i,s,o,a,l){Ss=!1,Pa=null,cE.apply(uE,arguments)}function fE(t,e,n,r,i,s,o,a,l){if(hE.apply(this,arguments),Ss){if(Ss){var c=Pa;Ss=!1,Pa=null}else throw Error(U(198));xa||(xa=!0,zu=c)}}function Mr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ey(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ap(t){if(Mr(t)!==t)throw Error(U(188))}function dE(t){var e=t.alternate;if(!e){if(e=Mr(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return ap(i),t;if(s===r)return ap(i),e;s=s.sibling}throw Error(U(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function ty(t){return t=dE(t),t!==null?ny(t):null}function ny(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ny(t);if(e!==null)return e;t=t.sibling}return null}var ry=at.unstable_scheduleCallback,lp=at.unstable_cancelCallback,pE=at.unstable_shouldYield,gE=at.unstable_requestPaint,Te=at.unstable_now,_E=at.unstable_getCurrentPriorityLevel,mf=at.unstable_ImmediatePriority,iy=at.unstable_UserBlockingPriority,Ia=at.unstable_NormalPriority,mE=at.unstable_LowPriority,sy=at.unstable_IdlePriority,Ll=null,qt=null;function yE(t){if(qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(Ll,t,void 0,(t.current.flags&128)===128)}catch{}}var kt=Math.clz32?Math.clz32:wE,vE=Math.log,TE=Math.LN2;function wE(t){return t>>>=0,t===0?32:31-(vE(t)/TE|0)|0}var Bo=64,Lo=4194304;function _s(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ma(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=_s(a):(s&=o,s!==0&&(r=_s(s)))}else o=n&~i,o!==0?r=_s(o):s!==0&&(r=_s(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-kt(e),i=1<<n,r|=t[n],e&=~i;return r}function EE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function SE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-kt(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=EE(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function ju(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function oy(){var t=Bo;return Bo<<=1,!(Bo&4194240)&&(Bo=64),t}function Cc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function uo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-kt(e),t[e]=n}function AE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-kt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function yf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-kt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var ne=0;function ay(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ly,vf,cy,uy,hy,Hu=!1,Vo=[],Bn=null,Ln=null,Vn=null,js=new Map,Hs=new Map,Mn=[],RE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cp(t,e){switch(t){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":Ln=null;break;case"mouseover":case"mouseout":Vn=null;break;case"pointerover":case"pointerout":js.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hs.delete(e.pointerId)}}function ts(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=fo(e),e!==null&&vf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function bE(t,e,n,r,i){switch(e){case"focusin":return Bn=ts(Bn,t,e,n,r,i),!0;case"dragenter":return Ln=ts(Ln,t,e,n,r,i),!0;case"mouseover":return Vn=ts(Vn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return js.set(s,ts(js.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Hs.set(s,ts(Hs.get(s)||null,t,e,n,r,i)),!0}return!1}function fy(t){var e=fr(t.target);if(e!==null){var n=Mr(e);if(n!==null){if(e=n.tag,e===13){if(e=ey(n),e!==null){t.blockedOn=e,hy(t.priority,function(){cy(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pa(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Wu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Bu=r,n.target.dispatchEvent(r),Bu=null}else return e=fo(n),e!==null&&vf(e),t.blockedOn=n,!1;e.shift()}return!0}function up(t,e,n){pa(t)&&n.delete(e)}function CE(){Hu=!1,Bn!==null&&pa(Bn)&&(Bn=null),Ln!==null&&pa(Ln)&&(Ln=null),Vn!==null&&pa(Vn)&&(Vn=null),js.forEach(up),Hs.forEach(up)}function ns(t,e){t.blockedOn===e&&(t.blockedOn=null,Hu||(Hu=!0,at.unstable_scheduleCallback(at.unstable_NormalPriority,CE)))}function Ws(t){function e(i){return ns(i,t)}if(0<Vo.length){ns(Vo[0],t);for(var n=1;n<Vo.length;n++){var r=Vo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Bn!==null&&ns(Bn,t),Ln!==null&&ns(Ln,t),Vn!==null&&ns(Vn,t),js.forEach(e),Hs.forEach(e),n=0;n<Mn.length;n++)r=Mn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Mn.length&&(n=Mn[0],n.blockedOn===null);)fy(n),n.blockedOn===null&&Mn.shift()}var mi=mn.ReactCurrentBatchConfig,ka=!0;function PE(t,e,n,r){var i=ne,s=mi.transition;mi.transition=null;try{ne=1,Tf(t,e,n,r)}finally{ne=i,mi.transition=s}}function xE(t,e,n,r){var i=ne,s=mi.transition;mi.transition=null;try{ne=4,Tf(t,e,n,r)}finally{ne=i,mi.transition=s}}function Tf(t,e,n,r){if(ka){var i=Wu(t,e,n,r);if(i===null)Uc(t,e,r,Na,n),cp(t,r);else if(bE(i,t,e,n,r))r.stopPropagation();else if(cp(t,r),e&4&&-1<RE.indexOf(t)){for(;i!==null;){var s=fo(i);if(s!==null&&ly(s),s=Wu(t,e,n,r),s===null&&Uc(t,e,r,Na,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Uc(t,e,r,null,n)}}var Na=null;function Wu(t,e,n,r){if(Na=null,t=_f(r),t=fr(t),t!==null)if(e=Mr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ey(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Na=t,null}function dy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_E()){case mf:return 1;case iy:return 4;case Ia:case mE:return 16;case sy:return 536870912;default:return 16}default:return 16}}var Nn=null,wf=null,ga=null;function py(){if(ga)return ga;var t,e=wf,n=e.length,r,i="value"in Nn?Nn.value:Nn.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return ga=i.slice(t,1<r?1-r:void 0)}function _a(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zo(){return!0}function hp(){return!1}function ct(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?zo:hp,this.isPropagationStopped=hp,this}return me(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zo)},persist:function(){},isPersistent:zo}),e}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ef=ct(Hi),ho=me({},Hi,{view:0,detail:0}),IE=ct(ho),Pc,xc,rs,Vl=me({},ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==rs&&(rs&&t.type==="mousemove"?(Pc=t.screenX-rs.screenX,xc=t.screenY-rs.screenY):xc=Pc=0,rs=t),Pc)},movementY:function(t){return"movementY"in t?t.movementY:xc}}),fp=ct(Vl),ME=me({},Vl,{dataTransfer:0}),kE=ct(ME),NE=me({},ho,{relatedTarget:0}),Ic=ct(NE),OE=me({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),DE=ct(OE),FE=me({},Hi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UE=ct(FE),BE=me({},Hi,{data:0}),dp=ct(BE),LE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=zE[t])?!!e[t]:!1}function Sf(){return jE}var HE=me({},ho,{key:function(t){if(t.key){var e=LE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=_a(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?VE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sf,charCode:function(t){return t.type==="keypress"?_a(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?_a(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WE=ct(HE),$E=me({},Vl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pp=ct($E),XE=me({},ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sf}),YE=ct(XE),KE=me({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),qE=ct(KE),ZE=me({},Vl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),QE=ct(ZE),JE=[9,13,27,32],Af=fn&&"CompositionEvent"in window,As=null;fn&&"documentMode"in document&&(As=document.documentMode);var GE=fn&&"TextEvent"in window&&!As,gy=fn&&(!Af||As&&8<As&&11>=As),gp=" ",_p=!1;function _y(t,e){switch(t){case"keyup":return JE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function my(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qr=!1;function eS(t,e){switch(t){case"compositionend":return my(e);case"keypress":return e.which!==32?null:(_p=!0,gp);case"textInput":return t=e.data,t===gp&&_p?null:t;default:return null}}function tS(t,e){if(Qr)return t==="compositionend"||!Af&&_y(t,e)?(t=py(),ga=wf=Nn=null,Qr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gy&&e.locale!=="ko"?null:e.data;default:return null}}var nS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nS[t.type]:e==="textarea"}function yy(t,e,n,r){qm(r),e=Oa(e,"onChange"),0<e.length&&(n=new Ef("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Rs=null,$s=null;function rS(t){xy(t,0)}function zl(t){var e=ei(t);if(jm(e))return t}function iS(t,e){if(t==="change")return e}var vy=!1;if(fn){var Mc;if(fn){var kc="oninput"in document;if(!kc){var yp=document.createElement("div");yp.setAttribute("oninput","return;"),kc=typeof yp.oninput=="function"}Mc=kc}else Mc=!1;vy=Mc&&(!document.documentMode||9<document.documentMode)}function vp(){Rs&&(Rs.detachEvent("onpropertychange",Ty),$s=Rs=null)}function Ty(t){if(t.propertyName==="value"&&zl($s)){var e=[];yy(e,$s,t,_f(t)),Gm(rS,e)}}function sS(t,e,n){t==="focusin"?(vp(),Rs=e,$s=n,Rs.attachEvent("onpropertychange",Ty)):t==="focusout"&&vp()}function oS(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return zl($s)}function aS(t,e){if(t==="click")return zl(e)}function lS(t,e){if(t==="input"||t==="change")return zl(e)}function cS(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ot=typeof Object.is=="function"?Object.is:cS;function Xs(t,e){if(Ot(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!bu.call(e,i)||!Ot(t[i],e[i]))return!1}return!0}function Tp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function wp(t,e){var n=Tp(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Tp(n)}}function wy(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wy(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Ey(){for(var t=window,e=Ca();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ca(t.document)}return e}function Rf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uS(t){var e=Ey(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&wy(n.ownerDocument.documentElement,n)){if(r!==null&&Rf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=wp(n,s);var o=wp(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var hS=fn&&"documentMode"in document&&11>=document.documentMode,Jr=null,$u=null,bs=null,Xu=!1;function Ep(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Xu||Jr==null||Jr!==Ca(r)||(r=Jr,"selectionStart"in r&&Rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),bs&&Xs(bs,r)||(bs=r,r=Oa($u,"onSelect"),0<r.length&&(e=new Ef("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Jr)))}function jo(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gr={animationend:jo("Animation","AnimationEnd"),animationiteration:jo("Animation","AnimationIteration"),animationstart:jo("Animation","AnimationStart"),transitionend:jo("Transition","TransitionEnd")},Nc={},Sy={};fn&&(Sy=document.createElement("div").style,"AnimationEvent"in window||(delete Gr.animationend.animation,delete Gr.animationiteration.animation,delete Gr.animationstart.animation),"TransitionEvent"in window||delete Gr.transitionend.transition);function jl(t){if(Nc[t])return Nc[t];if(!Gr[t])return t;var e=Gr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Sy)return Nc[t]=e[n];return t}var Ay=jl("animationend"),Ry=jl("animationiteration"),by=jl("animationstart"),Cy=jl("transitionend"),Py=new Map,Sp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jn(t,e){Py.set(t,e),Ir(e,[t])}for(var Oc=0;Oc<Sp.length;Oc++){var Dc=Sp[Oc],fS=Dc.toLowerCase(),dS=Dc[0].toUpperCase()+Dc.slice(1);Jn(fS,"on"+dS)}Jn(Ay,"onAnimationEnd");Jn(Ry,"onAnimationIteration");Jn(by,"onAnimationStart");Jn("dblclick","onDoubleClick");Jn("focusin","onFocus");Jn("focusout","onBlur");Jn(Cy,"onTransitionEnd");Ai("onMouseEnter",["mouseout","mouseover"]);Ai("onMouseLeave",["mouseout","mouseover"]);Ai("onPointerEnter",["pointerout","pointerover"]);Ai("onPointerLeave",["pointerout","pointerover"]);Ir("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ir("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ir("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ir("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ir("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pS=new Set("cancel close invalid load scroll toggle".split(" ").concat(ms));function Ap(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,fE(r,e,void 0,t),t.currentTarget=null}function xy(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Ap(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Ap(i,a,c),s=l}}}if(xa)throw t=zu,xa=!1,zu=null,t}function ce(t,e){var n=e[Qu];n===void 0&&(n=e[Qu]=new Set);var r=t+"__bubble";n.has(r)||(Iy(e,t,2,!1),n.add(r))}function Fc(t,e,n){var r=0;e&&(r|=4),Iy(n,t,r,e)}var Ho="_reactListening"+Math.random().toString(36).slice(2);function Ys(t){if(!t[Ho]){t[Ho]=!0,Um.forEach(function(n){n!=="selectionchange"&&(pS.has(n)||Fc(n,!1,t),Fc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ho]||(e[Ho]=!0,Fc("selectionchange",!1,e))}}function Iy(t,e,n,r){switch(dy(e)){case 1:var i=PE;break;case 4:i=xE;break;default:i=Tf}n=i.bind(null,e,n,t),i=void 0,!Vu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Uc(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=fr(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Gm(function(){var c=s,u=_f(n),h=[];e:{var f=Py.get(t);if(f!==void 0){var p=Ef,T=t;switch(t){case"keypress":if(_a(n)===0)break e;case"keydown":case"keyup":p=WE;break;case"focusin":T="focus",p=Ic;break;case"focusout":T="blur",p=Ic;break;case"beforeblur":case"afterblur":p=Ic;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=fp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=kE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=YE;break;case Ay:case Ry:case by:p=DE;break;case Cy:p=qE;break;case"scroll":p=IE;break;case"wheel":p=QE;break;case"copy":case"cut":case"paste":p=UE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=pp}var v=(e&4)!==0,S=!v&&t==="scroll",m=v?f!==null?f+"Capture":null:f;v=[];for(var g=c,y;g!==null;){y=g;var R=y.stateNode;if(y.tag===5&&R!==null&&(y=R,m!==null&&(R=zs(g,m),R!=null&&v.push(Ks(g,R,y)))),S)break;g=g.return}0<v.length&&(f=new p(f,T,null,n,u),h.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&n!==Bu&&(T=n.relatedTarget||n.fromElement)&&(fr(T)||T[dn]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(T=n.relatedTarget||n.toElement,p=c,T=T?fr(T):null,T!==null&&(S=Mr(T),T!==S||T.tag!==5&&T.tag!==6)&&(T=null)):(p=null,T=c),p!==T)){if(v=fp,R="onMouseLeave",m="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(v=pp,R="onPointerLeave",m="onPointerEnter",g="pointer"),S=p==null?f:ei(p),y=T==null?f:ei(T),f=new v(R,g+"leave",p,n,u),f.target=S,f.relatedTarget=y,R=null,fr(u)===c&&(v=new v(m,g+"enter",T,n,u),v.target=y,v.relatedTarget=S,R=v),S=R,p&&T)t:{for(v=p,m=T,g=0,y=v;y;y=Br(y))g++;for(y=0,R=m;R;R=Br(R))y++;for(;0<g-y;)v=Br(v),g--;for(;0<y-g;)m=Br(m),y--;for(;g--;){if(v===m||m!==null&&v===m.alternate)break t;v=Br(v),m=Br(m)}v=null}else v=null;p!==null&&Rp(h,f,p,v,!1),T!==null&&S!==null&&Rp(h,S,T,v,!0)}}e:{if(f=c?ei(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var P=iS;else if(mp(f))if(vy)P=lS;else{P=oS;var I=sS}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(P=aS);if(P&&(P=P(t,c))){yy(h,P,n,u);break e}I&&I(t,f,c),t==="focusout"&&(I=f._wrapperState)&&I.controlled&&f.type==="number"&&Nu(f,"number",f.value)}switch(I=c?ei(c):window,t){case"focusin":(mp(I)||I.contentEditable==="true")&&(Jr=I,$u=c,bs=null);break;case"focusout":bs=$u=Jr=null;break;case"mousedown":Xu=!0;break;case"contextmenu":case"mouseup":case"dragend":Xu=!1,Ep(h,n,u);break;case"selectionchange":if(hS)break;case"keydown":case"keyup":Ep(h,n,u)}var k;if(Af)e:{switch(t){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Qr?_y(t,n)&&(N="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(gy&&n.locale!=="ko"&&(Qr||N!=="onCompositionStart"?N==="onCompositionEnd"&&Qr&&(k=py()):(Nn=u,wf="value"in Nn?Nn.value:Nn.textContent,Qr=!0)),I=Oa(c,N),0<I.length&&(N=new dp(N,t,null,n,u),h.push({event:N,listeners:I}),k?N.data=k:(k=my(n),k!==null&&(N.data=k)))),(k=GE?eS(t,n):tS(t,n))&&(c=Oa(c,"onBeforeInput"),0<c.length&&(u=new dp("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=k))}xy(h,e)})}function Ks(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Oa(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=zs(t,n),s!=null&&r.unshift(Ks(t,s,i)),s=zs(t,e),s!=null&&r.push(Ks(t,s,i))),t=t.return}return r}function Br(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Rp(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=zs(n,s),l!=null&&o.unshift(Ks(n,l,a))):i||(l=zs(n,s),l!=null&&o.push(Ks(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var gS=/\r\n?/g,_S=/\u0000|\uFFFD/g;function bp(t){return(typeof t=="string"?t:""+t).replace(gS,`
`).replace(_S,"")}function Wo(t,e,n){if(e=bp(e),bp(t)!==e&&n)throw Error(U(425))}function Da(){}var Yu=null,Ku=null;function qu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zu=typeof setTimeout=="function"?setTimeout:void 0,mS=typeof clearTimeout=="function"?clearTimeout:void 0,Cp=typeof Promise=="function"?Promise:void 0,yS=typeof queueMicrotask=="function"?queueMicrotask:typeof Cp<"u"?function(t){return Cp.resolve(null).then(t).catch(vS)}:Zu;function vS(t){setTimeout(function(){throw t})}function Bc(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ws(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ws(e)}function zn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Pp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Wi=Math.random().toString(36).slice(2),$t="__reactFiber$"+Wi,qs="__reactProps$"+Wi,dn="__reactContainer$"+Wi,Qu="__reactEvents$"+Wi,TS="__reactListeners$"+Wi,wS="__reactHandles$"+Wi;function fr(t){var e=t[$t];if(e)return e;for(var n=t.parentNode;n;){if(e=n[dn]||n[$t]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Pp(t);t!==null;){if(n=t[$t])return n;t=Pp(t)}return e}t=n,n=t.parentNode}return null}function fo(t){return t=t[$t]||t[dn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ei(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Hl(t){return t[qs]||null}var Ju=[],ti=-1;function Gn(t){return{current:t}}function ue(t){0>ti||(t.current=Ju[ti],Ju[ti]=null,ti--)}function ae(t,e){ti++,Ju[ti]=t.current,t.current=e}var qn={},He=Gn(qn),Ge=Gn(!1),Sr=qn;function Ri(t,e){var n=t.type.contextTypes;if(!n)return qn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function et(t){return t=t.childContextTypes,t!=null}function Fa(){ue(Ge),ue(He)}function xp(t,e,n){if(He.current!==qn)throw Error(U(168));ae(He,e),ae(Ge,n)}function My(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(U(108,sE(t)||"Unknown",i));return me({},n,r)}function Ua(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||qn,Sr=He.current,ae(He,t),ae(Ge,Ge.current),!0}function Ip(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=My(t,e,Sr),r.__reactInternalMemoizedMergedChildContext=t,ue(Ge),ue(He),ae(He,t)):ue(Ge),ae(Ge,n)}var on=null,Wl=!1,Lc=!1;function ky(t){on===null?on=[t]:on.push(t)}function ES(t){Wl=!0,ky(t)}function er(){if(!Lc&&on!==null){Lc=!0;var t=0,e=ne;try{var n=on;for(ne=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}on=null,Wl=!1}catch(i){throw on!==null&&(on=on.slice(t+1)),ry(mf,er),i}finally{ne=e,Lc=!1}}return null}var ni=[],ri=0,Ba=null,La=0,ft=[],dt=0,Ar=null,ln=1,cn="";function or(t,e){ni[ri++]=La,ni[ri++]=Ba,Ba=t,La=e}function Ny(t,e,n){ft[dt++]=ln,ft[dt++]=cn,ft[dt++]=Ar,Ar=t;var r=ln;t=cn;var i=32-kt(r)-1;r&=~(1<<i),n+=1;var s=32-kt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ln=1<<32-kt(e)+i|n<<i|r,cn=s+t}else ln=1<<s|n<<i|r,cn=t}function bf(t){t.return!==null&&(or(t,1),Ny(t,1,0))}function Cf(t){for(;t===Ba;)Ba=ni[--ri],ni[ri]=null,La=ni[--ri],ni[ri]=null;for(;t===Ar;)Ar=ft[--dt],ft[dt]=null,cn=ft[--dt],ft[dt]=null,ln=ft[--dt],ft[dt]=null}var ot=null,st=null,fe=!1,Pt=null;function Oy(t,e){var n=pt(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Mp(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ot=t,st=zn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ot=t,st=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ar!==null?{id:ln,overflow:cn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pt(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ot=t,st=null,!0):!1;default:return!1}}function Gu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function eh(t){if(fe){var e=st;if(e){var n=e;if(!Mp(t,e)){if(Gu(t))throw Error(U(418));e=zn(n.nextSibling);var r=ot;e&&Mp(t,e)?Oy(r,n):(t.flags=t.flags&-4097|2,fe=!1,ot=t)}}else{if(Gu(t))throw Error(U(418));t.flags=t.flags&-4097|2,fe=!1,ot=t}}}function kp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ot=t}function $o(t){if(t!==ot)return!1;if(!fe)return kp(t),fe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!qu(t.type,t.memoizedProps)),e&&(e=st)){if(Gu(t))throw Dy(),Error(U(418));for(;e;)Oy(t,e),e=zn(e.nextSibling)}if(kp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){st=zn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}st=null}}else st=ot?zn(t.stateNode.nextSibling):null;return!0}function Dy(){for(var t=st;t;)t=zn(t.nextSibling)}function bi(){st=ot=null,fe=!1}function Pf(t){Pt===null?Pt=[t]:Pt.push(t)}var SS=mn.ReactCurrentBatchConfig;function is(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Xo(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Np(t){var e=t._init;return e(t._payload)}function Fy(t){function e(m,g){if(t){var y=m.deletions;y===null?(m.deletions=[g],m.flags|=16):y.push(g)}}function n(m,g){if(!t)return null;for(;g!==null;)e(m,g),g=g.sibling;return null}function r(m,g){for(m=new Map;g!==null;)g.key!==null?m.set(g.key,g):m.set(g.index,g),g=g.sibling;return m}function i(m,g){return m=$n(m,g),m.index=0,m.sibling=null,m}function s(m,g,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<g?(m.flags|=2,g):y):(m.flags|=2,g)):(m.flags|=1048576,g)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,g,y,R){return g===null||g.tag!==6?(g=Xc(y,m.mode,R),g.return=m,g):(g=i(g,y),g.return=m,g)}function l(m,g,y,R){var P=y.type;return P===Zr?u(m,g,y.props.children,R,y.key):g!==null&&(g.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Cn&&Np(P)===g.type)?(R=i(g,y.props),R.ref=is(m,g,y),R.return=m,R):(R=Sa(y.type,y.key,y.props,null,m.mode,R),R.ref=is(m,g,y),R.return=m,R)}function c(m,g,y,R){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=Yc(y,m.mode,R),g.return=m,g):(g=i(g,y.children||[]),g.return=m,g)}function u(m,g,y,R,P){return g===null||g.tag!==7?(g=vr(y,m.mode,R,P),g.return=m,g):(g=i(g,y),g.return=m,g)}function h(m,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Xc(""+g,m.mode,y),g.return=m,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Do:return y=Sa(g.type,g.key,g.props,null,m.mode,y),y.ref=is(m,null,g),y.return=m,y;case qr:return g=Yc(g,m.mode,y),g.return=m,g;case Cn:var R=g._init;return h(m,R(g._payload),y)}if(gs(g)||Gi(g))return g=vr(g,m.mode,y,null),g.return=m,g;Xo(m,g)}return null}function f(m,g,y,R){var P=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return P!==null?null:a(m,g,""+y,R);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Do:return y.key===P?l(m,g,y,R):null;case qr:return y.key===P?c(m,g,y,R):null;case Cn:return P=y._init,f(m,g,P(y._payload),R)}if(gs(y)||Gi(y))return P!==null?null:u(m,g,y,R,null);Xo(m,y)}return null}function p(m,g,y,R,P){if(typeof R=="string"&&R!==""||typeof R=="number")return m=m.get(y)||null,a(g,m,""+R,P);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Do:return m=m.get(R.key===null?y:R.key)||null,l(g,m,R,P);case qr:return m=m.get(R.key===null?y:R.key)||null,c(g,m,R,P);case Cn:var I=R._init;return p(m,g,y,I(R._payload),P)}if(gs(R)||Gi(R))return m=m.get(y)||null,u(g,m,R,P,null);Xo(g,R)}return null}function T(m,g,y,R){for(var P=null,I=null,k=g,N=g=0,F=null;k!==null&&N<y.length;N++){k.index>N?(F=k,k=null):F=k.sibling;var O=f(m,k,y[N],R);if(O===null){k===null&&(k=F);break}t&&k&&O.alternate===null&&e(m,k),g=s(O,g,N),I===null?P=O:I.sibling=O,I=O,k=F}if(N===y.length)return n(m,k),fe&&or(m,N),P;if(k===null){for(;N<y.length;N++)k=h(m,y[N],R),k!==null&&(g=s(k,g,N),I===null?P=k:I.sibling=k,I=k);return fe&&or(m,N),P}for(k=r(m,k);N<y.length;N++)F=p(k,m,N,y[N],R),F!==null&&(t&&F.alternate!==null&&k.delete(F.key===null?N:F.key),g=s(F,g,N),I===null?P=F:I.sibling=F,I=F);return t&&k.forEach(function(H){return e(m,H)}),fe&&or(m,N),P}function v(m,g,y,R){var P=Gi(y);if(typeof P!="function")throw Error(U(150));if(y=P.call(y),y==null)throw Error(U(151));for(var I=P=null,k=g,N=g=0,F=null,O=y.next();k!==null&&!O.done;N++,O=y.next()){k.index>N?(F=k,k=null):F=k.sibling;var H=f(m,k,O.value,R);if(H===null){k===null&&(k=F);break}t&&k&&H.alternate===null&&e(m,k),g=s(H,g,N),I===null?P=H:I.sibling=H,I=H,k=F}if(O.done)return n(m,k),fe&&or(m,N),P;if(k===null){for(;!O.done;N++,O=y.next())O=h(m,O.value,R),O!==null&&(g=s(O,g,N),I===null?P=O:I.sibling=O,I=O);return fe&&or(m,N),P}for(k=r(m,k);!O.done;N++,O=y.next())O=p(k,m,N,O.value,R),O!==null&&(t&&O.alternate!==null&&k.delete(O.key===null?N:O.key),g=s(O,g,N),I===null?P=O:I.sibling=O,I=O);return t&&k.forEach(function(W){return e(m,W)}),fe&&or(m,N),P}function S(m,g,y,R){if(typeof y=="object"&&y!==null&&y.type===Zr&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Do:e:{for(var P=y.key,I=g;I!==null;){if(I.key===P){if(P=y.type,P===Zr){if(I.tag===7){n(m,I.sibling),g=i(I,y.props.children),g.return=m,m=g;break e}}else if(I.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Cn&&Np(P)===I.type){n(m,I.sibling),g=i(I,y.props),g.ref=is(m,I,y),g.return=m,m=g;break e}n(m,I);break}else e(m,I);I=I.sibling}y.type===Zr?(g=vr(y.props.children,m.mode,R,y.key),g.return=m,m=g):(R=Sa(y.type,y.key,y.props,null,m.mode,R),R.ref=is(m,g,y),R.return=m,m=R)}return o(m);case qr:e:{for(I=y.key;g!==null;){if(g.key===I)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(m,g.sibling),g=i(g,y.children||[]),g.return=m,m=g;break e}else{n(m,g);break}else e(m,g);g=g.sibling}g=Yc(y,m.mode,R),g.return=m,m=g}return o(m);case Cn:return I=y._init,S(m,g,I(y._payload),R)}if(gs(y))return T(m,g,y,R);if(Gi(y))return v(m,g,y,R);Xo(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(m,g.sibling),g=i(g,y),g.return=m,m=g):(n(m,g),g=Xc(y,m.mode,R),g.return=m,m=g),o(m)):n(m,g)}return S}var Ci=Fy(!0),Uy=Fy(!1),Va=Gn(null),za=null,ii=null,xf=null;function If(){xf=ii=za=null}function Mf(t){var e=Va.current;ue(Va),t._currentValue=e}function th(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function yi(t,e){za=t,xf=ii=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Je=!0),t.firstContext=null)}function Tt(t){var e=t._currentValue;if(xf!==t)if(t={context:t,memoizedValue:e,next:null},ii===null){if(za===null)throw Error(U(308));ii=t,za.dependencies={lanes:0,firstContext:t}}else ii=ii.next=t;return e}var dr=null;function kf(t){dr===null?dr=[t]:dr.push(t)}function By(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,kf(e)):(n.next=i.next,i.next=n),e.interleaved=n,pn(t,r)}function pn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pn=!1;function Nf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ly(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function hn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function jn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,J&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,pn(t,n)}return i=r.interleaved,i===null?(e.next=e,kf(r)):(e.next=i.next,i.next=e),r.interleaved=e,pn(t,n)}function ma(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yf(t,n)}}function Op(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ja(t,e,n,r){var i=t.updateQueue;Pn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,u=c=l=null,a=s;do{var f=a.lane,p=a.eventTime;if((r&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,v=a;switch(f=e,p=n,v.tag){case 1:if(T=v.payload,typeof T=="function"){h=T.call(p,h,f);break e}h=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=v.payload,f=typeof T=="function"?T.call(p,h,f):T,f==null)break e;h=me({},h,f);break e;case 2:Pn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(u===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);br|=o,t.lanes=o,t.memoizedState=h}}function Dp(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(U(191,i));i.call(r)}}}var po={},Zt=Gn(po),Zs=Gn(po),Qs=Gn(po);function pr(t){if(t===po)throw Error(U(174));return t}function Of(t,e){switch(ae(Qs,e),ae(Zs,t),ae(Zt,po),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Du(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Du(e,t)}ue(Zt),ae(Zt,e)}function Pi(){ue(Zt),ue(Zs),ue(Qs)}function Vy(t){pr(Qs.current);var e=pr(Zt.current),n=Du(e,t.type);e!==n&&(ae(Zs,t),ae(Zt,n))}function Df(t){Zs.current===t&&(ue(Zt),ue(Zs))}var pe=Gn(0);function Ha(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Vc=[];function Ff(){for(var t=0;t<Vc.length;t++)Vc[t]._workInProgressVersionPrimary=null;Vc.length=0}var ya=mn.ReactCurrentDispatcher,zc=mn.ReactCurrentBatchConfig,Rr=0,_e=null,Re=null,xe=null,Wa=!1,Cs=!1,Js=0,AS=0;function Ue(){throw Error(U(321))}function Uf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ot(t[n],e[n]))return!1;return!0}function Bf(t,e,n,r,i,s){if(Rr=s,_e=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ya.current=t===null||t.memoizedState===null?PS:xS,t=n(r,i),Cs){s=0;do{if(Cs=!1,Js=0,25<=s)throw Error(U(301));s+=1,xe=Re=null,e.updateQueue=null,ya.current=IS,t=n(r,i)}while(Cs)}if(ya.current=$a,e=Re!==null&&Re.next!==null,Rr=0,xe=Re=_e=null,Wa=!1,e)throw Error(U(300));return t}function Lf(){var t=Js!==0;return Js=0,t}function Wt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xe===null?_e.memoizedState=xe=t:xe=xe.next=t,xe}function wt(){if(Re===null){var t=_e.alternate;t=t!==null?t.memoizedState:null}else t=Re.next;var e=xe===null?_e.memoizedState:xe.next;if(e!==null)xe=e,Re=t;else{if(t===null)throw Error(U(310));Re=t,t={memoizedState:Re.memoizedState,baseState:Re.baseState,baseQueue:Re.baseQueue,queue:Re.queue,next:null},xe===null?_e.memoizedState=xe=t:xe=xe.next=t}return xe}function Gs(t,e){return typeof e=="function"?e(t):e}function jc(t){var e=wt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Re,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Rr&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,_e.lanes|=u,br|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,Ot(r,e.memoizedState)||(Je=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,_e.lanes|=s,br|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Hc(t){var e=wt(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ot(s,e.memoizedState)||(Je=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function zy(){}function jy(t,e){var n=_e,r=wt(),i=e(),s=!Ot(r.memoizedState,i);if(s&&(r.memoizedState=i,Je=!0),r=r.queue,Vf($y.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||xe!==null&&xe.memoizedState.tag&1){if(n.flags|=2048,eo(9,Wy.bind(null,n,r,i,e),void 0,null),Ie===null)throw Error(U(349));Rr&30||Hy(n,e,i)}return i}function Hy(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_e.updateQueue,e===null?(e={lastEffect:null,stores:null},_e.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Wy(t,e,n,r){e.value=n,e.getSnapshot=r,Xy(e)&&Yy(t)}function $y(t,e,n){return n(function(){Xy(e)&&Yy(t)})}function Xy(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ot(t,n)}catch{return!0}}function Yy(t){var e=pn(t,1);e!==null&&Nt(e,t,1,-1)}function Fp(t){var e=Wt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:t},e.queue=t,t=t.dispatch=CS.bind(null,_e,t),[e.memoizedState,t]}function eo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=_e.updateQueue,e===null?(e={lastEffect:null,stores:null},_e.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ky(){return wt().memoizedState}function va(t,e,n,r){var i=Wt();_e.flags|=t,i.memoizedState=eo(1|e,n,void 0,r===void 0?null:r)}function $l(t,e,n,r){var i=wt();r=r===void 0?null:r;var s=void 0;if(Re!==null){var o=Re.memoizedState;if(s=o.destroy,r!==null&&Uf(r,o.deps)){i.memoizedState=eo(e,n,s,r);return}}_e.flags|=t,i.memoizedState=eo(1|e,n,s,r)}function Up(t,e){return va(8390656,8,t,e)}function Vf(t,e){return $l(2048,8,t,e)}function qy(t,e){return $l(4,2,t,e)}function Zy(t,e){return $l(4,4,t,e)}function Qy(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Jy(t,e,n){return n=n!=null?n.concat([t]):null,$l(4,4,Qy.bind(null,e,t),n)}function zf(){}function Gy(t,e){var n=wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function e0(t,e){var n=wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function t0(t,e,n){return Rr&21?(Ot(n,e)||(n=oy(),_e.lanes|=n,br|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Je=!0),t.memoizedState=n)}function RS(t,e){var n=ne;ne=n!==0&&4>n?n:4,t(!0);var r=zc.transition;zc.transition={};try{t(!1),e()}finally{ne=n,zc.transition=r}}function n0(){return wt().memoizedState}function bS(t,e,n){var r=Wn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},r0(t))i0(e,n);else if(n=By(t,e,n,r),n!==null){var i=Ye();Nt(n,t,r,i),s0(n,e,r)}}function CS(t,e,n){var r=Wn(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(r0(t))i0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ot(a,o)){var l=e.interleaved;l===null?(i.next=i,kf(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=By(t,e,i,r),n!==null&&(i=Ye(),Nt(n,t,r,i),s0(n,e,r))}}function r0(t){var e=t.alternate;return t===_e||e!==null&&e===_e}function i0(t,e){Cs=Wa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function s0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yf(t,n)}}var $a={readContext:Tt,useCallback:Ue,useContext:Ue,useEffect:Ue,useImperativeHandle:Ue,useInsertionEffect:Ue,useLayoutEffect:Ue,useMemo:Ue,useReducer:Ue,useRef:Ue,useState:Ue,useDebugValue:Ue,useDeferredValue:Ue,useTransition:Ue,useMutableSource:Ue,useSyncExternalStore:Ue,useId:Ue,unstable_isNewReconciler:!1},PS={readContext:Tt,useCallback:function(t,e){return Wt().memoizedState=[t,e===void 0?null:e],t},useContext:Tt,useEffect:Up,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,va(4194308,4,Qy.bind(null,e,t),n)},useLayoutEffect:function(t,e){return va(4194308,4,t,e)},useInsertionEffect:function(t,e){return va(4,2,t,e)},useMemo:function(t,e){var n=Wt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=bS.bind(null,_e,t),[r.memoizedState,t]},useRef:function(t){var e=Wt();return t={current:t},e.memoizedState=t},useState:Fp,useDebugValue:zf,useDeferredValue:function(t){return Wt().memoizedState=t},useTransition:function(){var t=Fp(!1),e=t[0];return t=RS.bind(null,t[1]),Wt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=_e,i=Wt();if(fe){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),Ie===null)throw Error(U(349));Rr&30||Hy(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Up($y.bind(null,r,s,t),[t]),r.flags|=2048,eo(9,Wy.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Wt(),e=Ie.identifierPrefix;if(fe){var n=cn,r=ln;n=(r&~(1<<32-kt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Js++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=AS++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},xS={readContext:Tt,useCallback:Gy,useContext:Tt,useEffect:Vf,useImperativeHandle:Jy,useInsertionEffect:qy,useLayoutEffect:Zy,useMemo:e0,useReducer:jc,useRef:Ky,useState:function(){return jc(Gs)},useDebugValue:zf,useDeferredValue:function(t){var e=wt();return t0(e,Re.memoizedState,t)},useTransition:function(){var t=jc(Gs)[0],e=wt().memoizedState;return[t,e]},useMutableSource:zy,useSyncExternalStore:jy,useId:n0,unstable_isNewReconciler:!1},IS={readContext:Tt,useCallback:Gy,useContext:Tt,useEffect:Vf,useImperativeHandle:Jy,useInsertionEffect:qy,useLayoutEffect:Zy,useMemo:e0,useReducer:Hc,useRef:Ky,useState:function(){return Hc(Gs)},useDebugValue:zf,useDeferredValue:function(t){var e=wt();return Re===null?e.memoizedState=t:t0(e,Re.memoizedState,t)},useTransition:function(){var t=Hc(Gs)[0],e=wt().memoizedState;return[t,e]},useMutableSource:zy,useSyncExternalStore:jy,useId:n0,unstable_isNewReconciler:!1};function bt(t,e){if(t&&t.defaultProps){e=me({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function nh(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:me({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Xl={isMounted:function(t){return(t=t._reactInternals)?Mr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ye(),i=Wn(t),s=hn(r,i);s.payload=e,n!=null&&(s.callback=n),e=jn(t,s,i),e!==null&&(Nt(e,t,i,r),ma(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ye(),i=Wn(t),s=hn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=jn(t,s,i),e!==null&&(Nt(e,t,i,r),ma(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ye(),r=Wn(t),i=hn(n,r);i.tag=2,e!=null&&(i.callback=e),e=jn(t,i,r),e!==null&&(Nt(e,t,r,n),ma(e,t,r))}};function Bp(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Xs(n,r)||!Xs(i,s):!0}function o0(t,e,n){var r=!1,i=qn,s=e.contextType;return typeof s=="object"&&s!==null?s=Tt(s):(i=et(e)?Sr:He.current,r=e.contextTypes,s=(r=r!=null)?Ri(t,i):qn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Xl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Lp(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Xl.enqueueReplaceState(e,e.state,null)}function rh(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Nf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Tt(s):(s=et(e)?Sr:He.current,i.context=Ri(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(nh(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Xl.enqueueReplaceState(i,i.state,null),ja(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function xi(t,e){try{var n="",r=e;do n+=iE(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Wc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ih(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var MS=typeof WeakMap=="function"?WeakMap:Map;function a0(t,e,n){n=hn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ya||(Ya=!0,ph=r),ih(t,e)},n}function l0(t,e,n){n=hn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){ih(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){ih(t,e),typeof r!="function"&&(Hn===null?Hn=new Set([this]):Hn.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Vp(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new MS;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=$S.bind(null,t,e,n),e.then(t,t))}function zp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function jp(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=hn(-1,1),e.tag=2,jn(n,e,1))),n.lanes|=1),t)}var kS=mn.ReactCurrentOwner,Je=!1;function Xe(t,e,n,r){e.child=t===null?Uy(e,null,n,r):Ci(e,t.child,n,r)}function Hp(t,e,n,r,i){n=n.render;var s=e.ref;return yi(e,i),r=Bf(t,e,n,r,s,i),n=Lf(),t!==null&&!Je?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gn(t,e,i)):(fe&&n&&bf(e),e.flags|=1,Xe(t,e,r,i),e.child)}function Wp(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!qf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,c0(t,e,s,r,i)):(t=Sa(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Xs,n(o,r)&&t.ref===e.ref)return gn(t,e,i)}return e.flags|=1,t=$n(s,r),t.ref=e.ref,t.return=e,e.child=t}function c0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Xs(s,r)&&t.ref===e.ref)if(Je=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Je=!0);else return e.lanes=t.lanes,gn(t,e,i)}return sh(t,e,n,r,i)}function u0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ae(oi,rt),rt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ae(oi,rt),rt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ae(oi,rt),rt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ae(oi,rt),rt|=r;return Xe(t,e,i,n),e.child}function h0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function sh(t,e,n,r,i){var s=et(n)?Sr:He.current;return s=Ri(e,s),yi(e,i),n=Bf(t,e,n,r,s,i),r=Lf(),t!==null&&!Je?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,gn(t,e,i)):(fe&&r&&bf(e),e.flags|=1,Xe(t,e,n,i),e.child)}function $p(t,e,n,r,i){if(et(n)){var s=!0;Ua(e)}else s=!1;if(yi(e,i),e.stateNode===null)Ta(t,e),o0(e,n,r),rh(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Tt(c):(c=et(n)?Sr:He.current,c=Ri(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Lp(e,o,r,c),Pn=!1;var f=e.memoizedState;o.state=f,ja(e,r,o,i),l=e.memoizedState,a!==r||f!==l||Ge.current||Pn?(typeof u=="function"&&(nh(e,n,u,r),l=e.memoizedState),(a=Pn||Bp(e,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Ly(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:bt(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Tt(l):(l=et(n)?Sr:He.current,l=Ri(e,l));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&Lp(e,o,r,l),Pn=!1,f=e.memoizedState,o.state=f,ja(e,r,o,i);var T=e.memoizedState;a!==h||f!==T||Ge.current||Pn?(typeof p=="function"&&(nh(e,n,p,r),T=e.memoizedState),(c=Pn||Bp(e,n,c,r,f,T,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return oh(t,e,n,r,s,i)}function oh(t,e,n,r,i,s){h0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Ip(e,n,!1),gn(t,e,s);r=e.stateNode,kS.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ci(e,t.child,null,s),e.child=Ci(e,null,a,s)):Xe(t,e,a,s),e.memoizedState=r.state,i&&Ip(e,n,!0),e.child}function f0(t){var e=t.stateNode;e.pendingContext?xp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xp(t,e.context,!1),Of(t,e.containerInfo)}function Xp(t,e,n,r,i){return bi(),Pf(i),e.flags|=256,Xe(t,e,n,r),e.child}var ah={dehydrated:null,treeContext:null,retryLane:0};function lh(t){return{baseLanes:t,cachePool:null,transitions:null}}function d0(t,e,n){var r=e.pendingProps,i=pe.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ae(pe,i&1),t===null)return eh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ql(o,r,0,null),t=vr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=lh(n),e.memoizedState=ah,t):jf(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return NS(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=$n(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=$n(a,s):(s=vr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?lh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=ah,r}return s=t.child,t=s.sibling,r=$n(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function jf(t,e){return e=ql({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yo(t,e,n,r){return r!==null&&Pf(r),Ci(e,t.child,null,n),t=jf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function NS(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Wc(Error(U(422))),Yo(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=ql({mode:"visible",children:r.children},i,0,null),s=vr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ci(e,t.child,null,o),e.child.memoizedState=lh(o),e.memoizedState=ah,s);if(!(e.mode&1))return Yo(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(U(419)),r=Wc(s,r,void 0),Yo(t,e,o,r)}if(a=(o&t.childLanes)!==0,Je||a){if(r=Ie,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,pn(t,i),Nt(r,t,i,-1))}return Kf(),r=Wc(Error(U(421))),Yo(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=XS.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,st=zn(i.nextSibling),ot=e,fe=!0,Pt=null,t!==null&&(ft[dt++]=ln,ft[dt++]=cn,ft[dt++]=Ar,ln=t.id,cn=t.overflow,Ar=e),e=jf(e,r.children),e.flags|=4096,e)}function Yp(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),th(t.return,e,n)}function $c(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function p0(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Xe(t,e,r.children,n),r=pe.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Yp(t,n,e);else if(t.tag===19)Yp(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ae(pe,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ha(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),$c(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ha(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}$c(e,!0,n,null,s);break;case"together":$c(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ta(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function gn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),br|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=$n(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=$n(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function OS(t,e,n){switch(e.tag){case 3:f0(e),bi();break;case 5:Vy(e);break;case 1:et(e.type)&&Ua(e);break;case 4:Of(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ae(Va,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ae(pe,pe.current&1),e.flags|=128,null):n&e.child.childLanes?d0(t,e,n):(ae(pe,pe.current&1),t=gn(t,e,n),t!==null?t.sibling:null);ae(pe,pe.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return p0(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ae(pe,pe.current),r)break;return null;case 22:case 23:return e.lanes=0,u0(t,e,n)}return gn(t,e,n)}var g0,ch,_0,m0;g0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};ch=function(){};_0=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,pr(Zt.current);var s=null;switch(n){case"input":i=Mu(t,i),r=Mu(t,r),s=[];break;case"select":i=me({},i,{value:void 0}),r=me({},r,{value:void 0}),s=[];break;case"textarea":i=Ou(t,i),r=Ou(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Da)}Fu(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ls.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ls.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ce("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};m0=function(t,e,n,r){n!==r&&(e.flags|=4)};function ss(t,e){if(!fe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Be(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function DS(t,e,n){var r=e.pendingProps;switch(Cf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Be(e),null;case 1:return et(e.type)&&Fa(),Be(e),null;case 3:return r=e.stateNode,Pi(),ue(Ge),ue(He),Ff(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&($o(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Pt!==null&&(mh(Pt),Pt=null))),ch(t,e),Be(e),null;case 5:Df(e);var i=pr(Qs.current);if(n=e.type,t!==null&&e.stateNode!=null)_0(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return Be(e),null}if(t=pr(Zt.current),$o(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[$t]=e,r[qs]=s,t=(e.mode&1)!==0,n){case"dialog":ce("cancel",r),ce("close",r);break;case"iframe":case"object":case"embed":ce("load",r);break;case"video":case"audio":for(i=0;i<ms.length;i++)ce(ms[i],r);break;case"source":ce("error",r);break;case"img":case"image":case"link":ce("error",r),ce("load",r);break;case"details":ce("toggle",r);break;case"input":np(r,s),ce("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ce("invalid",r);break;case"textarea":ip(r,s),ce("invalid",r)}Fu(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Wo(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Wo(r.textContent,a,t),i=["children",""+a]):Ls.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ce("scroll",r)}switch(n){case"input":Fo(r),rp(r,s,!0);break;case"textarea":Fo(r),sp(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Da)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$m(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[$t]=e,t[qs]=r,g0(t,e,!1,!1),e.stateNode=t;e:{switch(o=Uu(n,r),n){case"dialog":ce("cancel",t),ce("close",t),i=r;break;case"iframe":case"object":case"embed":ce("load",t),i=r;break;case"video":case"audio":for(i=0;i<ms.length;i++)ce(ms[i],t);i=r;break;case"source":ce("error",t),i=r;break;case"img":case"image":case"link":ce("error",t),ce("load",t),i=r;break;case"details":ce("toggle",t),i=r;break;case"input":np(t,r),i=Mu(t,r),ce("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=me({},r,{value:void 0}),ce("invalid",t);break;case"textarea":ip(t,r),i=Ou(t,r),ce("invalid",t);break;default:i=r}Fu(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Km(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Xm(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Vs(t,l):typeof l=="number"&&Vs(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Ls.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ce("scroll",t):l!=null&&ff(t,s,l,o))}switch(n){case"input":Fo(t),rp(t,r,!1);break;case"textarea":Fo(t),sp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Kn(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?pi(t,!!r.multiple,s,!1):r.defaultValue!=null&&pi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Da)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Be(e),null;case 6:if(t&&e.stateNode!=null)m0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=pr(Qs.current),pr(Zt.current),$o(e)){if(r=e.stateNode,n=e.memoizedProps,r[$t]=e,(s=r.nodeValue!==n)&&(t=ot,t!==null))switch(t.tag){case 3:Wo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wo(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$t]=e,e.stateNode=r}return Be(e),null;case 13:if(ue(pe),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(fe&&st!==null&&e.mode&1&&!(e.flags&128))Dy(),bi(),e.flags|=98560,s=!1;else if(s=$o(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(U(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(U(317));s[$t]=e}else bi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Be(e),s=!1}else Pt!==null&&(mh(Pt),Pt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||pe.current&1?be===0&&(be=3):Kf())),e.updateQueue!==null&&(e.flags|=4),Be(e),null);case 4:return Pi(),ch(t,e),t===null&&Ys(e.stateNode.containerInfo),Be(e),null;case 10:return Mf(e.type._context),Be(e),null;case 17:return et(e.type)&&Fa(),Be(e),null;case 19:if(ue(pe),s=e.memoizedState,s===null)return Be(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)ss(s,!1);else{if(be!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ha(t),o!==null){for(e.flags|=128,ss(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ae(pe,pe.current&1|2),e.child}t=t.sibling}s.tail!==null&&Te()>Ii&&(e.flags|=128,r=!0,ss(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ha(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ss(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!fe)return Be(e),null}else 2*Te()-s.renderingStartTime>Ii&&n!==1073741824&&(e.flags|=128,r=!0,ss(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Te(),e.sibling=null,n=pe.current,ae(pe,r?n&1|2:n&1),e):(Be(e),null);case 22:case 23:return Yf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?rt&1073741824&&(Be(e),e.subtreeFlags&6&&(e.flags|=8192)):Be(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function FS(t,e){switch(Cf(e),e.tag){case 1:return et(e.type)&&Fa(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Pi(),ue(Ge),ue(He),Ff(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Df(e),null;case 13:if(ue(pe),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));bi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ue(pe),null;case 4:return Pi(),null;case 10:return Mf(e.type._context),null;case 22:case 23:return Yf(),null;case 24:return null;default:return null}}var Ko=!1,ze=!1,US=typeof WeakSet=="function"?WeakSet:Set,j=null;function si(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ve(t,e,r)}else n.current=null}function uh(t,e,n){try{n()}catch(r){ve(t,e,r)}}var Kp=!1;function BS(t,e){if(Yu=ka,t=Ey(),Rf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,f=null;t:for(;;){for(var p;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===n&&++c===i&&(a=o),f===s&&++u===r&&(l=o),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ku={focusedElem:t,selectionRange:n},ka=!1,j=e;j!==null;)if(e=j,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,j=t;else for(;j!==null;){e=j;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var v=T.memoizedProps,S=T.memoizedState,m=e.stateNode,g=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:bt(e.type,v),S);m.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(R){ve(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,j=t;break}j=e.return}return T=Kp,Kp=!1,T}function Ps(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&uh(e,n,s)}i=i.next}while(i!==r)}}function Yl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function y0(t){var e=t.alternate;e!==null&&(t.alternate=null,y0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$t],delete e[qs],delete e[Qu],delete e[TS],delete e[wS])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function v0(t){return t.tag===5||t.tag===3||t.tag===4}function qp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||v0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function fh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Da));else if(r!==4&&(t=t.child,t!==null))for(fh(t,e,n),t=t.sibling;t!==null;)fh(t,e,n),t=t.sibling}function dh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(dh(t,e,n),t=t.sibling;t!==null;)dh(t,e,n),t=t.sibling}var Ne=null,Ct=!1;function En(t,e,n){for(n=n.child;n!==null;)T0(t,e,n),n=n.sibling}function T0(t,e,n){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(Ll,n)}catch{}switch(n.tag){case 5:ze||si(n,e);case 6:var r=Ne,i=Ct;Ne=null,En(t,e,n),Ne=r,Ct=i,Ne!==null&&(Ct?(t=Ne,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ne.removeChild(n.stateNode));break;case 18:Ne!==null&&(Ct?(t=Ne,n=n.stateNode,t.nodeType===8?Bc(t.parentNode,n):t.nodeType===1&&Bc(t,n),Ws(t)):Bc(Ne,n.stateNode));break;case 4:r=Ne,i=Ct,Ne=n.stateNode.containerInfo,Ct=!0,En(t,e,n),Ne=r,Ct=i;break;case 0:case 11:case 14:case 15:if(!ze&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&uh(n,e,o),i=i.next}while(i!==r)}En(t,e,n);break;case 1:if(!ze&&(si(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ve(n,e,a)}En(t,e,n);break;case 21:En(t,e,n);break;case 22:n.mode&1?(ze=(r=ze)||n.memoizedState!==null,En(t,e,n),ze=r):En(t,e,n);break;default:En(t,e,n)}}function Zp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new US),e.forEach(function(r){var i=YS.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Rt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ne=a.stateNode,Ct=!1;break e;case 3:Ne=a.stateNode.containerInfo,Ct=!0;break e;case 4:Ne=a.stateNode.containerInfo,Ct=!0;break e}a=a.return}if(Ne===null)throw Error(U(160));T0(s,o,i),Ne=null,Ct=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){ve(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)w0(e,t),e=e.sibling}function w0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Rt(e,t),Bt(t),r&4){try{Ps(3,t,t.return),Yl(3,t)}catch(v){ve(t,t.return,v)}try{Ps(5,t,t.return)}catch(v){ve(t,t.return,v)}}break;case 1:Rt(e,t),Bt(t),r&512&&n!==null&&si(n,n.return);break;case 5:if(Rt(e,t),Bt(t),r&512&&n!==null&&si(n,n.return),t.flags&32){var i=t.stateNode;try{Vs(i,"")}catch(v){ve(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Hm(i,s),Uu(a,o);var c=Uu(a,s);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?Km(i,h):u==="dangerouslySetInnerHTML"?Xm(i,h):u==="children"?Vs(i,h):ff(i,u,h,c)}switch(a){case"input":ku(i,s);break;case"textarea":Wm(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?pi(i,!!s.multiple,p,!1):f!==!!s.multiple&&(s.defaultValue!=null?pi(i,!!s.multiple,s.defaultValue,!0):pi(i,!!s.multiple,s.multiple?[]:"",!1))}i[qs]=s}catch(v){ve(t,t.return,v)}}break;case 6:if(Rt(e,t),Bt(t),r&4){if(t.stateNode===null)throw Error(U(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){ve(t,t.return,v)}}break;case 3:if(Rt(e,t),Bt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ws(e.containerInfo)}catch(v){ve(t,t.return,v)}break;case 4:Rt(e,t),Bt(t);break;case 13:Rt(e,t),Bt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||($f=Te())),r&4&&Zp(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(ze=(c=ze)||u,Rt(e,t),ze=c):Rt(e,t),Bt(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(j=t,u=t.child;u!==null;){for(h=j=u;j!==null;){switch(f=j,p=f.child,f.tag){case 0:case 11:case 14:case 15:Ps(4,f,f.return);break;case 1:si(f,f.return);var T=f.stateNode;if(typeof T.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(v){ve(r,n,v)}}break;case 5:si(f,f.return);break;case 22:if(f.memoizedState!==null){Jp(h);continue}}p!==null?(p.return=f,j=p):Jp(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Ym("display",o))}catch(v){ve(t,t.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){ve(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Rt(e,t),Bt(t),r&4&&Zp(t);break;case 21:break;default:Rt(e,t),Bt(t)}}function Bt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(v0(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Vs(i,""),r.flags&=-33);var s=qp(t);dh(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=qp(t);fh(t,a,o);break;default:throw Error(U(161))}}catch(l){ve(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function LS(t,e,n){j=t,E0(t)}function E0(t,e,n){for(var r=(t.mode&1)!==0;j!==null;){var i=j,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ko;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||ze;a=Ko;var c=ze;if(Ko=o,(ze=l)&&!c)for(j=i;j!==null;)o=j,l=o.child,o.tag===22&&o.memoizedState!==null?Gp(i):l!==null?(l.return=o,j=l):Gp(i);for(;s!==null;)j=s,E0(s),s=s.sibling;j=i,Ko=a,ze=c}Qp(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,j=s):Qp(t)}}function Qp(t){for(;j!==null;){var e=j;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ze||Yl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ze)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:bt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Dp(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Dp(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Ws(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}ze||e.flags&512&&hh(e)}catch(f){ve(e,e.return,f)}}if(e===t){j=null;break}if(n=e.sibling,n!==null){n.return=e.return,j=n;break}j=e.return}}function Jp(t){for(;j!==null;){var e=j;if(e===t){j=null;break}var n=e.sibling;if(n!==null){n.return=e.return,j=n;break}j=e.return}}function Gp(t){for(;j!==null;){var e=j;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Yl(4,e)}catch(l){ve(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ve(e,i,l)}}var s=e.return;try{hh(e)}catch(l){ve(e,s,l)}break;case 5:var o=e.return;try{hh(e)}catch(l){ve(e,o,l)}}}catch(l){ve(e,e.return,l)}if(e===t){j=null;break}var a=e.sibling;if(a!==null){a.return=e.return,j=a;break}j=e.return}}var VS=Math.ceil,Xa=mn.ReactCurrentDispatcher,Hf=mn.ReactCurrentOwner,mt=mn.ReactCurrentBatchConfig,J=0,Ie=null,Ae=null,Oe=0,rt=0,oi=Gn(0),be=0,to=null,br=0,Kl=0,Wf=0,xs=null,Qe=null,$f=0,Ii=1/0,rn=null,Ya=!1,ph=null,Hn=null,qo=!1,On=null,Ka=0,Is=0,gh=null,wa=-1,Ea=0;function Ye(){return J&6?Te():wa!==-1?wa:wa=Te()}function Wn(t){return t.mode&1?J&2&&Oe!==0?Oe&-Oe:SS.transition!==null?(Ea===0&&(Ea=oy()),Ea):(t=ne,t!==0||(t=window.event,t=t===void 0?16:dy(t.type)),t):1}function Nt(t,e,n,r){if(50<Is)throw Is=0,gh=null,Error(U(185));uo(t,n,r),(!(J&2)||t!==Ie)&&(t===Ie&&(!(J&2)&&(Kl|=n),be===4&&kn(t,Oe)),tt(t,r),n===1&&J===0&&!(e.mode&1)&&(Ii=Te()+500,Wl&&er()))}function tt(t,e){var n=t.callbackNode;SE(t,e);var r=Ma(t,t===Ie?Oe:0);if(r===0)n!==null&&lp(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lp(n),e===1)t.tag===0?ES(eg.bind(null,t)):ky(eg.bind(null,t)),yS(function(){!(J&6)&&er()}),n=null;else{switch(ay(r)){case 1:n=mf;break;case 4:n=iy;break;case 16:n=Ia;break;case 536870912:n=sy;break;default:n=Ia}n=I0(n,S0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function S0(t,e){if(wa=-1,Ea=0,J&6)throw Error(U(327));var n=t.callbackNode;if(vi()&&t.callbackNode!==n)return null;var r=Ma(t,t===Ie?Oe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=qa(t,r);else{e=r;var i=J;J|=2;var s=R0();(Ie!==t||Oe!==e)&&(rn=null,Ii=Te()+500,yr(t,e));do try{HS();break}catch(a){A0(t,a)}while(!0);If(),Xa.current=s,J=i,Ae!==null?e=0:(Ie=null,Oe=0,e=be)}if(e!==0){if(e===2&&(i=ju(t),i!==0&&(r=i,e=_h(t,i))),e===1)throw n=to,yr(t,0),kn(t,r),tt(t,Te()),n;if(e===6)kn(t,r);else{if(i=t.current.alternate,!(r&30)&&!zS(i)&&(e=qa(t,r),e===2&&(s=ju(t),s!==0&&(r=s,e=_h(t,s))),e===1))throw n=to,yr(t,0),kn(t,r),tt(t,Te()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:ar(t,Qe,rn);break;case 3:if(kn(t,r),(r&130023424)===r&&(e=$f+500-Te(),10<e)){if(Ma(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ye(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Zu(ar.bind(null,t,Qe,rn),e);break}ar(t,Qe,rn);break;case 4:if(kn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-kt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Te()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*VS(r/1960))-r,10<r){t.timeoutHandle=Zu(ar.bind(null,t,Qe,rn),r);break}ar(t,Qe,rn);break;case 5:ar(t,Qe,rn);break;default:throw Error(U(329))}}}return tt(t,Te()),t.callbackNode===n?S0.bind(null,t):null}function _h(t,e){var n=xs;return t.current.memoizedState.isDehydrated&&(yr(t,e).flags|=256),t=qa(t,e),t!==2&&(e=Qe,Qe=n,e!==null&&mh(e)),t}function mh(t){Qe===null?Qe=t:Qe.push.apply(Qe,t)}function zS(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ot(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function kn(t,e){for(e&=~Wf,e&=~Kl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-kt(e),r=1<<n;t[n]=-1,e&=~r}}function eg(t){if(J&6)throw Error(U(327));vi();var e=Ma(t,0);if(!(e&1))return tt(t,Te()),null;var n=qa(t,e);if(t.tag!==0&&n===2){var r=ju(t);r!==0&&(e=r,n=_h(t,r))}if(n===1)throw n=to,yr(t,0),kn(t,e),tt(t,Te()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ar(t,Qe,rn),tt(t,Te()),null}function Xf(t,e){var n=J;J|=1;try{return t(e)}finally{J=n,J===0&&(Ii=Te()+500,Wl&&er())}}function Cr(t){On!==null&&On.tag===0&&!(J&6)&&vi();var e=J;J|=1;var n=mt.transition,r=ne;try{if(mt.transition=null,ne=1,t)return t()}finally{ne=r,mt.transition=n,J=e,!(J&6)&&er()}}function Yf(){rt=oi.current,ue(oi)}function yr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,mS(n)),Ae!==null)for(n=Ae.return;n!==null;){var r=n;switch(Cf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fa();break;case 3:Pi(),ue(Ge),ue(He),Ff();break;case 5:Df(r);break;case 4:Pi();break;case 13:ue(pe);break;case 19:ue(pe);break;case 10:Mf(r.type._context);break;case 22:case 23:Yf()}n=n.return}if(Ie=t,Ae=t=$n(t.current,null),Oe=rt=e,be=0,to=null,Wf=Kl=br=0,Qe=xs=null,dr!==null){for(e=0;e<dr.length;e++)if(n=dr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}dr=null}return t}function A0(t,e){do{var n=Ae;try{if(If(),ya.current=$a,Wa){for(var r=_e.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Wa=!1}if(Rr=0,xe=Re=_e=null,Cs=!1,Js=0,Hf.current=null,n===null||n.return===null){be=1,to=e,Ae=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Oe,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=zp(o);if(p!==null){p.flags&=-257,jp(p,o,a,s,e),p.mode&1&&Vp(s,c,e),e=p,l=c;var T=e.updateQueue;if(T===null){var v=new Set;v.add(l),e.updateQueue=v}else T.add(l);break e}else{if(!(e&1)){Vp(s,c,e),Kf();break e}l=Error(U(426))}}else if(fe&&a.mode&1){var S=zp(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),jp(S,o,a,s,e),Pf(xi(l,a));break e}}s=l=xi(l,a),be!==4&&(be=2),xs===null?xs=[s]:xs.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=a0(s,l,e);Op(s,m);break e;case 1:a=l;var g=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Hn===null||!Hn.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var R=l0(s,a,e);Op(s,R);break e}}s=s.return}while(s!==null)}C0(n)}catch(P){e=P,Ae===n&&n!==null&&(Ae=n=n.return);continue}break}while(!0)}function R0(){var t=Xa.current;return Xa.current=$a,t===null?$a:t}function Kf(){(be===0||be===3||be===2)&&(be=4),Ie===null||!(br&268435455)&&!(Kl&268435455)||kn(Ie,Oe)}function qa(t,e){var n=J;J|=2;var r=R0();(Ie!==t||Oe!==e)&&(rn=null,yr(t,e));do try{jS();break}catch(i){A0(t,i)}while(!0);if(If(),J=n,Xa.current=r,Ae!==null)throw Error(U(261));return Ie=null,Oe=0,be}function jS(){for(;Ae!==null;)b0(Ae)}function HS(){for(;Ae!==null&&!pE();)b0(Ae)}function b0(t){var e=x0(t.alternate,t,rt);t.memoizedProps=t.pendingProps,e===null?C0(t):Ae=e,Hf.current=null}function C0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=FS(n,e),n!==null){n.flags&=32767,Ae=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{be=6,Ae=null;return}}else if(n=DS(n,e,rt),n!==null){Ae=n;return}if(e=e.sibling,e!==null){Ae=e;return}Ae=e=t}while(e!==null);be===0&&(be=5)}function ar(t,e,n){var r=ne,i=mt.transition;try{mt.transition=null,ne=1,WS(t,e,n,r)}finally{mt.transition=i,ne=r}return null}function WS(t,e,n,r){do vi();while(On!==null);if(J&6)throw Error(U(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(AE(t,s),t===Ie&&(Ae=Ie=null,Oe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||qo||(qo=!0,I0(Ia,function(){return vi(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=mt.transition,mt.transition=null;var o=ne;ne=1;var a=J;J|=4,Hf.current=null,BS(t,n),w0(n,t),uS(Ku),ka=!!Yu,Ku=Yu=null,t.current=n,LS(n),gE(),J=a,ne=o,mt.transition=s}else t.current=n;if(qo&&(qo=!1,On=t,Ka=i),s=t.pendingLanes,s===0&&(Hn=null),yE(n.stateNode),tt(t,Te()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ya)throw Ya=!1,t=ph,ph=null,t;return Ka&1&&t.tag!==0&&vi(),s=t.pendingLanes,s&1?t===gh?Is++:(Is=0,gh=t):Is=0,er(),null}function vi(){if(On!==null){var t=ay(Ka),e=mt.transition,n=ne;try{if(mt.transition=null,ne=16>t?16:t,On===null)var r=!1;else{if(t=On,On=null,Ka=0,J&6)throw Error(U(331));var i=J;for(J|=4,j=t.current;j!==null;){var s=j,o=s.child;if(j.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(j=c;j!==null;){var u=j;switch(u.tag){case 0:case 11:case 15:Ps(8,u,s)}var h=u.child;if(h!==null)h.return=u,j=h;else for(;j!==null;){u=j;var f=u.sibling,p=u.return;if(y0(u),u===c){j=null;break}if(f!==null){f.return=p,j=f;break}j=p}}}var T=s.alternate;if(T!==null){var v=T.child;if(v!==null){T.child=null;do{var S=v.sibling;v.sibling=null,v=S}while(v!==null)}}j=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,j=o;else e:for(;j!==null;){if(s=j,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ps(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,j=m;break e}j=s.return}}var g=t.current;for(j=g;j!==null;){o=j;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,j=y;else e:for(o=g;j!==null;){if(a=j,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Yl(9,a)}}catch(P){ve(a,a.return,P)}if(a===o){j=null;break e}var R=a.sibling;if(R!==null){R.return=a.return,j=R;break e}j=a.return}}if(J=i,er(),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(Ll,t)}catch{}r=!0}return r}finally{ne=n,mt.transition=e}}return!1}function tg(t,e,n){e=xi(n,e),e=a0(t,e,1),t=jn(t,e,1),e=Ye(),t!==null&&(uo(t,1,e),tt(t,e))}function ve(t,e,n){if(t.tag===3)tg(t,t,n);else for(;e!==null;){if(e.tag===3){tg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hn===null||!Hn.has(r))){t=xi(n,t),t=l0(e,t,1),e=jn(e,t,1),t=Ye(),e!==null&&(uo(e,1,t),tt(e,t));break}}e=e.return}}function $S(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ye(),t.pingedLanes|=t.suspendedLanes&n,Ie===t&&(Oe&n)===n&&(be===4||be===3&&(Oe&130023424)===Oe&&500>Te()-$f?yr(t,0):Wf|=n),tt(t,e)}function P0(t,e){e===0&&(t.mode&1?(e=Lo,Lo<<=1,!(Lo&130023424)&&(Lo=4194304)):e=1);var n=Ye();t=pn(t,e),t!==null&&(uo(t,e,n),tt(t,n))}function XS(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),P0(t,n)}function YS(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),P0(t,n)}var x0;x0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ge.current)Je=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Je=!1,OS(t,e,n);Je=!!(t.flags&131072)}else Je=!1,fe&&e.flags&1048576&&Ny(e,La,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ta(t,e),t=e.pendingProps;var i=Ri(e,He.current);yi(e,n),i=Bf(null,e,r,t,i,n);var s=Lf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,et(r)?(s=!0,Ua(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Nf(e),i.updater=Xl,e.stateNode=i,i._reactInternals=e,rh(e,r,t,n),e=oh(null,e,r,!0,s,n)):(e.tag=0,fe&&s&&bf(e),Xe(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ta(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=qS(r),t=bt(r,t),i){case 0:e=sh(null,e,r,t,n);break e;case 1:e=$p(null,e,r,t,n);break e;case 11:e=Hp(null,e,r,t,n);break e;case 14:e=Wp(null,e,r,bt(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),sh(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),$p(t,e,r,i,n);case 3:e:{if(f0(e),t===null)throw Error(U(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Ly(t,e),ja(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=xi(Error(U(423)),e),e=Xp(t,e,r,n,i);break e}else if(r!==i){i=xi(Error(U(424)),e),e=Xp(t,e,r,n,i);break e}else for(st=zn(e.stateNode.containerInfo.firstChild),ot=e,fe=!0,Pt=null,n=Uy(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(bi(),r===i){e=gn(t,e,n);break e}Xe(t,e,r,n)}e=e.child}return e;case 5:return Vy(e),t===null&&eh(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,qu(r,i)?o=null:s!==null&&qu(r,s)&&(e.flags|=32),h0(t,e),Xe(t,e,o,n),e.child;case 6:return t===null&&eh(e),null;case 13:return d0(t,e,n);case 4:return Of(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ci(e,null,r,n):Xe(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),Hp(t,e,r,i,n);case 7:return Xe(t,e,e.pendingProps,n),e.child;case 8:return Xe(t,e,e.pendingProps.children,n),e.child;case 12:return Xe(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ae(Va,r._currentValue),r._currentValue=o,s!==null)if(Ot(s.value,o)){if(s.children===i.children&&!Ge.current){e=gn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=hn(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),th(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(U(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),th(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Xe(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,yi(e,n),i=Tt(i),r=r(i),e.flags|=1,Xe(t,e,r,n),e.child;case 14:return r=e.type,i=bt(r,e.pendingProps),i=bt(r.type,i),Wp(t,e,r,i,n);case 15:return c0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:bt(r,i),Ta(t,e),e.tag=1,et(r)?(t=!0,Ua(e)):t=!1,yi(e,n),o0(e,r,i),rh(e,r,i,n),oh(null,e,r,!0,t,n);case 19:return p0(t,e,n);case 22:return u0(t,e,n)}throw Error(U(156,e.tag))};function I0(t,e){return ry(t,e)}function KS(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pt(t,e,n,r){return new KS(t,e,n,r)}function qf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function qS(t){if(typeof t=="function")return qf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===pf)return 11;if(t===gf)return 14}return 2}function $n(t,e){var n=t.alternate;return n===null?(n=pt(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Sa(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")qf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Zr:return vr(n.children,i,s,e);case df:o=8,i|=8;break;case Cu:return t=pt(12,n,e,i|2),t.elementType=Cu,t.lanes=s,t;case Pu:return t=pt(13,n,e,i),t.elementType=Pu,t.lanes=s,t;case xu:return t=pt(19,n,e,i),t.elementType=xu,t.lanes=s,t;case Vm:return ql(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Bm:o=10;break e;case Lm:o=9;break e;case pf:o=11;break e;case gf:o=14;break e;case Cn:o=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=pt(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function vr(t,e,n,r){return t=pt(7,t,r,e),t.lanes=n,t}function ql(t,e,n,r){return t=pt(22,t,r,e),t.elementType=Vm,t.lanes=n,t.stateNode={isHidden:!1},t}function Xc(t,e,n){return t=pt(6,t,null,e),t.lanes=n,t}function Yc(t,e,n){return e=pt(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ZS(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cc(0),this.expirationTimes=Cc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Zf(t,e,n,r,i,s,o,a,l){return t=new ZS(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=pt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nf(s),t}function QS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qr,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function M0(t){if(!t)return qn;t=t._reactInternals;e:{if(Mr(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(et(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(et(n))return My(t,n,e)}return e}function k0(t,e,n,r,i,s,o,a,l){return t=Zf(n,r,!0,t,i,s,o,a,l),t.context=M0(null),n=t.current,r=Ye(),i=Wn(n),s=hn(r,i),s.callback=e??null,jn(n,s,i),t.current.lanes=i,uo(t,i,r),tt(t,r),t}function Zl(t,e,n,r){var i=e.current,s=Ye(),o=Wn(i);return n=M0(n),e.context===null?e.context=n:e.pendingContext=n,e=hn(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=jn(i,e,o),t!==null&&(Nt(t,i,o,s),ma(t,i,o)),o}function Za(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ng(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qf(t,e){ng(t,e),(t=t.alternate)&&ng(t,e)}function JS(){return null}var N0=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jf(t){this._internalRoot=t}Ql.prototype.render=Jf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Zl(t,e,null,null)};Ql.prototype.unmount=Jf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Cr(function(){Zl(null,t,null,null)}),e[dn]=null}};function Ql(t){this._internalRoot=t}Ql.prototype.unstable_scheduleHydration=function(t){if(t){var e=uy();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Mn.length&&e!==0&&e<Mn[n].priority;n++);Mn.splice(n,0,t),n===0&&fy(t)}};function Gf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Jl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function rg(){}function GS(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Za(o);s.call(c)}}var o=k0(e,r,t,0,null,!1,!1,"",rg);return t._reactRootContainer=o,t[dn]=o.current,Ys(t.nodeType===8?t.parentNode:t),Cr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Za(l);a.call(c)}}var l=Zf(t,0,!1,null,null,!1,!1,"",rg);return t._reactRootContainer=l,t[dn]=l.current,Ys(t.nodeType===8?t.parentNode:t),Cr(function(){Zl(e,l,n,r)}),l}function Gl(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Za(o);a.call(l)}}Zl(e,o,t,i)}else o=GS(n,e,t,i,r);return Za(o)}ly=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=_s(e.pendingLanes);n!==0&&(yf(e,n|1),tt(e,Te()),!(J&6)&&(Ii=Te()+500,er()))}break;case 13:Cr(function(){var r=pn(t,1);if(r!==null){var i=Ye();Nt(r,t,1,i)}}),Qf(t,1)}};vf=function(t){if(t.tag===13){var e=pn(t,134217728);if(e!==null){var n=Ye();Nt(e,t,134217728,n)}Qf(t,134217728)}};cy=function(t){if(t.tag===13){var e=Wn(t),n=pn(t,e);if(n!==null){var r=Ye();Nt(n,t,e,r)}Qf(t,e)}};uy=function(){return ne};hy=function(t,e){var n=ne;try{return ne=t,e()}finally{ne=n}};Lu=function(t,e,n){switch(e){case"input":if(ku(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Hl(r);if(!i)throw Error(U(90));jm(r),ku(r,i)}}}break;case"textarea":Wm(t,n);break;case"select":e=n.value,e!=null&&pi(t,!!n.multiple,e,!1)}};Qm=Xf;Jm=Cr;var e1={usingClientEntryPoint:!1,Events:[fo,ei,Hl,qm,Zm,Xf]},os={findFiberByHostInstance:fr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t1={bundleType:os.bundleType,version:os.version,rendererPackageName:os.rendererPackageName,rendererConfig:os.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=ty(t),t===null?null:t.stateNode},findFiberByHostInstance:os.findFiberByHostInstance||JS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zo.isDisabled&&Zo.supportsFiber)try{Ll=Zo.inject(t1),qt=Zo}catch{}}lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e1;lt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gf(e))throw Error(U(200));return QS(t,e,null,n)};lt.createRoot=function(t,e){if(!Gf(t))throw Error(U(299));var n=!1,r="",i=N0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Zf(t,1,!1,null,null,n,!1,r,i),t[dn]=e.current,Ys(t.nodeType===8?t.parentNode:t),new Jf(e)};lt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=ty(e),t=t===null?null:t.stateNode,t};lt.flushSync=function(t){return Cr(t)};lt.hydrate=function(t,e,n){if(!Jl(e))throw Error(U(200));return Gl(null,t,e,!0,n)};lt.hydrateRoot=function(t,e,n){if(!Gf(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=N0;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=k0(e,null,t,1,n??null,i,!1,s,o),t[dn]=e.current,Ys(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Ql(e)};lt.render=function(t,e,n){if(!Jl(e))throw Error(U(200));return Gl(null,t,e,!1,n)};lt.unmountComponentAtNode=function(t){if(!Jl(t))throw Error(U(40));return t._reactRootContainer?(Cr(function(){Gl(null,null,t,!1,function(){t._reactRootContainer=null,t[dn]=null})}),!0):!1};lt.unstable_batchedUpdates=Xf;lt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Jl(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return Gl(t,e,n,!1,r)};lt.version="18.3.1-next-f1338f8080-20240426";function O0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O0)}catch(t){console.error(t)}}O0(),Om.exports=lt;var ed=Om.exports,D0,ig=ed;D0=ig.createRoot,ig.hydrateRoot;const n1="modulepreload",r1=function(t){return"/microcredit-map/"+t},sg={},i1=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=r1(l),l in sg)return;sg[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":n1,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},s1=L.createContext(null);function o1(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function an(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!an(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!an(t[i],e[i]))return!1;return!0}return!1}function a1(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function og(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();an(n,r)||e.setProjection(n)}function ag(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function lg(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const l1=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function cg(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of l1)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}var ug={};const hg={version:8,sources:{},layers:[]},fg={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Kc={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},dg={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},c1=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],u1=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Mi{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[dg[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[fg[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[Kc[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Mi.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=hg}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||h1()||null,container:e,style:cg(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=u=>{this._inRender=!0,a.call(o,u),this._inRender=!1};const l=o._renderTaskQueue.run;o._renderTaskQueue.run=u=>{l.call(o._renderTaskQueue,u),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const c=o.fire;o.fire=this._fireEvent.bind(this,c),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),og(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in fg)o.on(u,this._onPointerEvent);for(const u in Kc)o.on(u,this._onCameraEvent);for(const u in dg)o.on(u,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Mi.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=a1(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const c=lg(i,{...ag(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),c&&n){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=s!==i.zoom),u.rotate||(u.rotate=a!==i.bearing),u.pitch||(u.pitch=o!==i.pitch)}return l||lg(r.transform,e),c}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of c1)if(s in e&&!an(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=hg,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(cg(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!an(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!an(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!an(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of u1){const l=(r=e[a])!==null&&r!==void 0?r:!0,c=(i=n[a])!==null&&i!==void 0?i:!0;an(l,c)||(o=!0,l?s[a].enable(l):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in Kc&&(typeof n=="object"&&(n.viewState=ag(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{og(this._renderTransform,n),e.transform=n}}}Mi.savedMaps=[];function h1(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||ug.MapboxAccessToken}catch{}try{t=t||ug.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const f1=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function d1(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of p1(e))!(r in n)&&!f1.includes(r)&&(n[r]=e[r].bind(e));return n}function p1(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const g1=typeof document<"u"?L.useLayoutEffect:L.useEffect,_1=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function m1(t,e){for(const r of _1)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const ec=L.createContext(null);function y1(t,e,n){const r=L.useContext(s1),[i,s]=L.useState(null),o=L.useRef(),{current:a}=L.useRef({mapLib:null,map:null});L.useEffect(()=>{const u=t.mapLib;let h=!0,f;return Promise.resolve(u||n).then(p=>{if(!h)return;if(!p)throw new Error("Invalid mapLib");const T="Map"in p?p:p.default;if(!T.Map)throw new Error("Invalid mapLib");if(m1(T,t),!T.supported||T.supported(t))t.reuseMaps&&(f=Mi.reuse(t,o.current)),f||(f=new Mi(T.Map,t,o.current)),a.map=d1(f),a.mapLib=T,s(f),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(p=>{const{onError:T}=t;T?T({type:"error",target:null,originalEvent:null,error:p}):console.error(p)}),()=>{h=!1,f&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?f.recycle():f.destroy())}},[]),g1(()=>{i&&i.setProps(t)}),L.useImperativeHandle(e,()=>a.map,[i]);const l=L.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),c={height:"100%"};return L.createElement("div",{id:t.id,ref:o,style:l},i&&L.createElement(ec.Provider,{value:a},L.createElement("div",{"mapboxgl-children":"",style:c},t.children)))}const v1=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function kr(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!v1.test(r)?n[r]=`${i}px`:n[r]=i}}function T1(t,e){const{map:n,mapLib:r}=L.useContext(ec),i=L.useRef({props:t});i.current.props=t;const s=L.useMemo(()=>{let v=!1;L.Children.forEach(t.children,g=>{g&&(v=!0)});const S={...t,element:v?document.createElement("div"):null},m=new r.Marker(S);return m.setLngLat([t.longitude,t.latitude]),m.getElement().addEventListener("click",g=>{var y,R;(R=(y=i.current.props).onClick)===null||R===void 0||R.call(y,{type:"click",target:m,originalEvent:g})}),m.on("dragstart",g=>{var y,R;const P=g;P.lngLat=s.getLngLat(),(R=(y=i.current.props).onDragStart)===null||R===void 0||R.call(y,P)}),m.on("drag",g=>{var y,R;const P=g;P.lngLat=s.getLngLat(),(R=(y=i.current.props).onDrag)===null||R===void 0||R.call(y,P)}),m.on("dragend",g=>{var y,R;const P=g;P.lngLat=s.getLngLat(),(R=(y=i.current.props).onDragEnd)===null||R===void 0||R.call(y,P)}),m},[]);L.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:l,style:c,draggable:u=!1,popup:h=null,rotation:f=0,rotationAlignment:p="auto",pitchAlignment:T="auto"}=t;return L.useEffect(()=>{kr(s.getElement(),c)},[c]),L.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),l&&!o1(s.getOffset(),l)&&s.setOffset(l),s.isDraggable()!==u&&s.setDraggable(u),s.getRotation()!==f&&s.setRotation(f),s.getRotationAlignment()!==p&&s.setRotationAlignment(p),s.getPitchAlignment()!==T&&s.setPitchAlignment(T),s.getPopup()!==h&&s.setPopup(h),ed.createPortal(t.children,s.getElement())}L.memo(L.forwardRef(T1));function pg(t){return new Set(t?t.trim().split(/\s+/):[])}function w1(t,e){const{map:n,mapLib:r}=L.useContext(ec),i=L.useMemo(()=>document.createElement("div"),[]),s=L.useRef({props:t});s.current.props=t;const o=L.useMemo(()=>{const a={...t},l=new r.Popup(a);return l.setLngLat([t.longitude,t.latitude]),l.once("open",c=>{var u,h;(h=(u=s.current.props).onOpen)===null||h===void 0||h.call(u,c)}),l},[]);if(L.useEffect(()=>{const a=l=>{var c,u;(u=(c=s.current.props).onClose)===null||u===void 0||u.call(c,l)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),L.useEffect(()=>{kr(o.getElement(),t.style)},[t.style]),L.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!an(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=pg(o.options.className),l=pg(t.className);for(const c of a)l.has(c)||o.removeClassName(c);for(const c of l)a.has(c)||o.addClassName(c);o.options.className=t.className}return ed.createPortal(t.children,i)}L.memo(L.forwardRef(w1));function go(t,e,n,r){const i=L.useContext(ec),s=L.useMemo(()=>t(i),[]);return L.useEffect(()=>{const o=e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof e=="function"?e:null,{map:c}=i;return c.hasControl(s)||(c.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),c.hasControl(s)&&c.removeControl(s)}},[]),s}function E1(t){const e=go(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return L.useEffect(()=>{kr(e._container,t.style)},[t.style]),null}L.memo(E1);function S1(t){const e=go(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return L.useEffect(()=>{kr(e._controlContainer,t.style)},[t.style]),null}L.memo(S1);function A1(t,e){const n=L.useRef({props:t}),r=go(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,c;(c=(l=n.current.props).onGeolocate)===null||c===void 0||c.call(l,a)}),s.on("error",a=>{var l,c;(c=(l=n.current.props).onError)===null||c===void 0||c.call(l,a)}),s.on("outofmaxbounds",a=>{var l,c;(c=(l=n.current.props).onOutOfMaxBounds)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationStart)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationend",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationEnd)===null||c===void 0||c.call(l,a)}),s},{position:t.position});return n.current.props=t,L.useImperativeHandle(e,()=>r,[]),L.useEffect(()=>{kr(r._container,t.style)},[t.style]),null}L.memo(L.forwardRef(A1));function R1(t){const e=go(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return L.useEffect(()=>{kr(e._container,t.style)},[t.style]),null}L.memo(R1);function b1(t){const e=go(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=L.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),L.useEffect(()=>{kr(e._container,i)},[i]),null}L.memo(b1);const C1=i1(()=>import("./maplibre-gl-D28kWg8f.js").then(t=>t.m),[]),P1=L.forwardRef(function(e,n){return y1(e,n,C1)});function Qa(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const td=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),gg=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);gg&&parseFloat(gg[1]);const Qo=globalThis,Lr=globalThis.process||{},x1=globalThis.navigator||{};function F0(t){var r,i;if(typeof window<"u"&&((r=window.process)==null?void 0:r.type)==="renderer"||typeof process<"u"&&((i=process.versions)!=null&&i.electron))return!0;const n=typeof navigator<"u"&&navigator.userAgent;return!!(n&&n.indexOf("Electron")>=0)}function tr(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||F0()}function I1(t){return tr()?F0()?"Electron":(x1.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const U0="4.0.7";function M1(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class k1{constructor(e,n,r="sessionStorage"){this.storage=M1(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function N1(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function O1(t,e=8){const n=Math.max(e-t.length,0);return`${" ".repeat(n)}${t}`}var Ja;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ja||(Ja={}));const D1=10;function _g(t){return typeof t!="string"?t:(t=t.toUpperCase(),Ja[t]||Ja.WHITE)}function F1(t,e,n){return!tr&&typeof t=="string"&&(e&&(t=`\x1B[${_g(e)}m${t}\x1B[39m`),n&&(t=`\x1B[${_g(n)+D1}m${t}\x1B[49m`)),t}function U1(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function nd(t,e){if(!t)throw new Error("Assertion failed")}function Vr(){var e,n,r;let t;if(tr()&&Qo.performance)t=(n=(e=Qo==null?void 0:Qo.performance)==null?void 0:e.now)==null?void 0:n.call(e);else if("hrtime"in Lr){const i=(r=Lr==null?void 0:Lr.hrtime)==null?void 0:r.call(Lr);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const zr={debug:tr()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},B1={enabled:!0,level:0};function jr(){}const mg={},yg={once:!0};class _o{constructor({id:e}={id:""}){this.VERSION=U0,this._startTs=Vr(),this._deltaTs=Vr(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new k1(`__probe-${this.id}__`,B1),this.timeStamp(`${this.id} started`),U1(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Vr()-this._startTs).toPrecision(10))}getDelta(){return Number((Vr()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){if(!e)throw new Error(n||"Assertion failed")}warn(e){return this._getLogFunction(0,e,zr.warn,arguments,yg)}error(e){return this._getLogFunction(0,e,zr.error,arguments)}deprecated(e,n){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${n}\` instead`)}removed(e,n){return this.error(`\`${e}\` has been removed. Use \`${n}\` instead`)}probe(e,n){return this._getLogFunction(e,n,zr.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,zr.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,zr.debug||zr.info,arguments,yg)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||jr,r&&[r],{tag:V1(n)}):jr}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||jr)}group(e,n,r={collapsed:!1}){const i=vg({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n,r={}){return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||jr)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=B0(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=vg({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,nd(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Vr();const o=s.tag||s.message;if(s.once&&o)if(!mg[o])mg[o]=Vr();else return jr;return n=L1(this.id,s.message,s),r.bind(console,n,...s.args)}return jr}}_o.VERSION=U0;function B0(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return nd(Number.isFinite(e)&&e>=0),e}function vg(t){const{logLevel:e,message:n}=t;t.logLevel=B0(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return nd(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function L1(t,e,n){if(typeof e=="string"){const r=n.time?O1(N1(n.total)):"";e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,e=F1(e,n.color,n.background)}return e}function V1(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const qc="4.3.1",z1=qc[0]>="0"&&qc[0]<="9"?`v${qc}`:"";function j1(){const t=new _o({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=z1,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const H1=j1();function W1(t,e){return L0(t||{},e)}function L0(t,e,n=0){if(n>3)return e;const r={...t};for(const[i,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?r[i]=L0(r[i]||{},e[i],n+1):r[i]=e[i];return r}const $1="latest";function X1(){var t;return(t=globalThis._loadersgl_)!=null&&t.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.1"),globalThis._loadersgl_.version}const Y1=X1();function Zn(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Tr=typeof process!="object"||String(process)!=="[object process]"||process.browser,K1=typeof window<"u"&&typeof window.orientation<"u",Tg=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Tg&&parseFloat(Tg[1]);class q1{constructor(e,n){d(this,"name");d(this,"workerThread");d(this,"isRunning",!0);d(this,"result");d(this,"_resolve",()=>{});d(this,"_reject",()=>{});this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Zn(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Zn(this.isRunning),this.isRunning=!1,this._reject(e)}}class Zc{terminate(){}}const Qc=new Map;function Z1(t){Zn(t.source&&!t.url||!t.source&&t.url);let e=Qc.get(t.source||t.url);return e||(t.url&&(e=Q1(t.url),Qc.set(t.url,e)),t.source&&(e=V0(t.source),Qc.set(t.source,e))),Zn(e),e}function Q1(t){if(!t.startsWith("http"))return t;const e=J1(t);return V0(e)}function V0(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function J1(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function z0(t,e=!0,n){const r=n||new Set;if(t){if(wg(t))r.add(t);else if(wg(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)z0(t[i],e,r)}}return n===void 0?Array.from(r):[]}function wg(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Jc=()=>{};class yh{constructor(e){d(this,"name");d(this,"source");d(this,"url");d(this,"terminated",!1);d(this,"worker");d(this,"onMessage");d(this,"onError");d(this,"_loadableURL","");const{name:n,source:r,url:i}=e;Zn(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Jc,this.onError=s=>console.log(s),this.worker=Tr?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&Tr||typeof Zc<"u"&&!Tr}destroy(){this.onMessage=Jc,this.onError=Jc,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||z0(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+=`worker ${this.name} from ${this.url}. `,e.message&&(n+=`${e.message} in `),e.lineno&&(n+=`:${e.lineno}:${e.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=Z1({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new Zc(r,{eval:!1})}else if(this.source)e=new Zc(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class G1{constructor(e){d(this,"name","unnamed");d(this,"source");d(this,"url");d(this,"maxConcurrency",1);d(this,"maxMobileConcurrency",1);d(this,"onDebug",()=>{});d(this,"reuseWorkers",!0);d(this,"props",{});d(this,"jobQueue",[]);d(this,"idleQueue",[]);d(this,"count",0);d(this,"isDestroyed",!1);this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return yh.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new q1(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Tr||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new yh({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return K1?this.maxMobileConcurrency:this.maxConcurrency}}const eA={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},In=class In{constructor(e){d(this,"props");d(this,"workerPools",new Map);this.props={...eA},this.setProps(e),this.workerPools=new Map}static isSupported(){return yh.isSupported()}static getWorkerFarm(e={}){return In._workerFarm=In._workerFarm||new In({}),In._workerFarm.setProps(e),In._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new G1({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};d(In,"_workerFarm");let Ga=In;function tA(t,e={}){const n=e[t.id]||{},r=Tr?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(Tr?i=`modules/${t.module}/dist/${r}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let s=t.version;s==="latest"&&(s=$1);const o=s?`@${s}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${o}/dist/${r}`}return Zn(i),i}function nA(t,e=Y1){Zn(t,"no worker provided");const n=t.version;return!(!e||!n)}function rA(t,e){return!Ga.isSupported()||!Tr&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function iA(t,e,n,r,i){const s=t.id,o=tA(t,n),l=Ga.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const c=await l.startJob("process-on-worker",sA.bind(null,i));return c.postMessage("process",{input:e,options:n,context:r}),await(await c.result).result}async function sA(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function oA(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function aA(...t){return lA(t)}function lA(t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}async function cA(t){const e=[];for await(const n of t)e.push(n);return aA(...e)}function Eg(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class Sg{constructor(e,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Eg(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Eg()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class tc{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,n="count"){return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof Sg?i=e:i=new Sg(n,r),this.stats[n]=i),i}}let uA="";const Ag={};function hA(t){for(const e in Ag)if(t.startsWith(e)){const n=Ag[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${uA}${t}`),t}function fA(t){return t&&typeof t=="object"&&t.isBuffer}function j0(t){if(fA(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function H0(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function dA(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const pA=t=>typeof t=="boolean",Ms=t=>typeof t=="function",mo=t=>t!==null&&typeof t=="object",Rg=t=>mo(t)&&t.constructor==={}.constructor,gA=t=>!!t&&typeof t[Symbol.iterator]=="function",_A=t=>t&&typeof t[Symbol.asyncIterator]=="function",Nr=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Or=t=>typeof Blob<"u"&&t instanceof Blob,mA=t=>t&&typeof t=="object"&&t.isBuffer,yA=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||mo(t)&&Ms(t.tee)&&Ms(t.cancel)&&Ms(t.getReader),vA=t=>mo(t)&&Ms(t.read)&&Ms(t.pipe)&&pA(t.readable),W0=t=>yA(t)||vA(t);class TA extends Error{constructor(n,r){super(n);d(this,"reason");d(this,"url");d(this,"response");this.reason=r.reason,this.url=r.url,this.response=r.response}}const wA=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,EA=/^([-\w.]+\/[-\w.+]+)/;function bg(t,e){return t.toLowerCase()===e.toLowerCase()}function SA(t){const e=EA.exec(t);return e?e[1]:t}function Cg(t){const e=wA.exec(t);return e?e[1]:""}const $0=/\?.*/;function AA(t){const e=t.match($0);return e&&e[0]}function rd(t){return t.replace($0,"")}function RA(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function nc(t){return Nr(t)?t.url:Or(t)?t.name||"":typeof t=="string"?t:""}function id(t){if(Nr(t)){const e=t,n=e.headers.get("content-type")||"",r=rd(e.url);return SA(n)||Cg(r)}return Or(t)?t.type||"":typeof t=="string"?Cg(t):""}function bA(t){return Nr(t)?t.headers["content-length"]||-1:Or(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function X0(t){if(Nr(t))return t;const e={},n=bA(t);n>=0&&(e["content-length"]=String(n));const r=nc(t),i=id(t);i&&(e["content-type"]=i);const s=await xA(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function CA(t){if(!t.ok)throw await PA(t)}async function PA(t){const e=RA(t.url);let n=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;n=n.length>100?`${n.slice(0,100)}...`:n;const r={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");r.reason=!t.bodyUsed&&(i!=null&&i.includes("application/json"))?await t.json():await t.text()}catch{}return new TA(n,r)}async function xA(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r((o=s==null?void 0:s.target)==null?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5);return`data:base64,${IA(n)}`}return null}function IA(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function MA(t){return!kA(t)&&!NA(t)}function kA(t){return t.startsWith("http:")||t.startsWith("https:")}function NA(t){return t.startsWith("data:")}async function Pg(t,e){var n,r;if(typeof t=="string"){const i=hA(t);return MA(i)&&(n=globalThis.loaders)!=null&&n.fetchNode?(r=globalThis.loaders)==null?void 0:r.fetchNode(i,e):await fetch(i,e)}return await X0(t)}const xg=new _o({id:"loaders.gl"});class OA{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class DA{constructor(){d(this,"console");this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const Y0={fetch:null,mimeType:void 0,nothrow:!1,log:new DA,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:td,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},FA={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function K0(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function q0(){const t=K0();return t.globalOptions=t.globalOptions||{...Y0},t.globalOptions}function UA(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],BA(t,n),VA(e,t,r)}function BA(t,e){Ig(t,null,Y0,FA,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Ig(r,n.id,i,s,e)}}function Ig(t,e,n,r,i){const s=e||"Top level",o=e?`${e}.`:"";for(const a in t){const l=!e&&mo(t[a]),c=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in n)&&!c&&!u){if(a in r)xg.warn(`${s} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!l){const h=LA(a,i);xg.warn(`${s} loader option '${o}${a}' not recognized. ${h}`)()}}}}function LA(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return`Did you mean '${i.id}.${s}'?`;const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${s}'?`)}return r}function VA(t,e,n){const i={...t.options||{}};return zA(i,n),i.log===null&&(i.log=new OA),Mg(i,q0()),Mg(i,e),i}function Mg(t,e){for(const n in e)if(n in e){const r=e[n];Rg(r)&&Rg(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function zA(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function sd(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t==null?void 0:t.extensions)):!1}function od(t){Qa(t,"null loader"),Qa(sd(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t!=null&&t.parseTextSync||t!=null&&t.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Z0=()=>{const t=K0();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function jA(t){const e=Z0();t=Array.isArray(t)?t:[t];for(const n of t){const r=od(n);e.find(i=>r===i)||e.unshift(r)}}function HA(){return Z0()}const WA=/\.([^.]+)$/;async function $A(t,e=[],n,r){if(!Q0(t))return null;let i=kg(t,e,{...n,nothrow:!0},r);if(i)return i;if(Or(t)&&(t=await t.slice(0,10).arrayBuffer(),i=kg(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(J0(t));return i}function kg(t,e=[],n,r){if(!Q0(t))return null;if(e&&!Array.isArray(e))return od(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...HA()),YA(i);const s=XA(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(J0(t));return s}function XA(t,e,n,r){const i=nc(t),s=id(t),o=rd(i)||(r==null?void 0:r.url);let a=null,l="";return n!=null&&n.mimeType&&(a=Gc(e,n==null?void 0:n.mimeType),l=`match forced by supplied MIME type ${n==null?void 0:n.mimeType}`),a=a||KA(e,o),l=l||(a?`matched url ${o}`:""),a=a||Gc(e,s),l=l||(a?`matched MIME type ${s}`:""),a=a||ZA(e,t),l=l||(a?`matched initial data ${G0(t)}`:""),n!=null&&n.fallbackMimeType&&(a=a||Gc(e,n==null?void 0:n.fallbackMimeType),l=l||(a?`matched fallback MIME type ${s}`:"")),l&&H1.log(1,`selectLoader selected ${a==null?void 0:a.name}: ${l}.`),a}function Q0(t){return!(t instanceof Response&&t.status===204)}function J0(t){const e=nc(t),n=id(t);let r="No valid loader found (";r+=e?`${H0(e)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const i=t?G0(t):"";return r+=i?` first bytes: "${i}"`:"first bytes: not available",r+=")",r}function YA(t){for(const e of t)od(e)}function KA(t,e){const n=e&&WA.exec(e),r=n&&n[1];return r?qA(t,r):null}function qA(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function Gc(t,e){var n;for(const r of t)if((n=r.mimeTypes)!=null&&n.some(i=>bg(e,i))||bg(e,`application/x.${r.id}`))return r;return null}function ZA(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(QA(e,n))return n}else if(ArrayBuffer.isView(e)){if(Ng(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Ng(e,0,n))return n;return null}function QA(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function Ng(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>JA(t,e,n,i))}function JA(t,e,n,r){if(r instanceof ArrayBuffer)return oA(r,t,r.byteLength);switch(typeof r){case"function":return r(t);case"string":const i=vh(t,e,r.length);return r===i;default:return!1}}function G0(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?vh(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?vh(t,0,e):""}function vh(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const GA=256*1024;function*eR(t,e){const n=(e==null?void 0:e.chunkSize)||GA;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const tR=256*1024;function*nR(t,e={}){const{chunkSize:n=tR}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const rR=1024*1024;async function*iR(t,e){const n=(e==null?void 0:e.chunkSize)||rR;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function Og(t,e){return td?sR(t,e):oR(t)}async function*sR(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield j0(o)}}catch{n.releaseLock()}}async function*oR(t,e){for await(const n of t)yield j0(n)}function aR(t,e){if(typeof t=="string")return eR(t,e);if(t instanceof ArrayBuffer)return nR(t,e);if(Or(t))return iR(t,e);if(W0(t))return Og(t,e);if(Nr(t))return Og(t.body,e);throw new Error("makeIterator")}const ev="Cannot convert supplied data type";function lR(t,e,n){if(e.text&&typeof t=="string")return t;if(mA(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(ev)}async function cR(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return lR(t,e);if(Or(t)&&(t=await X0(t)),Nr(t)){const i=t;return await CA(i),e.binary?await i.arrayBuffer():await i.text()}if(W0(t)&&(t=aR(t,n)),gA(t)||_A(t))return cA(t);throw new Error(ev)}function tv(t,e){const n=q0(),r=t||n;return typeof r.fetch=="function"?r.fetch:mo(r.fetch)?i=>Pg(i,r.fetch):e!=null&&e.fetch?e==null?void 0:e.fetch:Pg}function uR(t,e,n){if(n)return n;const r={fetch:tv(e,t),...t};if(r.url){const i=rd(r.url);r.baseUrl=i,r.queryString=AA(r.url),r.filename=H0(i),r.baseUrl=dA(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function hR(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:void 0}async function el(t,e,n,r){e&&!Array.isArray(e)&&!sd(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=nc(t),o=hR(e,r),a=await $A(t,o,n);return a?(n=UA(n,a,o,i),r=uR({url:i,_parse:el,loaders:o},n,r||null),await fR(a,t,n,r)):null}async function fR(t,e,n,r){if(nA(t),n=W1(t.options,n),Nr(e)){const s=e,{ok:o,redirected:a,status:l,statusText:c,type:u,url:h}=s,f=Object.fromEntries(s.headers.entries());r.response={headers:f,ok:o,redirected:a,status:l,statusText:c,type:u,url:h}}e=await cR(e,t,n);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,n,r);if(rA(t,n))return await iA(t,e,n,r,el);if(i.parseText&&typeof e=="string")return await i.parseText(e,n,r);if(i.parse)return await i.parse(e,n,r);throw Zn(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}const Dg=100;class dR{constructor(e,n){d(this,"schema");d(this,"options");d(this,"shape");d(this,"length",0);d(this,"rows",null);d(this,"cursor",0);d(this,"_headers",[]);if(this.options=n,this.schema=e,!Array.isArray(e)){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.shape="array-row-table",this.rows=this.rows||new Array(Dg),this.rows[this.length]=e,this.length++}addObjectRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.shape="object-row-table",this.rows=this.rows||new Array(Dg),this.rows[this.length]=e,this.length++}getBatch(){let e=this.rows;return e?(e=e.slice(0,this.length),this.rows=null,{shape:this.shape||"array-row-table",batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}function nv(t,e){if(!t)throw new Error("null row");const n={};if(e)for(let r=0;r<e.length;r++)n[e[r]]=t[r];else for(let r=0;r<t.length;r++){const i=`column-${r}`;n[i]=t[r]}return n}function rv(t,e){if(!t)throw new Error("null row");if(e){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n}return Object.values(t)}function pR(t){const e=[];for(let n=0;n<t.length;n++){const r=`column-${n}`;e.push(r)}return e}function gR(t){return Object.keys(t)}const Fg=100;class _R{constructor(e,n){d(this,"schema");d(this,"options");d(this,"length",0);d(this,"objectRows",null);d(this,"arrayRows",null);d(this,"cursor",0);d(this,"_headers",null);if(this.options=n,this.schema=e,e){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this._headers||(this._headers=pR(e)),this.options.shape){case"object-row-table":const r=nv(e,this._headers);this.addObjectRow(r,n);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(Fg),this.arrayRows[this.length]=e,this.length++;break}}addObjectRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this._headers||(this._headers=gR(e)),this.options.shape){case"array-row-table":const r=rv(e,this._headers);this.addArrayRow(r,n);break;case"object-row-table":this.objectRows=this.objectRows||new Array(Fg),this.objectRows[this.length]=e,this.length++;break}}getBatch(){let e=this.arrayRows||this.objectRows;return e?(e=e.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}const mR=100;class yR{constructor(e,n){d(this,"schema");d(this,"length",0);d(this,"allocated",0);d(this,"columns",{});this.schema=e,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(e){this._reallocateColumns();let n=0;for(const r in this.columns)this.columns[r][this.length]=e[n++];this.length++}addObjectRow(e){this._reallocateColumns();for(const n in e)this.columns[n][this.length]=e[n];this.length++}getBatch(){this._pruneColumns();const e=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const r in this.schema){const i=this.schema[r];e[i.name]=this.columns[i.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:e,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:mR,this.columns={};for(const e in this.schema){const n=this.schema[e],r=n.type||Float32Array,i=this.columns[n.index];if(i&&ArrayBuffer.isView(i)){const s=new r(this.allocated);s.set(i),this.columns[n.index]=s}else i?(i.length=this.allocated,this.columns[n.index]=i):this.columns[n.index]=new r(this.allocated)}}}_pruneColumns(){for(const[e,n]of Object.entries(this.columns))this.columns[e]=n.slice(0,this.length)}}const vR={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},TR="TableBatchBuilder",Fs=class Fs{constructor(e,n){d(this,"schema");d(this,"options");d(this,"aggregator",null);d(this,"batchCount",0);d(this,"bytesUsed",0);d(this,"isChunkComplete",!1);d(this,"lastBatchEmittedMs",Date.now());d(this,"totalLength",0);d(this,"totalBytes",0);d(this,"rowBytes",0);this.schema=e,this.options={...vR,...n}}limitReached(){var e,n;return!!((e=this.options)!=null&&e.limit&&this.totalLength>=this.options.limit||(n=this.options)!=null&&n._limitMB&&this.totalBytes/1e6>=this.options._limitMB)}addRow(e){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(e),this.totalBytes+=this.rowBytes,Array.isArray(e)?this.addArrayRow(e):this.addObjectRow(e))}addArrayRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addArrayRow(e)}addObjectRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addObjectRow(e)}chunkComplete(e){e instanceof ArrayBuffer&&(this.bytesUsed+=e.byteLength),typeof e=="string"&&(this.bytesUsed+=e.length),this.isChunkComplete=!0}getFullBatch(e){return this._isFull()?this._getBatch(e):null}getFinalBatch(e){return this._getBatch(e)}_estimateRowMB(e){return Array.isArray(e)?e.length*8:Object.keys(e).length*8}_isFull(){if(!this.aggregator||this.aggregator.rowCount()===0)return!1;if(this.options.batchSize==="auto"){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs?!1:(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(e){if(!this.aggregator)return null;e!=null&&e.bytesUsed&&(this.bytesUsed=e.bytesUsed);const n=this.aggregator.getBatch();return n.count=this.batchCount,n.bytesUsed=this.bytesUsed,Object.assign(n,e),this.batchCount++,this.aggregator=null,n}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return _R;case"columnar-table":return yR;case"arrow-table":if(!Fs.ArrowBatch)throw new Error(TR);return Fs.ArrowBatch;default:return dR}}};d(Fs,"ArrowBatch");let Th=Fs;class Ug extends Array{enqueue(e){return this.push(e)}dequeue(){return this.shift()}}class wR{constructor(){d(this,"_values");d(this,"_settlers");d(this,"_closed");this._values=new Ug,this._settlers=new Ug,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[Symbol.asyncIterator](){return this}enqueue(e){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const n=this._settlers.dequeue();e instanceof Error?n.reject(e):n.resolve({value:e})}else this._values.enqueue(e)}next(){if(this._values.length>0){const e=this._values.dequeue();return e instanceof Error?Promise.reject(e):Promise.resolve({value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise((e,n)=>{this._settlers.enqueue({resolve:e,reject:n})})}}async function tl(t,e,n,r){let i,s;!Array.isArray(e)&&!sd(e)?(i=[],s=e):(i=e,s=n);const o=tv(s);let a=t;return typeof t=="string"&&(a=await o(t)),Or(t)&&(a=await o(t)),Array.isArray(i)?await el(a,i,s):await el(a,i,s)}const ER="4.3.1";var Em;const SR=(Em=globalThis.loaders)==null?void 0:Em.parseImageNode,wh=typeof Image<"u",Eh=typeof ImageBitmap<"u",AR=!!SR,Sh=td?!0:AR;function RR(t){switch(t){case"auto":return Eh||wh||Sh;case"imagebitmap":return Eh;case"image":return wh;case"data":return Sh;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function bR(){if(Eh)return"imagebitmap";if(wh)return"image";if(Sh)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function CR(t){const e=xR(t);if(!e)throw new Error("Not an image");return e}function PR(t){switch(CR(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function xR(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const IR=/^data:image\/svg\+xml/,MR=/\.svg((\?|#).*)?$/;function ad(t){return t&&(IR.test(t)||MR.test(t))}function kR(t,e){if(ad(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return iv(t,e)}function iv(t,e){if(ad(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function sv(t,e,n){const r=kR(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await NR(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function NR(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>{const o=s instanceof Error?s.message:"error";i(new Error(o))}}catch(s){i(s)}})}const OR={};let Bg=!0;async function DR(t,e,n){let r;ad(n)?r=await sv(t,e,n):r=iv(t,n);const i=e&&e.imagebitmap;return await FR(r,i)}async function FR(t,e=null){if((UR(e)||!Bg)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Bg=!1}return await createImageBitmap(t)}function UR(t){for(const e in t||OR)return!1;return!0}function BR(t){return!jR(t,"ftyp",4)||!(t[8]&96)?null:LR(t)}function LR(t){switch(VR(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function VR(t,e,n){return String.fromCharCode(...t.slice(e,n))}function zR(t){return[...t].map(e=>e.charCodeAt(0))}function jR(t,e,n=0){const r=zR(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Xt=!1,ks=!0;function ov(t){const e=yo(t);return WR(e)||YR(e)||$R(e)||XR(e)||HR(e)}function HR(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=BR(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function WR(t){const e=yo(t);return e.byteLength>=24&&e.getUint32(0,Xt)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Xt),height:e.getUint32(20,Xt)}:null}function $R(t){const e=yo(t);return e.byteLength>=10&&e.getUint32(0,Xt)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,ks),height:e.getUint16(8,ks)}:null}function XR(t){const e=yo(t);return e.byteLength>=14&&e.getUint16(0,Xt)===16973&&e.getUint32(2,ks)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,ks),height:e.getUint32(22,ks)}:null}function YR(t){const e=yo(t);if(!(e.byteLength>=3&&e.getUint16(0,Xt)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=KR();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Xt);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Xt),width:e.getUint16(s+7,Xt)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,Xt)}return null}function KR(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function yo(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function qR(t,e){var i;const{mimeType:n}=ov(t)||{},r=(i=globalThis.loaders)==null?void 0:i.parseImageNode;return Qa(r),await r(t,n)}async function ZR(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=QR(i);let a;switch(o){case"imagebitmap":a=await DR(t,e,s);break;case"image":a=await sv(t,e,s);break;case"data":a=await qR(t);break;default:Qa(!1)}return i==="data"&&(a=PR(a)),a}function QR(t){switch(t){case"auto":case"data":return bR();default:return RR(t),t}}const JR=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],GR=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],eb={image:{type:"auto",decode:!0}},tb={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:ER,mimeTypes:GR,extensions:JR,parse:ZR,tests:[t=>!!ov(new DataView(t))],options:eb},te=new _o({id:"deck"});let Ah={};function nb(t){Ah=t}function Ve(t,e,n,r){te.level>0&&Ah[t]&&Ah[t].call(null,e,n,r)}function rb(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const ib={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:rb,parseTextSync:JSON.parse};function sb(){const t="9.0.35",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(te.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:te,_registerLoggers:nb},jA([ib,[tb,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const ob=sb();function gr(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const eu={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function ab(t){const e={};for(const[n,r]of Object.entries(t))e[n]=cb(r);return e}function lb(t,e,n){const r={};for(const[i,s]of Object.entries(e))t&&i in t&&!s.private?(s.validate&&gr(s.validate(t[i],s),`${n}: invalid ${i}`),r[i]=t[i]):r[i]=s.value;return r}function cb(t){let e=Lg(t);if(e!=="object")return{value:t,...eu[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...eu[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=Lg(t.value),{...t,...eu[e],type:e}):{type:"object",value:null};throw new Error("props")}function Lg(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const ub=`#ifdef MODULE_LOGDEPTH
logdepth_adjustPosition(gl_Position);
#endif
`,hb=`#ifdef MODULE_MATERIAL
gl_FragColor = material_filterColor(gl_FragColor);
#endif
#ifdef MODULE_LIGHTING
gl_FragColor = lighting_filterColor(gl_FragColor);
#endif
#ifdef MODULE_FOG
gl_FragColor = fog_filterColor(gl_FragColor);
#endif
#ifdef MODULE_PICKING
gl_FragColor = picking_filterHighlightColor(gl_FragColor);
gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif
#ifdef MODULE_LOGDEPTH
logdepth_setFragDepth();
#endif
`,fb={vertex:ub,fragment:hb},Vg=/void\s+main\s*\([^)]*\)\s*\{\n?/,zg=/}\n?[^{}]*$/,tu=[],Aa="__LUMA_INJECT_DECLARATIONS__";function db(t){const e={vertex:{},fragment:{}};for(const n in t){let r=t[n];const i=pb(n);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function pb(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function nl(t,e,n,r=!1){const i=e==="vertex";for(const s in n){const o=n[s];o.sort((l,c)=>l.order-c.order),tu.length=o.length;for(let l=0,c=o.length;l<c;++l)tu[l]=o[l].injection;const a=`${tu.join(`
`)}
`;switch(s){case"vs:#decl":i&&(t=t.replace(Aa,a));break;case"vs:#main-start":i&&(t=t.replace(Vg,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(zg,l=>a+l));break;case"fs:#decl":i||(t=t.replace(Aa,a));break;case"fs:#main-start":i||(t=t.replace(Vg,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(zg,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(Aa,""),r&&(t=t.replace(/\}\s*$/,s=>s+fb[e])),t}let gb=1;class _r{constructor(e){d(this,"name");d(this,"vs");d(this,"fs");d(this,"getModuleUniforms");d(this,"dependencies");d(this,"deprecations");d(this,"defines");d(this,"injections");d(this,"uniforms",{});d(this,"uniformTypes",{});const{name:n,vs:r,fs:i,dependencies:s=[],uniformTypes:o={},uniformPropTypes:a={},getUniforms:l,deprecations:c=[],defines:u={},inject:h={}}=e;gr(typeof n=="string"),this.name=n,this.vs=r,this.fs=i,this.getModuleUniforms=l,this.dependencies=_r.instantiateModules(s),this.deprecations=this._parseDeprecationDefinitions(c),this.defines=u,this.injections=db(h),this.uniformTypes=o,a&&(this.uniforms=ab(a))}static instantiateModules(e){return e.map(n=>{if(n instanceof _r)return n;gr(typeof n!="string",`Shader module use by name is deprecated. Import shader module '${JSON.stringify(n)}' and use it directly.`),n.name||(console.warn("shader module has no name"),n.name=`shader-module-${gb++}`);const r=new _r(n);return r.dependencies=_r.instantiateModules(n.dependencies||[]),r})}getModuleSource(e){let n;switch(e){case"vertex":n=this.vs||"";break;case"fragment":n=this.fs||"";break;default:gr(!1)}const r=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------

#define MODULE_${r}
${n}

`}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):lb(e,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{var i;(i=r.regex)!=null&&i.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp(`\\b${n.old}\\(`);break;default:n.regex=new RegExp(`${n.type} ${n.old};`)}}),e}_defaultGetUniforms(e={}){const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&gr(s.validate(e[i],s),`${this.name}: invalid ${i}`),n[i]=e[i]):n[i]=s.value}return n}}function jg(t){if(t.source&&t.platformInfo.type==="webgpu")return{...t,vs:void 0,fs:void 0};if(!t.vs)throw new Error("no vertex shader");const e=Hg(t.platformInfo,t.vs);let n;return t.fs&&(n=Hg(t.platformInfo,t.fs)),{...t,vs:e,fs:n}}function Hg(t,e){if(typeof e=="string")return e;switch(t.type){case"webgpu":if(e!=null&&e.wgsl)return e.wgsl;throw new Error("WebGPU does not support GLSL shaders");default:if(e!=null&&e.glsl)return e.glsl;throw new Error("WebGL does not support WGSL shaders")}}function rc(t){const e=_r.instantiateModules(t);return _b(e)}function _b(t){const e={},n={};return av({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function av(t){const{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&av({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function mb(t){switch(t==null?void 0:t.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function yb(t,e){var r;if(Number(((r=t.match(/^#version[ \t]+(\d+)/m))==null?void 0:r[1])||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=Wg(t,vb),t;case"fragment":return t=Wg(t,Tb),t;default:throw new Error(e)}}const lv=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],vb=[...lv,[Rh("attribute"),"in $1"],[Rh("varying"),"out $1"]],Tb=[...lv,[Rh("varying"),"in $1"]];function Wg(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function Rh(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function cv(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {
`,i.header&&(n+=`  ${i.header}`),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+=`  ${o.injection}
`}i.footer&&(n+=`  ${i.footer}`),n+=`}
`}return n}function uv(t){const e={vertex:{},fragment:{}};for(const n of t){let r,i;typeof n!="string"?(r=n,i=r.hook):(r={},i=n),i=i.trim();const[s,o]=i.split(":"),a=i.replace(/\(.+/,""),l=Object.assign(r,{signature:o});switch(s){case"vs":e.vertex[a]=l;break;case"fs":e.fragment[a]=l;break;default:throw new Error(s)}}return e}function wb(t,e){return{name:Eb(t,e),language:"glsl",version:Sb(t)}}function Eb(t,e="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return r?r[1]:e}function Sb(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const hv=`

${Aa}
`,Ab=`precision highp float;
`;function Rb(t){const e=rc(t.modules||[]);return{source:bh(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:ld(e)}}function bb(t){const e=rc(t.modules||[]);return{vs:bh(t.platformInfo,{...t,source:t.vs,stage:"vertex",modules:e}),fs:bh(t.platformInfo,{...t,source:t.fs,stage:"fragment",modules:e}),getUniforms:ld(e)}}function Cb(t){const{vs:e,fs:n}=t,r=rc(t.modules||[]);return{vs:$g(t.platformInfo,{...t,source:e,stage:"vertex",modules:r}),fs:$g(t.platformInfo,{...t,source:n,stage:"fragment",modules:r}),getUniforms:ld(r)}}function bh(t,e){const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=e;gr(typeof n=="string","shader source must be a string");const l=n;let c="";const u=uv(s),h={},f={},p={};for(const v in o){const S=typeof o[v]=="string"?{injection:o[v],order:0}:o[v],m=/^(v|f)s:(#)?([\w-]+)$/.exec(v);if(m){const g=m[2],y=m[3];g?y==="decl"?f[v]=[S]:p[v]=[S]:h[v]=[S]}else p[v]=[S]}const T=t.type!=="webgpu"?i:[];for(const v of T){a&&v.checkDeprecations(l,a);const S=v.getModuleSource(r,"wgsl");c+=S;const m=v.injections[r];for(const g in m){const y=/^(v|f)s:#([\w-]+)$/.exec(g);if(y){const P=y[2]==="decl"?f:p;P[g]=P[g]||[],P[g].push(m[g])}else h[g]=h[g]||[],h[g].push(m[g])}}return c+=hv,c=nl(c,r,f),c+=cv(u[r],h),c+=l,c=nl(c,r,p),c}function $g(t,e){const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:l=[],inject:c={},prologue:u=!0,log:h}=e;gr(typeof r=="string","shader source must be a string");const f=s==="glsl"?wb(r).version:-1,p=t.shaderLanguageVersion,T=f===100?"#version 100":"#version 300 es",S=r.split(`
`).slice(1).join(`
`),m={};o.forEach(k=>{Object.assign(m,k.getDefines())}),Object.assign(m,a);let g="";switch(s){case"wgsl":break;case"glsl":g=u?`${T}

// ----- PROLOGUE -------------------------
${Pb({id:n,source:r,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}
${mb(t)}
${i==="fragment"?Ab:""}

// ----- APPLICATION DEFINES -------------------------

${xb(m)}

`:`${T}
`;break}const y=uv(l),R={},P={},I={};for(const k in c){const N=typeof c[k]=="string"?{injection:c[k],order:0}:c[k],F=/^(v|f)s:(#)?([\w-]+)$/.exec(k);if(F){const O=F[2],H=F[3];O?H==="decl"?P[k]=[N]:I[k]=[N]:R[k]=[N]}else I[k]=[N]}for(const k of o){h&&k.checkDeprecations(S,h);const N=k.getModuleSource(i);g+=N;const F=k.injections[i];for(const O in F){const H=/^(v|f)s:#([\w-]+)$/.exec(O);if(H){const q=H[2]==="decl"?P:I;q[O]=q[O]||[],q[O].push(F[O])}else R[O]=R[O]||[],R[O].push(F[O])}}return g+="// ----- MAIN SHADER SOURCE -------------------------",g+=hv,g=nl(g,i,P),g+=cv(y[i],R),g+=S,g=nl(g,i,I),s==="glsl"&&f!==p&&(g=yb(g,i)),g.trim()}function ld(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function Pb(t){const{id:e,source:n,stage:r}=t;return e&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${r}

`:""}function xb(t={}){let e="";for(const n in t){const r=t[n];(r||Number.isFinite(r))&&(e+=`#define ${n.toUpperCase()} ${t[n]}
`)}return e}const ur=class ur{constructor(){d(this,"_hookFunctions",[]);d(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return ur.defaultShaderAssembler=ur.defaultShaderAssembler||new ur,ur.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(n=>n.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n)}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e)}assembleShader(e){const n=this._getModuleList(e.modules),r=this._hookFunctions,i=jg(e);return{...Rb({platformInfo:e.platformInfo,...i,modules:n,hookFunctions:r}),modules:n}}assembleShaderPair(e){const n=jg(e),r=this._getModuleList(e.modules),i=this._hookFunctions,{platformInfo:s}=e;return{...e.platformInfo.shaderLanguage==="wgsl"?bb({platformInfo:s,...n,modules:r,hookFunctions:i}):Cb({platformInfo:s,...n,modules:r,hookFunctions:i}),modules:r}}_getModuleList(e=[]){const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,_r.instantiateModules(n)}};d(ur,"defaultShaderAssembler");let rl=ur;const Ib=`out vec4 transform_output;
void main() {
transform_output = vec4(0);
}`,Mb=`#version 300 es
${Ib}`;function kb(t){const{input:e,inputChannels:n,output:r}={};if(!e)return Mb;if(!n)throw new Error("inputChannels");const i=Nb(n),s=Ob(e,n);return`#version 300 es
in ${i} ${e};
out vec4 ${r};
void main() {
  ${r} = ${s};
}`}function Nb(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function Ob(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}const B=new _o({id:"luma.gl"});class Db{constructor(){d(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new tc({id:e})),this.stats.get(e)}}const cd=new Db;function Fb(){const t="9.0.27",e="set luma.log.level=1 (or higher) to trace rendering";if(globalThis.luma&&globalThis.luma.VERSION!==t)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${t}`);return globalThis.luma||(tr()&&B.log(1,`${t} - ${e}`)(),globalThis.luma=globalThis.luma||{VERSION:t,version:t,log:B,stats:cd}),t}const Ub=Fb();function Bb(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)?t:null}function no(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number"?t:null:Bb(t)}const nu={};function Dr(t="id"){nu[t]=nu[t]||1;const e=nu[t]++;return`${t}-${e}`}function il(t){let e=!0;for(const n in t){e=!1;break}return e}var Ru;let se=(Ru=class{constructor(e,n,r){d(this,"id");d(this,"props");d(this,"userData",{});d(this,"_device");d(this,"destroyed",!1);d(this,"allocatedBytes",0);d(this,"_attachedResources",new Set);if(!e)throw new Error("no device");this._device=e,this.props=Lb(n,r);const i=this.props.id!=="undefined"?this.props.id:Dr(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get(`${n}s Active`).decrementCount()}trackAllocatedMemory(e,n=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${n} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").subtractCount(this.allocatedBytes),n.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${n}s Created`).incrementCount(),e.get(`${n}s Active`).incrementCount()}},d(Ru,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),Ru);function Lb(t,e){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}const ke=class ke extends se{constructor(n,r){const i={...r};(r.usage||0)&ke.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16"));super(n,i,ke.defaultProps);d(this,"usage");d(this,"indexType");d(this,"updateTimestamp");d(this,"debugData",new ArrayBuffer(0));this.usage=r.usage||0,this.indexType=i.indexType,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}readSyncWebGL(n,r){throw new Error("not implemented")}_setDebugData(n,r,i){const s=ArrayBuffer.isView(n)?n.buffer:n,o=Math.min(n?n.byteLength:i,ke.DEBUG_DATA_MAX_LENGTH);n===null?this.debugData=new ArrayBuffer(o):r===0&&i===n.byteLength?this.debugData=s.slice(0,o):this.debugData=s.slice(r,r+o)}};d(ke,"defaultProps",{...se.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),d(ke,"MAP_READ",1),d(ke,"MAP_WRITE",2),d(ke,"COPY_SRC",4),d(ke,"COPY_DST",8),d(ke,"INDEX",16),d(ke,"VERTEX",32),d(ke,"UNIFORM",64),d(ke,"STORAGE",128),d(ke,"INDIRECT",256),d(ke,"QUERY_RESOLVE",512),d(ke,"DEBUG_DATA_MAX_LENGTH",32);let ge=ke;function fv(t){const e=Xg[t],n=Vb(e),r=t.includes("norm"),i=!r&&!t.startsWith("float"),s=t.startsWith("s");return{dataType:Xg[t],byteLength:n,integer:i,signed:s,normalized:r}}function Vb(t){return zb[t]}const Xg={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},zb={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},jb=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],Hb=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function Wb(t){return jb.some(e=>t.startsWith(e))}function dv(t){const e=Hb.exec(t);if(e){const[,n,r,i,s,o]=e;if(n){const a=`${i}${r}`,l=fv(a);return{format:n,components:n.length,srgb:s==="-srgb",unsized:o==="-unsized",webgl:o==="-webgl",...l}}}return Xb(t)}const $b={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};function Xb(t){var n;const e=$b[t];if(!e)throw new Error(`Unknown format ${t}`);return{format:e.format||"",components:e.components||((n=e.format)==null?void 0:n.length)||1,byteLength:e.bpp||1,srgb:!1,unsized:!1}}class Yb{}class Kb{constructor(e=[],n){d(this,"features");d(this,"disabledFeatures");this.features=new Set(e),this.disabledFeatures=n||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures[e]&&this.features.has(e)}}const Us=class Us{constructor(e){d(this,"id");d(this,"props");d(this,"userData",{});d(this,"statsManager",cd);d(this,"_lumaData",{});d(this,"timestamp",0);this.props={...Us.defaultProps,...e},this.id=this.props.id||Dr(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}isTextureFormatCompressed(e){return Wb(e)}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(e){return(e instanceof Promise||typeof e=="string")&&(e={data:e}),this._createTexture(e)}createCommandEncoder(e={}){throw new Error("not implemented")}readPixelsToArrayWebGL(e,n){throw new Error("not implemented")}readPixelsToBufferWebGL(e,n){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,n){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}_getBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const n={...e};return(e.usage||0)&ge.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?n.indexType="uint32":e.data instanceof Uint16Array?n.indexType="uint16":B.warn("indices buffer content must be of integer type")()),n}};d(Us,"defaultProps",{id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:!!B.get("debug"),spector:!!(B.get("spector")||B.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:e=>B.error(e.message)}),d(Us,"VERSION",Ub);let ki=Us;function le(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const as=new Map,di=class di{static registerDevices(e){for(const n of e)le(n.type&&n.isSupported&&n.create),as.set(n.type,n)}static getAvailableDevices(){return Array.from(as).map(e=>e.type)}static getSupportedDevices(){return Array.from(as).filter(e=>e.isSupported()).map(e=>e.type)}static setDefaultDeviceProps(e){Object.assign(ki.defaultProps,e)}static async attachDevice(e){const n=Yg(e.devices)||as;if(e.handle instanceof WebGL2RenderingContext){const r=n.get("webgl");if(r)return await r.attach(e.handle)}if(e.handle===null){const r=n.get("unknown");if(r)return await r.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(e={}){var s,o;e={...di.defaultProps,...e},e.gl&&(e.type="webgl");const n=Yg(e.devices)||as;let r,i;switch(e.type){case"webgpu":if(r=n.get("webgpu"),r)return await r.create(e);break;case"webgl":if(i=n.get("webgl"),i)return await i.create(e);break;case"unknown":const a=n.get("unknown");if(a)return await a.create(e);break;case"best-available":if(r=n.get("webgpu"),(s=r==null?void 0:r.isSupported)!=null&&s.call(r))return await r.create(e);if(i=n.get("webgl"),(o=i==null?void 0:i.isSupported)!=null&&o.call(i))return await i.create(e);break}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(e=!0){const n=HTMLCanvasElement.prototype;if(!e&&n.originalGetContext){n.getContext=n.originalGetContext,n.originalGetContext=void 0;return}n.originalGetContext=n.getContext,n.getContext=function(r,i){return r==="webgl"||r==="experimental-webgl"?this.originalGetContext("webgl2",i):this.originalGetContext(r,i)}}};d(di,"defaultProps",{...ki.defaultProps,type:"best-available",devices:void 0}),d(di,"stats",cd),d(di,"log",B);let Ti=di;function Yg(t){if(!t||(t==null?void 0:t.length)===0)return null;const e=new Map;for(const n of t)e.set(n.type,n);return e}const qb=tr()&&typeof document<"u",ic=()=>qb&&document.readyState==="complete",Zb={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"};class ud{constructor(e){d(this,"id");d(this,"props");d(this,"canvas");d(this,"htmlCanvas");d(this,"offscreenCanvas");d(this,"type");d(this,"width",1);d(this,"height",1);d(this,"resizeObserver");d(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});if(this.props={...Zb,...e},e=this.props,!tr()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=Gb(e.canvas):this.canvas=e.canvas;else{const n=e3(e),r=Jb((e==null?void 0:e.container)||null);r.insertBefore(n,r.firstChild),this.canvas=n,e!=null&&e.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(n=>{for(const r of n)r.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}static get isPageLoaded(){return ic()}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),n=this.canvas;return n.parentElement?[n.clientWidth*e,n.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,n]=this.getPixelSize();return e/n}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),{clientWidth:n}=this._canvasSizeInfo;return n?e/n:1}catch{return 1}}cssToDevicePixels(e,n=!0){const r=this.cssToDeviceRatio(),[i,s]=this.getDrawingBufferSize();return t3(e,r,i,s,n)}setDevicePixelRatio(e,n={}){if(!this.htmlCanvas)return;let r="width"in n?n.width:this.htmlCanvas.clientWidth,i="height"in n?n.height:this.htmlCanvas.clientHeight;(!r||!i)&&(B.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const s=this._canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);this.htmlCanvas.width=a,this.htmlCanvas.height=l;const[c,u]=this.getDrawingBufferSize();(c!==a||u!==l)&&(o=Math.min(c/r,u/i),this.htmlCanvas.width=Math.floor(r*o),this.htmlCanvas.height=Math.floor(i*o),B.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}getDrawingBufferSize(){const e=this.device.gl;if(!e)throw new Error("canvas size");return[e.drawingBufferWidth,e.drawingBufferHeight]}_setAutoCreatedCanvasId(e){var n;((n=this.htmlCanvas)==null?void 0:n.id)==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}d(ud,"pageLoaded",Qb());function Qb(){return ic()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}function Jb(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e&&!ic())throw new Error(`Accessing '${t}' before page was loaded`);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function Gb(t){const e=document.getElementById(t);if(!e&&!ic())throw new Error(`Accessing '${t}' before page was loaded`);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function e3(t){const{width:e,height:n}=t,r=document.createElement("canvas");return r.id="lumagl-auto-created-canvas",r.width=e||1,r.height=n||1,r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",r}function t3(t,e,n,r,i){const s=t,o=Kg(s[0],e,n);let a=qg(s[1],e,r,i),l=Kg(s[0]+1,e,n);const c=l===n-1?l:l-1;l=qg(s[1]+1,e,r,i);let u;return i?(l=l===0?l:l+1,u=a,a=l):u=l===r-1?l:l-1,{x:o,y:a,width:Math.max(c-o+1,1),height:Math.max(u-a+1,1)}}function Kg(t,e,n){return Math.min(Math.round(t*e),n-1)}function qg(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const sn=class sn extends se{constructor(n,r,i=sn.defaultProps){super(n,r,i);d(this,"dimension");d(this,"format");d(this,"width");d(this,"height");d(this,"depth");d(this,"updateTimestamp");this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}};d(sn,"defaultProps",{...se.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0}),d(sn,"COPY_SRC",1),d(sn,"COPY_DST",2),d(sn,"TEXTURE_BINDING",4),d(sn,"STORAGE_BINDING",8),d(sn,"RENDER_ATTACHMENT",16);let gt=sn;const Sl=class Sl extends se{get[Symbol.toStringTag](){return"TextureView"}constructor(e,n){super(e,n,Sl.defaultProps)}};d(Sl,"defaultProps",{...se.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let sl=Sl;function n3(t,e,n){let r="";const i=e.split(/\r?\n/),s=t.slice().sort((o,a)=>o.lineNum-a.lineNum);switch((n==null?void 0:n.showSourceCode)||"no"){case"all":let o=0;for(let a=1;a<=i.length;a++)for(r+=pv(i[a-1],a,n);s.length>o&&s[o].lineNum===a;){const l=s[o++];r+=Zg(l,i,l.lineNum,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const a of t)r+=Zg(a,i,a.lineNum,{inlineSource:(n==null?void 0:n.showSourceCode)!=="no"});return r}}function Zg(t,e,n,r){if(r!=null&&r.inlineSource){const i=r3(e,n),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${i}${s}${t.type.toUpperCase()}: ${t.message}

`}return r!=null&&r.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function r3(t,e,n){let r="";for(let i=e-2;i<=e;i++){const s=t[i-1];s!==void 0&&(r+=pv(s,e,n))}return r}function pv(t,e,n){const r=n!=null&&n.html?s3(t):t;return`${i3(String(e),4)}: ${r}${n!=null&&n.html?"<br/>":`
`}`}function i3(t,e){let n="";for(let r=t.length;r<e;++r)n+=" ";return n+t}function s3(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function gv(t,e){return{name:o3(t,e),language:"glsl",version:a3(t)}}function o3(t,e="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return r?r[1]:e}function a3(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Al=class Al extends se{constructor(n,r){super(n,{id:l3(r),...r},Al.defaultProps);d(this,"stage");d(this,"source");d(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(n=this.props.debug){switch(n){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();this.props.debug==="warnings"&&(r==null?void 0:r.length)===0||this._displayShaderLog(r)}_displayShaderLog(n){var c;if(typeof document>"u"||!(document!=null&&document.createElement))return;const r=gv(this.source).name,i=`${this.stage} ${r}`;let s=n3(n,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${s}
</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a);const l=document.getElementsByClassName("luma-compiler-log-error");(c=l[0])!=null&&c.scrollIntoView&&l[0].scrollIntoView(),a.onclick=()=>{const u=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(u)}}};d(Al,"defaultProps",{...se.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"});let ol=Al;function l3(t){return gv(t.source).name||t.id||Dr(`unnamed ${t.stage}-shader`)}const Rl=class Rl extends se{get[Symbol.toStringTag](){return"Sampler"}constructor(e,n){super(e,n,Rl.defaultProps)}};d(Rl,"defaultProps",{...se.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let al=Rl;const bl=class bl extends se{constructor(n,r={}){super(n,r,bl.defaultProps);d(this,"width");d(this,"height");d(this,"colorAttachments",[]);d(this,"depthStencilAttachment",null);this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}resize(n){let r=!n;if(n){const[i,s]=Array.isArray(n)?n:[n.width,n.height];r=r||s!==this.height||i!==this.width,this.width=i,this.height=s}r&&(B.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(r=>{if(typeof r=="string"){const i=this.createColorTexture(r);return this.attachResource(i),i.view}return r instanceof gt?r.view:r});const n=this.props.depthStencilAttachment;if(n)if(typeof n=="string"){const r=this.createDepthStencilTexture(n);this.attachResource(r),this.depthStencilAttachment=r.view}else n instanceof gt?this.depthStencilAttachment=n.view:this.depthStencilAttachment=n}createColorTexture(n){return this.device.createTexture({id:"color-attachment",usage:gt.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}createDepthStencilTexture(n){return this.device.createTexture({id:"depth-stencil-attachment",usage:gt.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}resizeAttachments(n,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const s=this.device._createTexture({...this.colorAttachments[i].props,width:n,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){const i=this.device._createTexture({...this.depthStencilAttachment.props,width:n,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}}};d(bl,"defaultProps",{...se.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let ll=bl;const Cl=class Cl extends se{constructor(n,r){super(n,r,Cl.defaultProps);d(this,"shaderLayout");d(this,"bufferLayout");d(this,"linkStatus","pending");d(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}setUniformsWebGL(n){throw new Error("Use uniform blocks")}};d(Cl,"defaultProps",{...se.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});let Ni=Cl;const Pl=class Pl extends se{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,n){super(e,n,Pl.defaultProps)}};d(Pl,"defaultProps",{...se.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let Ch=Pl;const xl=class xl extends se{constructor(n,r){super(n,r,xl.defaultProps);d(this,"hash","")}get[Symbol.toStringTag](){return"ComputePipeline"}};d(xl,"defaultProps",{...se.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let cl=xl;const Il=class Il extends se{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,n){super(e,n,Il.defaultProps)}};d(Il,"defaultProps",{...se.defaultProps,measureExecutionTime:void 0});let Ph=Il;const Ml=class Ml extends se{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,n){super(e,n,Ml.defaultProps)}};d(Ml,"defaultProps",{...se.defaultProps});let xh=Ml;function c3(t){const[e,n]=h3[t],r=e==="i32"||e==="u32",i=e!=="u32",s=f3[e]*n,o=u3(e,n);return{dataType:e,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}function u3(t,e){let n;switch(t){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?n:`${n}x${e}`}const h3={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},f3={f32:4,f16:2,i32:4,u32:4};function _v(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[n,r]=t.split("x"),i=n,s=r?parseInt(r):1,o=fv(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return e&&(a.webglOnly=!0),a}function mv(t,e){const n={};for(const r of t.attributes)n[r.name]=p3(t,e,r.name);return n}function d3(t,e,n=16){const r=mv(t,e),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}function p3(t,e,n){const r=g3(t,n),i=_3(e,n);if(!r)return null;const s=c3(r.type),o=(i==null?void 0:i.vertexFormat)||s.defaultVertexFormat,a=_v(o);return{attributeName:(i==null?void 0:i.attributeName)||r.name,bufferName:(i==null?void 0:i.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:(i==null?void 0:i.stepMode)||r.stepMode,byteOffset:(i==null?void 0:i.byteOffset)||0,byteStride:(i==null?void 0:i.byteStride)||0}}function g3(t,e){const n=t.attributes.find(r=>r.name===e);return n||B.warn(`shader layout attribute "${e}" not present in shader`),n||null}function _3(t,e){m3(t);let n=y3(t,e);return n||(n=v3(t,e),n)?n:(B.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function m3(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&B.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function y3(t,e){for(const n of t)if(n.format&&n.name===e)return{attributeName:n.name,bufferName:e,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}function v3(t,e){var n;for(const r of t){let i=r.byteStride;if(typeof r.byteStride!="number")for(const o of r.attributes||[]){const a=_v(o.format);i+=a.byteLength}const s=(n=r.attributes)==null?void 0:n.find(o=>o.attribute===e);if(s)return{attributeName:s.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:s.format,byteOffset:s.byteOffset,byteStride:i}}return null}function T3(t,e){const n={...t,attributes:t.attributes.map(r=>({...r}))};for(const r of(e==null?void 0:e.attributes)||[]){const i=n.attributes.find(s=>s.name===r.name);i?(i.type=r.type||i.type,i.stepMode=r.stepMode||i.stepMode):B.warn(`shader layout attribute ${r.name} not present in shader`)}return n}const kl=class kl extends se{constructor(n,r){super(n,r,kl.defaultProps);d(this,"maxVertexAttributes");d(this,"attributeInfos");d(this,"indexBuffer",null);d(this,"attributes");this.maxVertexAttributes=n.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=d3(r.renderPipeline.shaderLayout,r.renderPipeline.bufferLayout,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(n,r){throw new Error("constant attributes not supported")}};d(kl,"defaultProps",{...se.defaultProps,renderPipeline:null});let Ih=kl;const Nl=class Nl extends se{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,n){super(e,n,Nl.defaultProps)}};d(Nl,"defaultProps",{...se.defaultProps,layout:void 0,buffers:{}});let Mh=Nl;const Ol=class Ol extends se{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,n){super(e,n,Ol.defaultProps)}};d(Ol,"defaultProps",{...se.defaultProps,type:void 0,count:void 0});let kh=Ol;const w3={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function E3(t){const e=w3[t];return le(t),e}function S3(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let Jo;function yv(t){return(!Jo||Jo.byteLength<t)&&(Jo=new ArrayBuffer(t)),Jo}function A3(t,e){const n=yv(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function R3(t){const{target:e,source:n,start:r=0,count:i=1}=t,s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return t.target}const Qg=1024;class b3{constructor(e){d(this,"layout",{});d(this,"byteLength");let n=0;for(const[i,s]of Object.entries(e)){const o=E3(s),{type:a,components:l}=o;n=S3(n,l);const c=n;n+=l,this.layout[i]={type:a,size:l,offset:c}}n+=(4-n%4)%4;const r=n*4;this.byteLength=Math.max(r,Qg)}getData(e){const n=Math.max(this.byteLength,Qg),r=yv(n),i={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[s,o]of Object.entries(e)){const a=this.layout[s];if(!a){B.warn(`Supplied uniform value ${s} not present in uniform block layout`)();continue}const{type:l,size:c,offset:u}=a,h=i[l];if(c===1){if(typeof o!="number"&&typeof o!="boolean"){B.warn(`Supplied value for single component uniform ${s} is not a number: ${o}`)();continue}h[u]=Number(o)}else{const f=no(o);if(!f){B.warn(`Supplied value for multi component / array uniform ${s} is not a numeric array: ${o}`)();continue}h.set(f,u)}}return new Uint8Array(r)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function C3(t,e,n=16){if(t!==e)return!1;const r=no(t);if(!r)return!1;const i=no(e);if(i&&r.length===i.length){for(let s=0;s<r.length;++s)if(i[s]!==r[s])return!1}return!0}function P3(t){const e=no(t);return e?e.slice():t}class x3{constructor(e){d(this,"name");d(this,"uniforms",{});d(this,"modifiedUniforms",{});d(this,"modified",!0);d(this,"bindingLayout",{});d(this,"needsRedraw","initialized");var n;if(this.name=e==null?void 0:e.name,e!=null&&e.name&&(e!=null&&e.shaderLayout)){const r=(n=e==null?void 0:e.shaderLayout.bindings)==null?void 0:n.find(s=>s.type==="uniform"&&s.name===(e==null?void 0:e.name));if(!r)throw new Error(e==null?void 0:e.name);const i=r;for(const s of i.uniforms||[])this.bindingLayout[s.name]=s}}setUniforms(e){for(const[n,r]of Object.entries(e))this._setUniform(n,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${n}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,n){C3(this.uniforms[e],n)||(this.uniforms[e]=P3(n),this.modifiedUniforms[e]=!0,this.modified=!0)}}class I3{constructor(e){d(this,"uniformBlocks",new Map);d(this,"uniformBufferLayouts",new Map);d(this,"uniformBuffers",new Map);for(const[n,r]of Object.entries(e)){const i=n,s=new b3(r.uniformTypes||{});this.uniformBufferLayouts.set(i,s);const o=new x3({name:n});o.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(i,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[n,r]of Object.entries(e))this.uniformBlocks.get(n).setUniforms(r);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e).byteLength}getUniformBufferData(e){const n=this.uniformBlocks.get(e).getAllUniforms();return this.uniformBufferLayouts.get(e).getData(n)}createUniformBuffer(e,n,r){r&&this.setUniforms(r);const i=this.getUniformBufferByteLength(n),s=e.createBuffer({usage:ge.UNIFORM|ge.COPY_DST,byteLength:i}),o=this.getUniformBufferData(n);return s.write(o),s}getManagedUniformBuffer(e,n){if(!this.uniformBuffers.get(n)){const r=this.getUniformBufferByteLength(n),i=e.createBuffer({usage:ge.UNIFORM|ge.COPY_DST,byteLength:r});this.uniformBuffers.set(n,i)}return this.uniformBuffers.get(n)}updateUniformBuffers(){let e=!1;for(const n of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(n);e||(e=r)}return e&&B.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const n=this.uniformBlocks.get(e),r=this.uniformBuffers.get(e);let i=!1;if(r&&n.needsRedraw){i||(i=n.needsRedraw);const s=this.getUniformBufferData(e);this.uniformBuffers.get(e).write(s);const a=this.uniformBlocks.get(e).getAllUniforms();B.log(4,`Writing to uniform buffer ${String(e)}`,s,a)()}return i}}function vv(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function Tv(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function M3(t,e,n){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let i=vv(t);if(i==="uint8"&&n&&r===1)return"unorm8-webgl";if(i==="uint8"&&n&&r===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}if(i==="uint16"||i==="sint16"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}return r===1?i:`${i}x${r}`}function k3(t){return no(t)!==null||typeof t=="number"||typeof t=="boolean"}function hd(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{const r=t[n];k3(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}function N3(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const c=r[a]?`${t}.${r[a]}`:"N/A";B.removed(`${t}.${a}`,c)()}for(const a in i)if(a in e){const l=i[a];B.deprecated(`${t}.${a}`,`${t}.${l}`)()}let o=null;for(const[a,l]of Object.entries(s))a in e&&(B.deprecated(`${t}.${a}`,`${t}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]);return o||e}let O3="";async function D3(t,e){return await new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error(`Could not load image ${t}.`)),i.crossOrigin=(e==null?void 0:e.crossOrigin)||"anonymous",i.src=t.startsWith("http")?t:O3+t}catch(i){r(i)}})}async function wv(t,e){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",t),new Promise((i,s)=>{r.onload=i,r.onerror=o=>s(new Error(`Unable to load script '${t}': ${o}`)),n.appendChild(r)})}function Nh(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Nh(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Nh(t[s],e[s],n-1))return!1;return!0}return!1}function F3(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function U3(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}class B3{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class yn{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(e){throw new Error("Cannot evaluate node")}evaluateString(e){return this.evaluate(e).toString()}search(e){}searchBlock(e,n){if(e){n(ul.instance);for(const r of e)r instanceof Array?this.searchBlock(r,n):r.search(n);n(hl.instance)}}}class ul extends yn{}ul.instance=new ul;class hl extends yn{}hl.instance=new hl;class de extends yn{constructor(){super()}}class Oh extends de{constructor(e,n,r,i,s,o){super(),this.calls=new Set,this.name=e,this.args=n,this.returnType=r,this.body=i,this.startLine=s,this.endLine=o}get astNodeType(){return"function"}search(e){this.searchBlock(this.body,e)}}class L3 extends de{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class V3 extends de{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class z3 extends de{constructor(e){super(),this.body=e}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class j3 extends de{constructor(e,n,r,i){super(),this.init=e,this.condition=n,this.increment=r,this.body=i}get astNodeType(){return"for"}search(e){var n,r,i;(n=this.init)===null||n===void 0||n.search(e),(r=this.condition)===null||r===void 0||r.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class cr extends de{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"var"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class Ev extends de{constructor(e,n,r){super(),this.name=e,this.type=n,this.value=r}get astNodeType(){return"override"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class Dh extends de{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"let"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class Jg extends de{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"const"}evaluate(e){return this.value.evaluate(e)}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}var Oi;(function(t){t.increment="++",t.decrement="--"})(Oi||(Oi={}));(function(t){function e(n){const r=n;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}t.parse=e})(Oi||(Oi={}));class H3 extends de{constructor(e,n){super(),this.operator=e,this.variable=n}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}var ro;(function(t){t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(ro||(ro={}));(function(t){function e(n){const r=n;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}t.parse=e})(ro||(ro={}));class W3 extends de{constructor(e,n,r){super(),this.operator=e,this.variable=n,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class Sv extends de{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"call"}search(e){for(const n of this.args)n.search(e);e(this)}}class $3 extends de{constructor(e,n){super(),this.body=e,this.continuing=n}get astNodeType(){return"loop"}}class X3 extends de{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"body"}}class Y3 extends de{constructor(e,n,r,i){super(),this.condition=e,this.body=n,this.elseif=r,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class K3 extends de{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class q3 extends de{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class Z3 extends de{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Q3 extends de{constructor(e,n){super(),this.severity=e,this.rule=n}get astNodeType(){return"diagnostic"}}class Av extends de{constructor(e,n){super(),this.name=e,this.type=n}get astNodeType(){return"alias"}}class J3 extends de{constructor(){super()}get astNodeType(){return"discard"}}class G3 extends de{constructor(){super()}get astNodeType(){return"break"}}class eC extends de{constructor(){super()}get astNodeType(){return"continue"}}class Fr extends de{constructor(e){super(),this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class lr extends Fr{constructor(e,n,r,i){super(e),this.members=n,this.startLine=r,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let n=0;n<this.members.length;n++)if(this.members[n].name==e)return n;return-1}}class Rv extends Fr{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"template"}}class tC extends Fr{constructor(e,n,r,i){super(e),this.storage=n,this.type=r,this.access=i}get astNodeType(){return"pointer"}}class bv extends Fr{constructor(e,n,r,i){super(e),this.attributes=n,this.format=r,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class ys extends Fr{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"sampler"}}class Gt extends yn{constructor(){super()}}class nC extends Gt{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class ai extends Gt{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const n of this.args)n.search(e)}evaluate(e){return this.args[0].evaluate(e)}}class Cv extends Gt{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"callExpr"}evaluate(e){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(e));case"acos":return Math.acos(this.args[0].evaluate(e));case"acosh":return Math.acosh(this.args[0].evaluate(e));case"asin":return Math.asin(this.args[0].evaluate(e));case"asinh":return Math.asinh(this.args[0].evaluate(e));case"atan":return Math.atan(this.args[0].evaluate(e));case"atan2":return Math.atan2(this.args[0].evaluate(e),this.args[1].evaluate(e));case"atanh":return Math.atanh(this.args[0].evaluate(e));case"ceil":return Math.ceil(this.args[0].evaluate(e));case"clamp":return Math.min(Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e)),this.args[2].evaluate(e));case"cos":return Math.cos(this.args[0].evaluate(e));case"degrees":return this.args[0].evaluate(e)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(e)-this.args[1].evaluate(e),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(e));case"exp2":return Math.pow(2,this.args[0].evaluate(e));case"floor":return Math.floor(this.args[0].evaluate(e));case"fma":return this.args[0].evaluate(e)*this.args[1].evaluate(e)+this.args[2].evaluate(e);case"fract":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(e));case"log":return Math.log(this.args[0].evaluate(e));case"log2":return Math.log2(this.args[0].evaluate(e));case"max":return Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e));case"min":return Math.min(this.args[0].evaluate(e),this.args[1].evaluate(e));case"mix":return this.args[0].evaluate(e)*(1-this.args[2].evaluate(e))+this.args[1].evaluate(e)*this.args[2].evaluate(e);case"modf":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"pow":return Math.pow(this.args[0].evaluate(e),this.args[1].evaluate(e));case"radians":return this.args[0].evaluate(e)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(e));case"sign":return Math.sign(this.args[0].evaluate(e));case"sin":return Math.sin(this.args[0].evaluate(e));case"sinh":return Math.sinh(this.args[0].evaluate(e));case"saturate":return Math.min(Math.max(this.args[0].evaluate(e),0),1);case"smoothstep":return this.args[0].evaluate(e)*this.args[0].evaluate(e)*(3-2*this.args[0].evaluate(e));case"sqrt":return Math.sqrt(this.args[0].evaluate(e));case"step":return this.args[0].evaluate(e)<this.args[1].evaluate(e)?0:1;case"tan":return Math.tan(this.args[0].evaluate(e));case"tanh":return Math.tanh(this.args[0].evaluate(e));case"trunc":return Math.trunc(this.args[0].evaluate(e));default:throw new Error("Non const function: "+this.name)}}search(e){for(const n of this.args)n.search(e);e(this)}}class Fh extends Gt{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}evaluate(e){const n=e.constants.get(this.name);if(!n)throw new Error("Cannot evaluate node");return n.evaluate(e)}}class Gg extends Gt{constructor(e,n){super(),this.name=e,this.initializer=n}get astNodeType(){return"constExpr"}evaluate(e){var n,r;if(this.initializer instanceof ai){const i=(n=this.postfix)===null||n===void 0?void 0:n.evaluateString(e),s=(r=this.initializer.type)===null||r===void 0?void 0:r.name,o=e.structs.get(s),a=o==null?void 0:o.getMemberIndex(i);return a!==void 0&&a!=-1?this.initializer.args[a].evaluate(e):this.initializer.evaluate(e)}return this.initializer.evaluate(e)}search(e){this.initializer.search(e)}}class e_ extends Gt{constructor(e){super(),this.value=e}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class rC extends Gt{constructor(e,n){super(),this.type=e,this.value=n}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class t_ extends Gt{constructor(e){super(),this.contents=e}get astNodeType(){return"groupExpr"}evaluate(e){return this.contents[0].evaluate(e)}search(e){this.searchBlock(this.contents,e)}}class iC extends Gt{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Pv extends Gt{constructor(){super()}}class sC extends Pv{constructor(e,n){super(),this.operator=e,this.right=n}get astNodeType(){return"unaryOp"}evaluate(e){switch(this.operator){case"+":return this.right.evaluate(e);case"-":return-this.right.evaluate(e);case"!":return this.right.evaluate(e)?0:1;case"~":return~this.right.evaluate(e);default:throw new Error("Unknown unary operator: "+this.operator)}}search(e){this.right.search(e)}}class Lt extends Pv{constructor(e,n,r){super(),this.operator=e,this.left=n,this.right=r}get astNodeType(){return"binaryOp"}evaluate(e){switch(this.operator){case"+":return this.left.evaluate(e)+this.right.evaluate(e);case"-":return this.left.evaluate(e)-this.right.evaluate(e);case"*":return this.left.evaluate(e)*this.right.evaluate(e);case"/":return this.left.evaluate(e)/this.right.evaluate(e);case"%":return this.left.evaluate(e)%this.right.evaluate(e);case"==":return this.left.evaluate(e)==this.right.evaluate(e)?1:0;case"!=":return this.left.evaluate(e)!=this.right.evaluate(e)?1:0;case"<":return this.left.evaluate(e)<this.right.evaluate(e)?1:0;case">":return this.left.evaluate(e)>this.right.evaluate(e)?1:0;case"<=":return this.left.evaluate(e)<=this.right.evaluate(e)?1:0;case">=":return this.left.evaluate(e)>=this.right.evaluate(e)?1:0;case"&&":return this.left.evaluate(e)&&this.right.evaluate(e)?1:0;case"||":return this.left.evaluate(e)||this.right.evaluate(e)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(e){this.left.search(e),this.right.search(e)}}class xv extends yn{constructor(){super()}}class oC extends xv{constructor(e,n){super(),this.selector=e,this.body=n}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class aC extends xv{constructor(e){super(),this.body=e}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class lC extends yn{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"argument"}}class cC extends yn{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class uC extends yn{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"member"}}let hC=class extends yn{constructor(e,n){super(),this.name=e,this.value=n}get astNodeType(){return"attribute"}};var x,b;(function(t){t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(b||(b={}));class C{constructor(e,n,r){this.name=e,this.type=n,this.rule=r}toString(){return this.name}}class E{}x=E;E.none=new C("",b.reserved,"");E.eof=new C("EOF",b.token,"");E.reserved={asm:new C("asm",b.reserved,"asm"),bf16:new C("bf16",b.reserved,"bf16"),do:new C("do",b.reserved,"do"),enum:new C("enum",b.reserved,"enum"),f16:new C("f16",b.reserved,"f16"),f64:new C("f64",b.reserved,"f64"),handle:new C("handle",b.reserved,"handle"),i8:new C("i8",b.reserved,"i8"),i16:new C("i16",b.reserved,"i16"),i64:new C("i64",b.reserved,"i64"),mat:new C("mat",b.reserved,"mat"),premerge:new C("premerge",b.reserved,"premerge"),regardless:new C("regardless",b.reserved,"regardless"),typedef:new C("typedef",b.reserved,"typedef"),u8:new C("u8",b.reserved,"u8"),u16:new C("u16",b.reserved,"u16"),u64:new C("u64",b.reserved,"u64"),unless:new C("unless",b.reserved,"unless"),using:new C("using",b.reserved,"using"),vec:new C("vec",b.reserved,"vec"),void:new C("void",b.reserved,"void")};E.keywords={array:new C("array",b.keyword,"array"),atomic:new C("atomic",b.keyword,"atomic"),bool:new C("bool",b.keyword,"bool"),f32:new C("f32",b.keyword,"f32"),i32:new C("i32",b.keyword,"i32"),mat2x2:new C("mat2x2",b.keyword,"mat2x2"),mat2x3:new C("mat2x3",b.keyword,"mat2x3"),mat2x4:new C("mat2x4",b.keyword,"mat2x4"),mat3x2:new C("mat3x2",b.keyword,"mat3x2"),mat3x3:new C("mat3x3",b.keyword,"mat3x3"),mat3x4:new C("mat3x4",b.keyword,"mat3x4"),mat4x2:new C("mat4x2",b.keyword,"mat4x2"),mat4x3:new C("mat4x3",b.keyword,"mat4x3"),mat4x4:new C("mat4x4",b.keyword,"mat4x4"),ptr:new C("ptr",b.keyword,"ptr"),sampler:new C("sampler",b.keyword,"sampler"),sampler_comparison:new C("sampler_comparison",b.keyword,"sampler_comparison"),struct:new C("struct",b.keyword,"struct"),texture_1d:new C("texture_1d",b.keyword,"texture_1d"),texture_2d:new C("texture_2d",b.keyword,"texture_2d"),texture_2d_array:new C("texture_2d_array",b.keyword,"texture_2d_array"),texture_3d:new C("texture_3d",b.keyword,"texture_3d"),texture_cube:new C("texture_cube",b.keyword,"texture_cube"),texture_cube_array:new C("texture_cube_array",b.keyword,"texture_cube_array"),texture_multisampled_2d:new C("texture_multisampled_2d",b.keyword,"texture_multisampled_2d"),texture_storage_1d:new C("texture_storage_1d",b.keyword,"texture_storage_1d"),texture_storage_2d:new C("texture_storage_2d",b.keyword,"texture_storage_2d"),texture_storage_2d_array:new C("texture_storage_2d_array",b.keyword,"texture_storage_2d_array"),texture_storage_3d:new C("texture_storage_3d",b.keyword,"texture_storage_3d"),texture_depth_2d:new C("texture_depth_2d",b.keyword,"texture_depth_2d"),texture_depth_2d_array:new C("texture_depth_2d_array",b.keyword,"texture_depth_2d_array"),texture_depth_cube:new C("texture_depth_cube",b.keyword,"texture_depth_cube"),texture_depth_cube_array:new C("texture_depth_cube_array",b.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new C("texture_depth_multisampled_2d",b.keyword,"texture_depth_multisampled_2d"),texture_external:new C("texture_external",b.keyword,"texture_external"),u32:new C("u32",b.keyword,"u32"),vec2:new C("vec2",b.keyword,"vec2"),vec3:new C("vec3",b.keyword,"vec3"),vec4:new C("vec4",b.keyword,"vec4"),bitcast:new C("bitcast",b.keyword,"bitcast"),block:new C("block",b.keyword,"block"),break:new C("break",b.keyword,"break"),case:new C("case",b.keyword,"case"),continue:new C("continue",b.keyword,"continue"),continuing:new C("continuing",b.keyword,"continuing"),default:new C("default",b.keyword,"default"),diagnostic:new C("diagnostic",b.keyword,"diagnostic"),discard:new C("discard",b.keyword,"discard"),else:new C("else",b.keyword,"else"),enable:new C("enable",b.keyword,"enable"),fallthrough:new C("fallthrough",b.keyword,"fallthrough"),false:new C("false",b.keyword,"false"),fn:new C("fn",b.keyword,"fn"),for:new C("for",b.keyword,"for"),function:new C("function",b.keyword,"function"),if:new C("if",b.keyword,"if"),let:new C("let",b.keyword,"let"),const:new C("const",b.keyword,"const"),loop:new C("loop",b.keyword,"loop"),while:new C("while",b.keyword,"while"),private:new C("private",b.keyword,"private"),read:new C("read",b.keyword,"read"),read_write:new C("read_write",b.keyword,"read_write"),return:new C("return",b.keyword,"return"),requires:new C("requires",b.keyword,"requires"),storage:new C("storage",b.keyword,"storage"),switch:new C("switch",b.keyword,"switch"),true:new C("true",b.keyword,"true"),alias:new C("alias",b.keyword,"alias"),type:new C("type",b.keyword,"type"),uniform:new C("uniform",b.keyword,"uniform"),var:new C("var",b.keyword,"var"),override:new C("override",b.keyword,"override"),workgroup:new C("workgroup",b.keyword,"workgroup"),write:new C("write",b.keyword,"write"),r8unorm:new C("r8unorm",b.keyword,"r8unorm"),r8snorm:new C("r8snorm",b.keyword,"r8snorm"),r8uint:new C("r8uint",b.keyword,"r8uint"),r8sint:new C("r8sint",b.keyword,"r8sint"),r16uint:new C("r16uint",b.keyword,"r16uint"),r16sint:new C("r16sint",b.keyword,"r16sint"),r16float:new C("r16float",b.keyword,"r16float"),rg8unorm:new C("rg8unorm",b.keyword,"rg8unorm"),rg8snorm:new C("rg8snorm",b.keyword,"rg8snorm"),rg8uint:new C("rg8uint",b.keyword,"rg8uint"),rg8sint:new C("rg8sint",b.keyword,"rg8sint"),r32uint:new C("r32uint",b.keyword,"r32uint"),r32sint:new C("r32sint",b.keyword,"r32sint"),r32float:new C("r32float",b.keyword,"r32float"),rg16uint:new C("rg16uint",b.keyword,"rg16uint"),rg16sint:new C("rg16sint",b.keyword,"rg16sint"),rg16float:new C("rg16float",b.keyword,"rg16float"),rgba8unorm:new C("rgba8unorm",b.keyword,"rgba8unorm"),rgba8unorm_srgb:new C("rgba8unorm_srgb",b.keyword,"rgba8unorm_srgb"),rgba8snorm:new C("rgba8snorm",b.keyword,"rgba8snorm"),rgba8uint:new C("rgba8uint",b.keyword,"rgba8uint"),rgba8sint:new C("rgba8sint",b.keyword,"rgba8sint"),bgra8unorm:new C("bgra8unorm",b.keyword,"bgra8unorm"),bgra8unorm_srgb:new C("bgra8unorm_srgb",b.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new C("rgb10a2unorm",b.keyword,"rgb10a2unorm"),rg11b10float:new C("rg11b10float",b.keyword,"rg11b10float"),rg32uint:new C("rg32uint",b.keyword,"rg32uint"),rg32sint:new C("rg32sint",b.keyword,"rg32sint"),rg32float:new C("rg32float",b.keyword,"rg32float"),rgba16uint:new C("rgba16uint",b.keyword,"rgba16uint"),rgba16sint:new C("rgba16sint",b.keyword,"rgba16sint"),rgba16float:new C("rgba16float",b.keyword,"rgba16float"),rgba32uint:new C("rgba32uint",b.keyword,"rgba32uint"),rgba32sint:new C("rgba32sint",b.keyword,"rgba32sint"),rgba32float:new C("rgba32float",b.keyword,"rgba32float"),static_assert:new C("static_assert",b.keyword,"static_assert")};E.tokens={decimal_float_literal:new C("decimal_float_literal",b.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new C("hex_float_literal",b.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new C("int_literal",b.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new C("uint_literal",b.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new C("ident",b.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new C("and",b.token,"&"),and_and:new C("and_and",b.token,"&&"),arrow:new C("arrow ",b.token,"->"),attr:new C("attr",b.token,"@"),forward_slash:new C("forward_slash",b.token,"/"),bang:new C("bang",b.token,"!"),bracket_left:new C("bracket_left",b.token,"["),bracket_right:new C("bracket_right",b.token,"]"),brace_left:new C("brace_left",b.token,"{"),brace_right:new C("brace_right",b.token,"}"),colon:new C("colon",b.token,":"),comma:new C("comma",b.token,","),equal:new C("equal",b.token,"="),equal_equal:new C("equal_equal",b.token,"=="),not_equal:new C("not_equal",b.token,"!="),greater_than:new C("greater_than",b.token,">"),greater_than_equal:new C("greater_than_equal",b.token,">="),shift_right:new C("shift_right",b.token,">>"),less_than:new C("less_than",b.token,"<"),less_than_equal:new C("less_than_equal",b.token,"<="),shift_left:new C("shift_left",b.token,"<<"),modulo:new C("modulo",b.token,"%"),minus:new C("minus",b.token,"-"),minus_minus:new C("minus_minus",b.token,"--"),period:new C("period",b.token,"."),plus:new C("plus",b.token,"+"),plus_plus:new C("plus_plus",b.token,"++"),or:new C("or",b.token,"|"),or_or:new C("or_or",b.token,"||"),paren_left:new C("paren_left",b.token,"("),paren_right:new C("paren_right",b.token,")"),semicolon:new C("semicolon",b.token,";"),star:new C("star",b.token,"*"),tilde:new C("tilde",b.token,"~"),underscore:new C("underscore",b.token,"_"),xor:new C("xor",b.token,"^"),plus_equal:new C("plus_equal",b.token,"+="),minus_equal:new C("minus_equal",b.token,"-="),times_equal:new C("times_equal",b.token,"*="),division_equal:new C("division_equal",b.token,"/="),modulo_equal:new C("modulo_equal",b.token,"%="),and_equal:new C("and_equal",b.token,"&="),or_equal:new C("or_equal",b.token,"|="),xor_equal:new C("xor_equal",b.token,"^="),shift_right_equal:new C("shift_right_equal",b.token,">>="),shift_left_equal:new C("shift_left_equal",b.token,"<<=")};E.simpleTokens={"@":x.tokens.attr,"{":x.tokens.brace_left,"}":x.tokens.brace_right,":":x.tokens.colon,",":x.tokens.comma,"(":x.tokens.paren_left,")":x.tokens.paren_right,";":x.tokens.semicolon};E.literalTokens={"&":x.tokens.and,"&&":x.tokens.and_and,"->":x.tokens.arrow,"/":x.tokens.forward_slash,"!":x.tokens.bang,"[":x.tokens.bracket_left,"]":x.tokens.bracket_right,"=":x.tokens.equal,"==":x.tokens.equal_equal,"!=":x.tokens.not_equal,">":x.tokens.greater_than,">=":x.tokens.greater_than_equal,">>":x.tokens.shift_right,"<":x.tokens.less_than,"<=":x.tokens.less_than_equal,"<<":x.tokens.shift_left,"%":x.tokens.modulo,"-":x.tokens.minus,"--":x.tokens.minus_minus,".":x.tokens.period,"+":x.tokens.plus,"++":x.tokens.plus_plus,"|":x.tokens.or,"||":x.tokens.or_or,"*":x.tokens.star,"~":x.tokens.tilde,_:x.tokens.underscore,"^":x.tokens.xor,"+=":x.tokens.plus_equal,"-=":x.tokens.minus_equal,"*=":x.tokens.times_equal,"/=":x.tokens.division_equal,"%=":x.tokens.modulo_equal,"&=":x.tokens.and_equal,"|=":x.tokens.or_equal,"^=":x.tokens.xor_equal,">>=":x.tokens.shift_right_equal,"<<=":x.tokens.shift_left_equal};E.regexTokens={decimal_float_literal:x.tokens.decimal_float_literal,hex_float_literal:x.tokens.hex_float_literal,int_literal:x.tokens.int_literal,uint_literal:x.tokens.uint_literal,ident:x.tokens.ident};E.storage_class=[x.keywords.function,x.keywords.private,x.keywords.workgroup,x.keywords.uniform,x.keywords.storage];E.access_mode=[x.keywords.read,x.keywords.write,x.keywords.read_write];E.sampler_type=[x.keywords.sampler,x.keywords.sampler_comparison];E.sampled_texture_type=[x.keywords.texture_1d,x.keywords.texture_2d,x.keywords.texture_2d_array,x.keywords.texture_3d,x.keywords.texture_cube,x.keywords.texture_cube_array];E.multisampled_texture_type=[x.keywords.texture_multisampled_2d];E.storage_texture_type=[x.keywords.texture_storage_1d,x.keywords.texture_storage_2d,x.keywords.texture_storage_2d_array,x.keywords.texture_storage_3d];E.depth_texture_type=[x.keywords.texture_depth_2d,x.keywords.texture_depth_2d_array,x.keywords.texture_depth_cube,x.keywords.texture_depth_cube_array,x.keywords.texture_depth_multisampled_2d];E.texture_external_type=[x.keywords.texture_external];E.any_texture_type=[...x.sampled_texture_type,...x.multisampled_texture_type,...x.storage_texture_type,...x.depth_texture_type,...x.texture_external_type];E.texel_format=[x.keywords.r8unorm,x.keywords.r8snorm,x.keywords.r8uint,x.keywords.r8sint,x.keywords.r16uint,x.keywords.r16sint,x.keywords.r16float,x.keywords.rg8unorm,x.keywords.rg8snorm,x.keywords.rg8uint,x.keywords.rg8sint,x.keywords.r32uint,x.keywords.r32sint,x.keywords.r32float,x.keywords.rg16uint,x.keywords.rg16sint,x.keywords.rg16float,x.keywords.rgba8unorm,x.keywords.rgba8unorm_srgb,x.keywords.rgba8snorm,x.keywords.rgba8uint,x.keywords.rgba8sint,x.keywords.bgra8unorm,x.keywords.bgra8unorm_srgb,x.keywords.rgb10a2unorm,x.keywords.rg11b10float,x.keywords.rg32uint,x.keywords.rg32sint,x.keywords.rg32float,x.keywords.rgba16uint,x.keywords.rgba16sint,x.keywords.rgba16float,x.keywords.rgba32uint,x.keywords.rgba32sint,x.keywords.rgba32float];E.const_literal=[x.tokens.int_literal,x.tokens.uint_literal,x.tokens.decimal_float_literal,x.tokens.hex_float_literal,x.keywords.true,x.keywords.false];E.literal_or_ident=[x.tokens.ident,x.tokens.int_literal,x.tokens.uint_literal,x.tokens.decimal_float_literal,x.tokens.hex_float_literal];E.element_count_expression=[x.tokens.int_literal,x.tokens.uint_literal,x.tokens.ident];E.template_types=[x.keywords.vec2,x.keywords.vec3,x.keywords.vec4,x.keywords.mat2x2,x.keywords.mat2x3,x.keywords.mat2x4,x.keywords.mat3x2,x.keywords.mat3x3,x.keywords.mat3x4,x.keywords.mat4x2,x.keywords.mat4x3,x.keywords.mat4x4,x.keywords.atomic,x.keywords.bitcast,...x.any_texture_type];E.attribute_name=[x.tokens.ident,x.keywords.block,x.keywords.diagnostic];E.assignment_operators=[x.tokens.equal,x.tokens.plus_equal,x.tokens.minus_equal,x.tokens.times_equal,x.tokens.division_equal,x.tokens.modulo_equal,x.tokens.and_equal,x.tokens.or_equal,x.tokens.xor_equal,x.tokens.shift_right_equal,x.tokens.shift_left_equal];E.increment_operators=[x.tokens.plus_plus,x.tokens.minus_minus];class n_{constructor(e,n,r){this.type=e,this.lexeme=n,this.line=r}toString(){return this.lexeme}isTemplateType(){return E.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==E.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class fC{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new n_(E.eof,"",this._line)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let o=1;for(;o>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),o--,o==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),o++)}return!0}}const n=E.simpleTokens[e];if(n)return this._addToken(n),!0;let r=E.none;const i=this._isAlpha(e),s=e==="_";if(this._isAlphaNumeric(e)){let o=this._peekAhead();for(;this._isAlphaNumeric(o);)e+=this._advance(),o=this._peekAhead()}if(i){const o=E.keywords[e];if(o)return this._addToken(o),!0}if(i||s)return this._addToken(E.tokens.ident),!0;for(;;){let o=this._findType(e);const a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(E.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(E.tokens.minus_minus),!0;const l=this._tokens.length-1;if((E.literal_or_ident.indexOf(this._tokens[l].type)!=-1||this._tokens[l].type==E.tokens.paren_right)&&a!=">")return this._addToken(o),!0}if(e==">"&&(a==">"||a=="=")){let l=!1,c=this._tokens.length-1;for(let u=0;u<5&&c>=0&&E.assignment_operators.indexOf(this._tokens[c].type)===-1;++u,--c)if(this._tokens[c].type===E.tokens.less_than){c>0&&this._tokens[c-1].isArrayOrTemplateType()&&(l=!0);break}if(l)return this._addToken(o),!0}if(o===E.none){let l=e,c=0;const u=2;for(let h=0;h<u;++h)if(l+=this._peekAhead(h),o=this._findType(l),o!==E.none){c=h;break}if(o===E.none)return r===E.none?!1:(this._current--,this._addToken(r),!0);e=l,this._current+=c+1}if(r=o,this._isAtEnd())break;e+=this._advance()}return r===E.none?!1:(this._addToken(r),!0)}_findType(e){for(const r in E.regexTokens){const i=E.regexTokens[r];if(this._match(e,i.rule))return i}const n=E.literalTokens[e];return n||E.none}_match(e,n){const r=n.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}_isAlphaNumeric(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e=="_"||e>="0"&&e<="9"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let n=this._source[this._current];return e=e||0,e++,this._current+=e,n}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const n=this._source.substring(this._start,this._current);this._tokens.push(new n_(e,n,this._line))}}class dC{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new B3,this._deferArrayCountEval=[]}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const n=[];for(;!this._isAtEnd();){const r=this._global_decl_or_directive();if(!r)break;n.push(r)}if(this._deferArrayCountEval.length>0){for(const r of this._deferArrayCountEval){const i=r.arrayType,s=r.countNode;if(s instanceof Fh){const a=s.name,l=this._context.constants.get(a);if(l)try{const c=l.evaluate(this._context);i.count=c}catch{}}}this._deferArrayCountEval.length=0}return n}_initialize(e){if(e)if(typeof e=="string"){const n=new fC(e);this._tokens=n.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_error(e,n){return{token:e,message:n,toString:function(){return`${n}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==E.eof}_match(e){if(e instanceof C)return this._check(e)?(this._advance(),!0):!1;for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this._check(i))return this._advance(),!0}return!1}_consume(e,n){if(this._check(e))return this._advance();throw this._error(this._peek(),n)}_check(e){if(this._isAtEnd())return!1;const n=this._peek();if(e instanceof Array){const r=n.type;return e.indexOf(r)!=-1}return n.type==e}_advance(){var e,n;return this._currentLine=(n=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&n!==void 0?n:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._match(E.keywords.alias)){const n=this._type_alias();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.diagnostic)){const n=this._diagnostic();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.requires)){const n=this._requires_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.enable)){const n=this._enable_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),n}const e=this._attribute();if(this._check(E.keywords.var)){const n=this._global_variable_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.override)){const n=this._override_variable_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.let)){const n=this._global_let_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.const)){const n=this._global_const_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.struct)){const n=this._struct_decl();return n!=null&&(n.attributes=e),n}if(this._check(E.keywords.fn)){const n=this._function_decl();return n!=null&&(n.attributes=e),n}return null}_function_decl(){if(!this._match(E.keywords.fn))return null;const e=this._currentLine,n=this._consume(E.tokens.ident,"Expected function name.").toString();this._consume(E.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(E.tokens.paren_right))do{if(this._check(E.tokens.paren_right))break;const a=this._attribute(),l=this._consume(E.tokens.ident,"Expected argument name.").toString();this._consume(E.tokens.colon,"Expected ':' for argument type.");const c=this._attribute(),u=this._type_decl();u!=null&&(u.attributes=c,r.push(new lC(l,u,a)))}while(this._match(E.tokens.comma));this._consume(E.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(E.tokens.arrow)){const a=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=a)}const s=this._compound_statement(),o=this._currentLine;return new Oh(n,r,i,s,e,o)}_compound_statement(){const e=[];for(this._consume(E.tokens.brace_left,"Expected '{' for block.");!this._check(E.tokens.brace_right);){const n=this._statement();n!==null&&e.push(n)}return this._consume(E.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._check(E.tokens.attr)&&this._attribute(),this._check(E.keywords.if))return this._if_statement();if(this._check(E.keywords.switch))return this._switch_statement();if(this._check(E.keywords.loop))return this._loop_statement();if(this._check(E.keywords.for))return this._for_statement();if(this._check(E.keywords.while))return this._while_statement();if(this._check(E.keywords.continuing))return this._continuing_statement();if(this._check(E.keywords.static_assert))return this._static_assert_statement();if(this._check(E.tokens.brace_left))return this._compound_statement();let e=null;return this._check(E.keywords.return)?e=this._return_statement():this._check([E.keywords.var,E.keywords.let,E.keywords.const])?e=this._variable_statement():this._match(E.keywords.discard)?e=new J3:this._match(E.keywords.break)?e=new G3:this._match(E.keywords.continue)?e=new eC:e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),e!=null&&this._consume(E.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(E.keywords.static_assert))return null;const e=this._optional_paren_expression();return new L3(e)}_while_statement(){if(!this._match(E.keywords.while))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute();const n=this._compound_statement();return new V3(e,n)}_continuing_statement(){if(!this._match(E.keywords.continuing))return null;const e=this._compound_statement();return new z3(e)}_for_statement(){if(!this._match(E.keywords.for))return null;this._consume(E.tokens.paren_left,"Expected '('.");const e=this._check(E.tokens.semicolon)?null:this._for_init();this._consume(E.tokens.semicolon,"Expected ';'.");const n=this._check(E.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(E.tokens.semicolon,"Expected ';'.");const r=this._check(E.tokens.paren_right)?null:this._for_increment();this._consume(E.tokens.paren_right,"Expected ')'."),this._check(E.tokens.attr)&&this._attribute();const i=this._compound_statement();return new j3(e,n,r,i)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(E.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let n=null;return this._match(E.tokens.equal)&&(n=this._short_circuit_or_expression()),new cr(e.name,e.type,e.storage,e.access,n)}if(this._match(E.keywords.let)){const e=this._consume(E.tokens.ident,"Expected name for let.").toString();let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(E.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return new Dh(e,n,null,null,r)}if(this._match(E.keywords.const)){const e=this._consume(E.tokens.ident,"Expected name for const.").toString();let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(E.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return new Jg(e,n,null,null,r)}return null}_increment_decrement_statement(){const e=this._current,n=this._unary_expression();if(n==null)return null;if(!this._check(E.increment_operators))return this._current=e,null;const r=this._consume(E.increment_operators,"Expected increment operator");return new H3(r.type===E.tokens.plus_plus?Oi.increment:Oi.decrement,n)}_assignment_statement(){let e=null;if(this._check(E.tokens.brace_right))return null;let n=this._match(E.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const r=this._consume(E.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return new W3(ro.parse(r.lexeme),e,i)}_func_call_statement(){if(!this._check(E.tokens.ident))return null;const e=this._current,n=this._consume(E.tokens.ident,"Expected function name."),r=this._argument_expression_list();return r===null?(this._current=e,null):new Sv(n.lexeme,r)}_loop_statement(){if(!this._match(E.keywords.loop))return null;this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for loop.");const e=[];let n=this._statement();for(;n!==null;){if(Array.isArray(n))for(let i of n)e.push(i);else e.push(n);n=this._statement()}let r=null;return this._match(E.keywords.continuing)&&(r=this._compound_statement()),this._consume(E.tokens.brace_right,"Expected '}' for loop."),new $3(e,r)}_switch_statement(){if(!this._match(E.keywords.switch))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for switch.");const n=this._switch_body();if(n==null||n.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(E.tokens.brace_right,"Expected '}' for switch."),new X3(e,n)}_switch_body(){const e=[];if(this._match(E.keywords.case)){const n=this._case_selectors();this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch case."),e.push(new oC(n,r))}if(this._match(E.keywords.default)){this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch default."),e.push(new aC(n))}if(this._check([E.keywords.default,E.keywords.case])){const n=this._switch_body();e.push(n[0])}return e}_case_selectors(){const e=[this._shift_expression()];for(;this._match(E.tokens.comma);)e.push(this._shift_expression());return e}_case_body(){if(this._match(E.keywords.fallthrough))return this._consume(E.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const n=this._case_body();return n.length==0?e:[...e,n[0]]}_if_statement(){if(!this._match(E.keywords.if))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute();const n=this._compound_statement();let r=[];this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let i=null;return this._match(E.keywords.else)&&(this._check(E.tokens.attr)&&this._attribute(),i=this._compound_statement()),new Y3(e,n,r,i)}_match_elseif(){return this._tokens[this._current].type===E.keywords.else&&this._tokens[this._current+1].type===E.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(e=[]){const n=this._optional_paren_expression(),r=this._compound_statement();return e.push(new cC(n,r)),this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(E.keywords.return))return null;const e=this._short_circuit_or_expression();return new K3(e)}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(E.tokens.or_or);)e=new Lt(this._previous().toString(),e,this._short_circuit_and_expr());return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(E.tokens.and_and);)e=new Lt(this._previous().toString(),e,this._inclusive_or_expression());return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(E.tokens.or);)e=new Lt(this._previous().toString(),e,this._exclusive_or_expression());return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(E.tokens.xor);)e=new Lt(this._previous().toString(),e,this._and_expression());return e}_and_expression(){let e=this._equality_expression();for(;this._match(E.tokens.and);)e=new Lt(this._previous().toString(),e,this._equality_expression());return e}_equality_expression(){const e=this._relational_expression();return this._match([E.tokens.equal_equal,E.tokens.not_equal])?new Lt(this._previous().toString(),e,this._relational_expression()):e}_relational_expression(){let e=this._shift_expression();for(;this._match([E.tokens.less_than,E.tokens.greater_than,E.tokens.less_than_equal,E.tokens.greater_than_equal]);)e=new Lt(this._previous().toString(),e,this._shift_expression());return e}_shift_expression(){let e=this._additive_expression();for(;this._match([E.tokens.shift_left,E.tokens.shift_right]);)e=new Lt(this._previous().toString(),e,this._additive_expression());return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([E.tokens.plus,E.tokens.minus]);)e=new Lt(this._previous().toString(),e,this._multiplicative_expression());return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([E.tokens.star,E.tokens.forward_slash,E.tokens.modulo]);)e=new Lt(this._previous().toString(),e,this._unary_expression());return e}_unary_expression(){return this._match([E.tokens.minus,E.tokens.bang,E.tokens.tilde,E.tokens.star,E.tokens.and])?new sC(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),n=this._postfix_expression();return n&&(e.postfix=n),e}_postfix_expression(){if(this._match(E.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(E.tokens.bracket_right,"Expected ']'.");const n=new iC(e),r=this._postfix_expression();return r&&(n.postfix=r),n}if(this._match(E.tokens.period)){const e=this._consume(E.tokens.ident,"Expected member name."),n=this._postfix_expression(),r=new nC(e.lexeme);return n&&(r.postfix=n),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_primary_expression(){if(this._match(E.tokens.ident)){const r=this._previous().toString();if(this._check(E.tokens.paren_left)){const i=this._argument_expression_list(),s=this._getStruct(r);return s!=null?new ai(s,i):new Cv(r,i)}if(this._context.constants.has(r)){const i=this._context.constants.get(r);return new Gg(r,i.value)}return new Fh(r)}if(this._match(E.const_literal))return new e_(parseFloat(this._previous().toString()));if(this._check(E.tokens.paren_left))return this._paren_expression();if(this._match(E.keywords.bitcast)){this._consume(E.tokens.less_than,"Expected '<'.");const r=this._type_decl();this._consume(E.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return new rC(r,i)}const e=this._type_decl(),n=this._argument_expression_list();return new ai(e,n)}_argument_expression_list(){if(!this._match(E.tokens.paren_left))return null;const e=[];do{if(this._check(E.tokens.paren_right))break;const n=this._short_circuit_or_expression();e.push(n)}while(this._match(E.tokens.comma));return this._consume(E.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(E.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(E.tokens.paren_right),new t_([e])}_paren_expression(){this._consume(E.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(E.tokens.paren_right,"Expected ')'."),new t_([e])}_struct_decl(){if(!this._match(E.keywords.struct))return null;const e=this._currentLine,n=this._consume(E.tokens.ident,"Expected name for struct.").toString();this._consume(E.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(E.tokens.brace_right);){const o=this._attribute(),a=this._consume(E.tokens.ident,"Expected variable name.").toString();this._consume(E.tokens.colon,"Expected ':' for struct member type.");const l=this._attribute(),c=this._type_decl();c!=null&&(c.attributes=l),this._check(E.tokens.brace_right)?this._match(E.tokens.comma):this._consume(E.tokens.comma,"Expected ',' for struct member."),r.push(new uC(a,c,o))}this._consume(E.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,s=new lr(n,r,e,i);return this._context.structs.set(n,s),s}_global_variable_decl(){const e=this._variable_decl();return e&&this._match(E.tokens.equal)&&(e.value=this._const_expression()),e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(E.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){if(!this._match(E.keywords.const))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const s=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=s)}let r=null;if(this._match(E.tokens.equal)){const s=this._short_circuit_or_expression();if(s instanceof ai)r=s;else if(s instanceof Gg&&s.initializer instanceof ai)r=s.initializer;else try{const o=s.evaluate(this._context);r=new e_(o)}catch{r=s}}const i=new Jg(e.toString(),n,"","",r);return this._context.constants.set(i.name,i),i}_global_let_decl(){if(!this._match(E.keywords.let))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}let r=null;return this._match(E.tokens.equal)&&(r=this._const_expression()),new Dh(e.toString(),n,"","",r)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(E.keywords.var))return null;let e="",n="";this._match(E.tokens.less_than)&&(e=this._consume(E.storage_class,"Expected storage_class.").toString(),this._match(E.tokens.comma)&&(n=this._consume(E.access_mode,"Expected access_mode.").toString()),this._consume(E.tokens.greater_than,"Expected '>'."));const r=this._consume(E.tokens.ident,"Expected variable name");let i=null;if(this._match(E.tokens.colon)){const s=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=s)}return new cr(r.toString(),i,e,n,null)}_override_decl(){if(!this._match(E.keywords.override))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const r=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=r)}return new Ev(e.toString(),n,null)}_diagnostic(){this._consume(E.tokens.paren_left,"Expected '('");const e=this._consume(E.tokens.ident,"Expected severity control name.");this._consume(E.tokens.comma,"Expected ','");const n=this._consume(E.tokens.ident,"Expected diagnostic rule name.");return this._consume(E.tokens.paren_right,"Expected ')'"),new Q3(e.toString(),n.toString())}_enable_directive(){const e=this._consume(E.tokens.ident,"identity expected.");return new q3(e.toString())}_requires_directive(){const e=[this._consume(E.tokens.ident,"identity expected.").toString()];for(;this._match(E.tokens.comma);){const n=this._consume(E.tokens.ident,"identity expected.");e.push(n.toString())}return new Z3(e)}_type_alias(){const e=this._consume(E.tokens.ident,"identity expected.");this._consume(E.tokens.equal,"Expected '=' for type alias.");let n=this._type_decl();if(n===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);const r=new Av(e.toString(),n);return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([E.tokens.ident,...E.texel_format,E.keywords.bool,E.keywords.f32,E.keywords.i32,E.keywords.u32])){const r=this._advance(),i=r.toString();return this._context.structs.has(i)?this._context.structs.get(i):this._context.aliases.has(i)?this._context.aliases.get(i).type:new Fr(r.toString())}let e=this._texture_sampler_types();if(e)return e;if(this._check(E.template_types)){let r=this._advance().toString(),i=null,s=null;return this._match(E.tokens.less_than)&&(i=this._type_decl(),s=null,this._match(E.tokens.comma)&&(s=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for type.")),new Rv(r,i,s)}if(this._match(E.keywords.ptr)){let r=this._previous().toString();this._consume(E.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(E.storage_class,"Expected storage_class for pointer");this._consume(E.tokens.comma,"Expected ',' for pointer.");const s=this._type_decl();let o=null;return this._match(E.tokens.comma)&&(o=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for pointer."),new tC(r,i.toString(),s,o)}const n=this._attribute();if(this._match(E.keywords.array)){let r=null,i=-1;const s=this._previous();let o=null;if(this._match(E.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let l="";if(this._match(E.tokens.comma)){o=this._shift_expression();try{l=o.evaluate(this._context).toString(),o=null}catch{l="1"}}this._consume(E.tokens.greater_than,"Expected '>' for array."),i=l?parseInt(l):0}const a=new bv(s.toString(),n,r,i);return o&&this._deferArrayCountEval.push({arrayType:a,countNode:o}),a}return null}_texture_sampler_types(){if(this._match(E.sampler_type))return new ys(this._previous().toString(),null,null);if(this._match(E.depth_texture_type))return new ys(this._previous().toString(),null,null);if(this._match(E.sampled_texture_type)||this._match(E.multisampled_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const n=this._type_decl();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),new ys(e.toString(),n,null)}if(this._match(E.storage_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const n=this._consume(E.texel_format,"Invalid texel format.").toString();this._consume(E.tokens.comma,"Expected ',' after texel format.");const r=this._consume(E.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),new ys(e.toString(),n,r)}return null}_attribute(){let e=[];for(;this._match(E.tokens.attr);){const n=this._consume(E.attribute_name,"Expected attribute name"),r=new hC(n.toString(),null);if(this._match(E.tokens.paren_left)){if(r.value=this._consume(E.literal_or_ident,"Expected attribute value").toString(),this._check(E.tokens.comma)){this._advance();do{const i=this._consume(E.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(i)}while(this._match(E.tokens.comma))}this._consume(E.tokens.paren_right,"Expected ')'")}e.push(r)}return e.length==0?null:e}}class wi{constructor(e,n){this.name=e,this.attributes=n,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class r_{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Go extends wi{constructor(e,n){super(e,n),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class ru extends wi{constructor(e,n){super(e,n),this.count=0,this.stride=0}get isArray(){return!0}}class i_ extends wi{constructor(e,n,r,i){super(e,r),this.format=n,this.access=i}get isTemplate(){return!0}}var xn;(function(t){t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(xn||(xn={}));class ea{constructor(e,n,r,i,s,o,a){this.name=e,this.type=n,this.group=r,this.binding=i,this.attributes=s,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class pC{constructor(e,n){this.name=e,this.type=n}}class ta{constructor(e,n){this.align=e,this.size=n}}class gC{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i,this.interpolation=null}}class s_{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i}}class _C{constructor(e,n,r,i){this.name=e,this.type=n,this.attributes=r,this.id=i}}class mC{constructor(e,n){this.name=e,this.type=n}}class yC{constructor(e,n=null){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=n}}class vC{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class TC{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class un{constructor(e){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new vC,this.functions=[],this._types=new Map,this._functions=new Map,e&&this.update(e)}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}update(e){const r=new dC().parse(e);for(const i of r)i instanceof Oh&&this._functions.set(i.name,new TC(i));for(const i of r)if(i instanceof lr){const s=this._getTypeInfo(i,null);s instanceof Go&&this.structs.push(s)}for(const i of r){if(i instanceof Av){this.aliases.push(this._getAliasInfo(i));continue}if(i instanceof Ev){const s=i,o=this._getAttributeNum(s.attributes,"id",0),a=s.type!=null?this._getTypeInfo(s.type,s.attributes):null;this.overrides.push(new _C(s.name,a,s.attributes,o));continue}if(this._isUniformVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=new ea(s.name,l,o,a,s.attributes,xn.Uniform,s.access);this.uniforms.push(c);continue}if(this._isStorageVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=this._isStorageTexture(l),u=new ea(s.name,l,o,a,s.attributes,c?xn.StorageTexture:xn.Storage,s.access);this.storage.push(u);continue}if(this._isTextureVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=this._isStorageTexture(l),u=new ea(s.name,l,o,a,s.attributes,c?xn.StorageTexture:xn.Texture,s.access);c?this.storage.push(u):this.textures.push(u);continue}if(this._isSamplerVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=new ea(s.name,l,o,a,s.attributes,xn.Sampler,s.access);this.samplers.push(c);continue}if(i instanceof Oh){const s=this._getAttribute(i,"vertex"),o=this._getAttribute(i,"fragment"),a=this._getAttribute(i,"compute"),l=s||o||a,c=new yC(i.name,l==null?void 0:l.name);c.startLine=i.startLine,c.endLine=i.endLine,this.functions.push(c),this._functions.get(i.name).info=c,l?(this._functions.get(i.name).inUse=!0,c.inUse=!0,c.resources=this._findResources(i,!!l),c.inputs=this._getInputs(i.args),c.outputs=this._getOutputs(i.returnType),this.entry[l.name].push(c)):(c.arguments=i.args.map(u=>new mC(u.name,this._getTypeInfo(u.type,u.attributes))),c.returnType=i.returnType?this._getTypeInfo(i.returnType,i.attributes):null);continue}}for(const i of this._functions.values())i.info&&(i.info.inUse=i.inUse,this._addCalls(i.node,i.info.calls));for(const i of this._functions.values())i.node.search(s=>{var o;if(s.astNodeType==="varExpr"){const a=s;for(const l of this.overrides)a.name==l.name&&((o=i.info)===null||o===void 0||o.overrides.push(l))}});for(const i of this.uniforms)this._markStructsInUse(i.type);for(const i of this.storage)this._markStructsInUse(i.type)}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const n of e.members)this._markStructsInUse(n.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const n=this._getAlias(e.name);n&&this._markStructsInUse(n)}}_addCalls(e,n){var r;for(const i of e.calls){const s=(r=this._functions.get(i.name))===null||r===void 0?void 0:r.info;s&&n.add(s)}}findResource(e,n){for(const r of this.uniforms)if(r.group==e&&r.binding==n)return r;for(const r of this.storage)if(r.group==e&&r.binding==n)return r;for(const r of this.textures)if(r.group==e&&r.binding==n)return r;for(const r of this.samplers)if(r.group==e&&r.binding==n)return r;return null}_findResource(e){for(const n of this.uniforms)if(n.name==e)return n;for(const n of this.storage)if(n.name==e)return n;for(const n of this.textures)if(n.name==e)return n;for(const n of this.samplers)if(n.name==e)return n;return null}_markStructsFromAST(e){const n=this._getTypeInfo(e,null);this._markStructsInUse(n)}_findResources(e,n){const r=[],i=this,s=[];return e.search(o=>{if(o instanceof ul)s.push({});else if(o instanceof hl)s.pop();else if(o instanceof cr){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof ai){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type)}else if(o instanceof Dh){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof Fh){const a=o;if(s.length>0&&s[s.length-1][a.name])return;const l=i._findResource(a.name);l&&r.push(l)}else if(o instanceof Cv){const a=o,l=i._functions.get(a.name);l&&(n&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,n)),r.push(...l.resources))}else if(o instanceof Sv){const a=o,l=i._functions.get(a.name);l&&(n&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,n)),r.push(...l.resources))}}),[...new Map(r.map(o=>[o.name,o])).values()]}getBindGroups(){const e=[];function n(r,i){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),i>=e[r].length&&(e[r].length=i+1)}for(const r of this.uniforms){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.storage){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.textures){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.samplers){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}return e}_getOutputs(e,n=void 0){if(n===void 0&&(n=[]),e instanceof lr)this._getStructOutputs(e,n);else{const r=this._getOutputInfo(e);r!==null&&n.push(r)}return n}_getStructOutputs(e,n){for(const r of e.members)if(r.type instanceof lr)this._getStructOutputs(r.type,n);else{const i=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(i!==null){const s=this._getTypeInfo(r.type,r.type.attributes),o=this._parseInt(i.value),a=new s_(r.name,s,i.name,o);n.push(a)}}}_getOutputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getTypeInfo(e,e.attributes),i=this._parseInt(n.value);return new s_("",r,n.name,i)}return null}_getInputs(e,n=void 0){n===void 0&&(n=[]);for(const r of e)if(r.type instanceof lr)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}return n}_getStructInputs(e,n){for(const r of e.members)if(r.type instanceof lr)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}}_getInputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getAttribute(e,"interpolation"),i=this._getTypeInfo(e.type,e.attributes),s=this._parseInt(n.value),o=new gC(e.name,i,n.name,s);return r!==null&&(o.interpolation=this._parseString(r.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const n=parseInt(e);return isNaN(n)?e:n}_getAlias(e){for(const n of this.aliases)if(n.name==e)return n.type;return null}_getAliasInfo(e){return new pC(e.name,this._getTypeInfo(e.type,null))}_getTypeInfo(e,n){if(this._types.has(e))return this._types.get(e);if(e instanceof bv){const i=e,s=i.format?this._getTypeInfo(i.format,i.attributes):null,o=new ru(i.name,n);return o.format=s,o.count=i.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof lr){const i=e,s=new Go(i.name,n);s.startLine=i.startLine,s.endLine=i.endLine;for(const o of i.members){const a=this._getTypeInfo(o.type,o.attributes);s.members.push(new r_(o.name,a,o.attributes))}return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof ys){const i=e,s=i.format instanceof Fr,o=i.format?s?this._getTypeInfo(i.format,null):new wi(i.format,null):null,a=new i_(i.name,o,n,i.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof Rv){const i=e,s=i.format?this._getTypeInfo(i.format,null):null,o=new i_(i.name,s,n,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const r=new wi(e.name,n);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var n,r;const i=this._getTypeSize(e);if(e.size=(n=i==null?void 0:i.size)!==null&&n!==void 0?n:0,e instanceof ru&&e.format){const s=this._getTypeSize(e.format);e.stride=(r=s==null?void 0:s.size)!==null&&r!==void 0?r:0,this._updateTypeInfo(e.format)}e instanceof Go&&this._updateStructInfo(e)}_updateStructInfo(e){var n;let r=0,i=0,s=0,o=0;for(let a=0,l=e.members.length;a<l;++a){const c=e.members[a],u=this._getTypeSize(c);if(!u)continue;(n=this._getAlias(c.type.name))!==null&&n!==void 0||c.type;const h=u.align,f=u.size;r=this._roundUp(h,r+i),i=f,s=r,o=Math.max(o,h),c.offset=r,c.size=f,this._updateTypeInfo(c.type)}e.size=this._roundUp(o,s+i),e.align=o}_getTypeSize(e){var n,r;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),s=this._getAttributeNum(e.attributes,"align",0);if(e instanceof r_&&(e=e.type),e instanceof wi){const o=this._getAlias(e.name);o!==null&&(e=o)}{const o=un._typeInfo[e.name];if(o!==void 0){const a=((n=e.format)===null||n===void 0?void 0:n.name)==="f16"?2:1;return new ta(Math.max(s,o.align/a),Math.max(i,o.size/a))}}{const o=un._typeInfo[e.name.substring(0,e.name.length-1)];if(o){const a=e.name[e.name.length-1]==="h"?2:1;return new ta(Math.max(s,o.align/a),Math.max(i,o.size/a))}}if(e instanceof ru){let o=e,a=8,l=8;const c=this._getTypeSize(o.format);c!==null&&(l=c.size,a=c.align);const u=o.count,h=this._getAttributeNum((r=e==null?void 0:e.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(a,l));return l=u*h,i&&(l=i),new ta(Math.max(s,a),Math.max(i,l))}if(e instanceof Go){let o=0,a=0,l=0,c=0,u=0;for(const h of e.members){const f=this._getTypeSize(h.type);f!==null&&(o=Math.max(f.align,o),l=this._roundUp(f.align,l+c),c=f.size,u=l)}return a=this._roundUp(o,u+c),new ta(Math.max(s,o),Math.max(i,a))}return null}_isUniformVar(e){return e instanceof cr&&e.storage=="uniform"}_isStorageVar(e){return e instanceof cr&&e.storage=="storage"}_isTextureVar(e){return e instanceof cr&&e.type!==null&&un._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof cr&&e.type!==null&&un._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,n){const r=e;if(!r||!r.attributes)return null;const i=r.attributes;for(let s of i)if(s.name==n)return s;return null}_getAttributeNum(e,n,r){if(e===null)return r;for(let i of e)if(i.name==n){let s=i!==null&&i.value!==null?i.value:r;return s instanceof Array&&(s=s[0]),typeof s=="number"?s:typeof s=="string"?parseInt(s):r}return r}_roundUp(e,n){return Math.ceil(n/e)*e}}un._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};un._textureTypes=E.any_texture_type.map(t=>t.name);un._samplerTypes=E.sampler_type.map(t=>t.name);function wC(t){var s;const e={attributes:[],bindings:[]};let n;try{n=EC(t)}catch(o){return B.error(o.message)(),e}for(const o of n.uniforms){const a=[];for(const l of((s=o.type)==null?void 0:s.members)||[])a.push({name:l.name,type:o_(l.type)});e.bindings.push({type:"uniform",name:o.name,location:o.binding,group:o.group,members:a})}const r=n.entry.vertex[0],i=(r==null?void 0:r.inputs.length)||0;for(let o=0;o<i;o++){const a=r.inputs[o];if(a.locationType==="location"){const l=o_(a.type);e.attributes.push({name:a.name,location:Number(a.location),type:l})}}return e}function o_(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function EC(t){try{return new un(t)}catch(e){if(e instanceof Error)throw e;let n="WGSL parse error";throw typeof e=="object"&&(e!=null&&e.message)&&(n+=`: ${e.message} `),typeof e=="object"&&(e!=null&&e.token)&&(n+=e.token.line||""),new Error(n,{cause:e})}}const SC=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;
const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;
const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;
const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;
float sin_taylor_fp32(float a) {
float r, s, t, x;
if (a == 0.0) {
return 0.0;
}
x = -a * a;
s = a;
r = a;
r = r * x;
t = r * INVERSE_FACTORIAL_3;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_5;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_7;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_9;
s = s + t;
return s;
}
void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
if (a == 0.0) {
sin_t = 0.0;
cos_t = 1.0;
}
sin_t = sin_taylor_fp32(a);
cos_t = sqrt(1.0 - sin_t * sin_t);
}
float tan_taylor_fp32(float a) {
float sin_a;
float cos_a;
if (a == 0.0) {
return 0.0;
}
float z = floor(a / TWO_PI);
float r = a - TWO_PI * z;
float t;
float q = floor(r / PI_2 + 0.5);
int j = int(q);
if (j < -2 || j > 2) {
return 1.0 / 0.0;
}
t = r - PI_2 * q;
q = floor(t / PI_16 + 0.5);
int k = int(q);
int abs_k = int(abs(float(k)));
if (abs_k > 4) {
return 1.0 / 0.0;
} else {
t = t - PI_16 * q;
}
float u = 0.0;
float v = 0.0;
float sin_t, cos_t;
float s, c;
sincos_taylor_fp32(t, sin_t, cos_t);
if (k == 0) {
s = sin_t;
c = cos_t;
} else {
if (abs(float(abs_k) - 1.0) < 0.5) {
u = COS_TABLE_0;
v = SIN_TABLE_0;
} else if (abs(float(abs_k) - 2.0) < 0.5) {
u = COS_TABLE_1;
v = SIN_TABLE_1;
} else if (abs(float(abs_k) - 3.0) < 0.5) {
u = COS_TABLE_2;
v = SIN_TABLE_2;
} else if (abs(float(abs_k) - 4.0) < 0.5) {
u = COS_TABLE_3;
v = SIN_TABLE_3;
}
if (k > 0) {
s = u * sin_t + v * cos_t;
c = u * cos_t - v * sin_t;
} else {
s = u * sin_t - v * cos_t;
c = u * cos_t + v * sin_t;
}
}
if (j == 0) {
sin_a = s;
cos_a = c;
} else if (j == 1) {
sin_a = c;
cos_a = -s;
} else if (j == -1) {
sin_a = -c;
cos_a = s;
} else {
sin_a = -s;
cos_a = -c;
}
return sin_a / cos_a;
}
#endif
float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
return tan_taylor_fp32(a);
#else
return tan(a);
#endif
}
`,AC={name:"fp32",vs:SC},RC=[0,1,1,1],bC=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
out vec4 picking_vRGBcolor_Avalid;
vec3 picking_normalizeColor(vec3 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
vec4 picking_normalizeColor(vec4 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
bool picking_isColorZero(vec3 color) {
return dot(color, vec3(1.0)) < 0.00001;
}
bool picking_isColorValid(vec3 color) {
return dot(color, vec3(1.0)) > 0.00001;
}
bool isVertexHighlighted(vec3 vertexColor) {
vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
return
bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}
void picking_setPickingColor(vec3 pickingColor) {
pickingColor = picking_normalizeColor(pickingColor);
if (bool(picking.isActive)) {
picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));
if (!bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = pickingColor;
}
} else {
picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
}
}
void picking_setPickingAttribute(float value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.r = value;
}
}
void picking_setPickingAttribute(vec2 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rg = value;
}
}
void picking_setPickingAttribute(vec3 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = value;
}
}
`,CC=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
if (picking.isActive > 0.5) {
return color;
}
bool selected = bool(picking_vRGBcolor_Avalid.a);
if (selected) {
float highLightAlpha = picking.highlightColor.a;
float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
float highLightRatio = highLightAlpha / blendedAlpha;
vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
return vec4(blendedRGB, blendedAlpha);
} else {
return color;
}
}
vec4 picking_filterPickingColor(vec4 color) {
if (bool(picking.isActive)) {
if (picking_vRGBcolor_Avalid.a == 0.0) {
discard;
}
return picking_vRGBcolor_Avalid;
}
return color;
}
vec4 picking_filterColor(vec4 color) {
vec4 highlightColor = picking_filterHighlightColor(color);
return picking_filterPickingColor(highlightColor);
}
`,a_={name:"picking",vs:bC,fs:CC,uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:RC},getUniforms:PC};function PC(t={},e){const n={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const r=t.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=r}if(t.highlightColor){const r=Array.from(t.highlightColor,i=>i/255);Number.isFinite(r[3])||(r[3]=1),n.highlightColor=r}return t.isActive!==void 0&&(n.isActive=!!t.isActive,n.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(n.useFloatColors=!!t.useFloatColors),n}function Iv(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function xC(t){return t-Math.fround(t)}function IC(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=n*4+r;Iv(t[r*4+n],e,i*2)}return e}const MC=`uniform float ONE;
vec2 split(float a) {
const float SPLIT = 4097.0;
float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float a_hi = t * ONE - (t - a);
float a_lo = a * ONE - a_hi;
#else
float a_hi = t - (t - a);
float a_lo = a - a_hi;
#endif
return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
vec2 b = split(a.x);
b.y += a.y;
return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float sum = (a + b) * ONE;
float err = b - (sum - a) * ONE;
#else
float sum = a + b;
float err = b - (sum - a);
#endif
return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
float v = s - a;
float err = (a - (s - v)) + (b - v);
#endif
return vec2(s, err);
}
vec2 twoSub(float a, float b) {
float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
float v = s - a;
float err = (a - (s - v)) - (b + v);
#endif
return vec2(s, err);
}
vec2 twoSqr(float a) {
float prod = a * a;
vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
return vec2(prod, err);
}
vec2 twoProd(float a, float b) {
float prod = a * b;
vec2 a_fp64 = split(a);
vec2 b_fp64 = split(b);
float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
return vec2(prod, err);
}
vec2 sum_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSum(a.x, b.x);
t = twoSum(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 sub_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSub(a.x, b.x);
t = twoSub(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 mul_fp64(vec2 a, vec2 b) {
vec2 prod = twoProd(a.x, b.x);
prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
return prod;
}
vec2 div_fp64(vec2 a, vec2 b) {
float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
vec2 yn = a * xn;
#endif
float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
vec2 prod = twoProd(xn, diff);
return sum_fp64(yn, prod);
}
vec2 sqrt_fp64(vec2 a) {
if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
float x = 1.0 / sqrt(a.x);
float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
vec2 yn_sqr = twoSqr(yn) * ONE;
#else
vec2 yn_sqr = twoSqr(yn);
#endif
float diff = sub_fp64(a, yn_sqr).x;
vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
return sum_fp64(split(yn), prod);
#else
return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,kC={ONE:1};function NC(){return kC}const OC={name:"fp64-arithmetic",vs:MC,getUniforms:NC,fp64ify:Iv,fp64LowPart:xC,fp64ifyMatrix4:IC},DC={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...DC}};const yt=globalThis.mathgl.config;function FC(t,{precision:e=yt.precision}={}){return t=UC(t),`${parseFloat(t.toPrecision(e))}`}function Di(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Dn(t,e,n){return LC(t,r=>Math.max(e,Math.min(n,r)))}function fl(t,e,n){return Di(t)?t.map((r,i)=>fl(r,e[i],n)):n*e+(1-n)*t}function io(t,e,n){const r=yt.EPSILON;try{if(t===e)return!0;if(Di(t)&&Di(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!io(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=yt.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{yt.EPSILON=r}}function UC(t){return Math.round(t/yt.EPSILON)*yt.EPSILON}function BC(t){return t.clone?t.clone():new Array(t.length)}function LC(t,e,n){if(Di(t)){const r=t;n=n||BC(r);for(let i=0;i<n.length&&i<r.length;++i){const s=typeof t=="number"?t:t[i];n[i]=e(s,i,n)}return n}return e(t)}class Mv extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Di(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(yt)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+FC(this[r],e);return`${e.printTypes?this.constructor.name:""}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!io(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i],o=typeof n=="number"?n:n[i];this[i]=s+r*(o-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(yt.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function VC(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function it(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function iu(t,e,n=""){if(yt.debug&&!VC(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function l_(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class zC extends Mv{get x(){return this[0]}set x(e){this[0]=it(e)}get y(){return this[1]}set y(e){this[1]=it(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return it(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return it(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return l_(e>=0&&e<this.ELEMENTS,"index is out of range"),it(this[e])}setComponent(e,n){return l_(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const Ra=1e-6;let Fi=typeof Float32Array<"u"?Float32Array:Array;function jC(){const t=new Fi(2);return Fi!=Float32Array&&(t[0]=0,t[1]=0),t}function c_(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function HC(t,e){return t[0]=-e[0],t[1]=-e[1],t}function kv(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function WC(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){const t=jC();return function(e,n,r,i,s,o){let a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function $C(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function Nv(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function XC(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function YC(){const t=new Fi(3);return Fi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function KC(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function qC(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function ZC(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function QC(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function Ov(t,e,n){const r=e[0],i=e[1],s=e[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function JC(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function GC(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2];let u=i*c-s*l,h=s*a-r*c,f=r*l-i*a,p=i*f-s*h,T=s*u-r*f,v=r*h-i*u;const S=o*2;return u*=S,h*=S,f*=S,p*=2,T*=2,v*=2,t[0]=a+u+p,t[1]=l+h+T,t[2]=c+f+v,t}function eP(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function tP(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function nP(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function rP(t,e){const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),c=l&&ZC(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}const iP=KC;(function(){const t=YC();return function(e,n,r,i,s,o){let a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const su=[0,0,0];let na;class Qt extends zC{static get ZERO(){return na||(na=new Qt(0,0,0),Object.freeze(na)),na}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Di(e)?this.copy(e):(yt.debug&&(it(e),it(n),it(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return yt.debug&&(it(e.x),it(e.y),it(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=it(e)}angle(e){return rP(this,e)}cross(e){return QC(this,this,e),this.check()}rotateX({radians:e,origin:n=su}){return eP(this,this,n,e),this.check()}rotateY({radians:e,origin:n=su}){return tP(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=su}){return nP(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Ov(this,this,e),this.check()}transformAsVector(e){return Nv(this,this,e),this.check()}transformByMatrix3(e){return JC(this,this,e),this.check()}transformByMatrix2(e){return XC(this,this,e),this.check()}transformByQuaternion(e){return GC(this,this,e),this.check()}}class sP extends Mv{toString(){let e="[";if(yt.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=it(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function oP(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function aP(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Uh(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],h=e[9],f=e[10],p=e[11],T=e[12],v=e[13],S=e[14],m=e[15],g=n*a-r*o,y=n*l-i*o,R=n*c-s*o,P=r*l-i*a,I=r*c-s*a,k=i*c-s*l,N=u*v-h*T,F=u*S-f*T,O=u*m-p*T,H=h*S-f*v,W=h*m-p*v,q=f*m-p*S;let K=g*q-y*W+R*H+P*O-I*F+k*N;return K?(K=1/K,t[0]=(a*q-l*W+c*H)*K,t[1]=(i*W-r*q-s*H)*K,t[2]=(v*k-S*I+m*P)*K,t[3]=(f*I-h*k-p*P)*K,t[4]=(l*O-o*q-c*F)*K,t[5]=(n*q-i*O+s*F)*K,t[6]=(S*R-T*k-m*y)*K,t[7]=(u*k-f*R+p*y)*K,t[8]=(o*W-a*O+c*N)*K,t[9]=(r*O-n*W-s*N)*K,t[10]=(T*I-v*R+m*g)*K,t[11]=(h*R-u*I-p*g)*K,t[12]=(a*F-o*H-l*N)*K,t[13]=(n*H-r*F+i*N)*K,t[14]=(v*y-T*P-S*g)*K,t[15]=(u*P-h*y+f*g)*K,t):null}function lP(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],f=t[11],p=t[12],T=t[13],v=t[14],S=t[15],m=e*o-n*s,g=e*a-r*s,y=n*a-r*o,R=c*T-u*p,P=c*v-h*p,I=u*v-h*T,k=e*I-n*P+r*R,N=s*I-o*P+a*R,F=c*y-u*g+h*m,O=p*y-T*g+v*m;return l*k-i*N+S*F-f*O}function wr(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],f=e[9],p=e[10],T=e[11],v=e[12],S=e[13],m=e[14],g=e[15];let y=n[0],R=n[1],P=n[2],I=n[3];return t[0]=y*r+R*a+P*h+I*v,t[1]=y*i+R*l+P*f+I*S,t[2]=y*s+R*c+P*p+I*m,t[3]=y*o+R*u+P*T+I*g,y=n[4],R=n[5],P=n[6],I=n[7],t[4]=y*r+R*a+P*h+I*v,t[5]=y*i+R*l+P*f+I*S,t[6]=y*s+R*c+P*p+I*m,t[7]=y*o+R*u+P*T+I*g,y=n[8],R=n[9],P=n[10],I=n[11],t[8]=y*r+R*a+P*h+I*v,t[9]=y*i+R*l+P*f+I*S,t[10]=y*s+R*c+P*p+I*m,t[11]=y*o+R*u+P*T+I*g,y=n[12],R=n[13],P=n[14],I=n[15],t[12]=y*r+R*a+P*h+I*v,t[13]=y*i+R*l+P*f+I*S,t[14]=y*s+R*c+P*p+I*m,t[15]=y*o+R*u+P*T+I*g,t}function dl(t,e,n){const r=n[0],i=n[1],s=n[2];let o,a,l,c,u,h,f,p,T,v,S,m;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],h=e[5],f=e[6],p=e[7],T=e[8],v=e[9],S=e[10],m=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=h,t[6]=f,t[7]=p,t[8]=T,t[9]=v,t[10]=S,t[11]=m,t[12]=o*r+u*i+T*s+e[12],t[13]=a*r+h*i+v*s+e[13],t[14]=l*r+f*i+S*s+e[14],t[15]=c*r+p*i+m*s+e[15]),t}function fd(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function cP(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o),l,c,u,h,f,p,T,v,S,m,g,y,R,P,I,k,N,F,O,H,W,q,K,We;return a<Ra?null:(a=1/a,i*=a,s*=a,o*=a,c=Math.sin(n),l=Math.cos(n),u=1-l,h=e[0],f=e[1],p=e[2],T=e[3],v=e[4],S=e[5],m=e[6],g=e[7],y=e[8],R=e[9],P=e[10],I=e[11],k=i*i*u+l,N=s*i*u+o*c,F=o*i*u-s*c,O=i*s*u-o*c,H=s*s*u+l,W=o*s*u+i*c,q=i*o*u+s*c,K=s*o*u-i*c,We=o*o*u+l,t[0]=h*k+v*N+y*F,t[1]=f*k+S*N+R*F,t[2]=p*k+m*N+P*F,t[3]=T*k+g*N+I*F,t[4]=h*O+v*H+y*W,t[5]=f*O+S*H+R*W,t[6]=p*O+m*H+P*W,t[7]=T*O+g*H+I*W,t[8]=h*q+v*K+y*We,t[9]=f*q+S*K+R*We,t[10]=p*q+m*K+P*We,t[11]=T*q+g*K+I*We,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Dv(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+h*r,t[7]=l*i+f*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=h*i-a*r,t[11]=f*i-l*r,t}function uP(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],h=e[10],f=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-h*r,t[3]=l*i-f*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+h*i,t[11]=l*r+f*i,t}function Fv(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+h*r,t[3]=l*i+f*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=h*i-a*r,t[7]=f*i-l*r,t}function hP(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,h=r*a,f=i*o,p=i*a,T=i*l,v=s*o,S=s*a,m=s*l;return t[0]=1-h-T,t[1]=u+m,t[2]=f-S,t[3]=0,t[4]=u-m,t[5]=1-c-T,t[6]=p+v,t[7]=0,t[8]=f+S,t[9]=p-v,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fP(t,e,n,r,i,s,o){const a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function dP(t,e,n,r,i){const s=1/Math.tan(e/2);if(t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const o=1/(r-i);t[10]=(i+r)*o,t[14]=2*i*r*o}else t[10]=-1,t[14]=-2*r;return t}const pP=dP;function gP(t,e,n,r,i,s,o){const a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}const _P=gP;function mP(t,e,n,r){let i,s,o,a,l,c,u,h,f,p;const T=e[0],v=e[1],S=e[2],m=r[0],g=r[1],y=r[2],R=n[0],P=n[1],I=n[2];return Math.abs(T-R)<Ra&&Math.abs(v-P)<Ra&&Math.abs(S-I)<Ra?oP(t):(h=T-R,f=v-P,p=S-I,i=1/Math.sqrt(h*h+f*f+p*p),h*=i,f*=i,p*=i,s=g*p-y*f,o=y*h-m*p,a=m*f-g*h,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),l=f*a-p*o,c=p*s-h*a,u=h*o-f*s,i=Math.sqrt(l*l+c*c+u*u),i?(i=1/i,l*=i,c*=i,u*=i):(l=0,c=0,u=0),t[0]=s,t[1]=l,t[2]=h,t[3]=0,t[4]=o,t[5]=c,t[6]=f,t[7]=0,t[8]=a,t[9]=u,t[10]=p,t[11]=0,t[12]=-(s*T+o*v+a*S),t[13]=-(l*T+c*v+u*S),t[14]=-(h*T+f*v+p*S),t[15]=1,t)}function yP(){const t=new Fi(4);return Fi!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function vP(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function vo(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){const t=yP();return function(e,n,r,i,s,o){let a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Bh;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Bh||(Bh={}));const TP=45*Math.PI/180,wP=1,ou=.1,au=500,EP=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Jt extends sP{static get IDENTITY(){return AP()}static get ZERO(){return SP()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Bh}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,c,u,h,f,p,T,v,S){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=h,this[11]=f,this[12]=p,this[13]=T,this[14]=v,this[15]=S,this.check()}setRowMajor(e,n,r,i,s,o,a,l,c,u,h,f,p,T,v,S){return this[0]=e,this[1]=s,this[2]=c,this[3]=p,this[4]=n,this[5]=o,this[6]=u,this[7]=T,this[8]=r,this[9]=a,this[10]=h,this[11]=v,this[12]=i,this[13]=l,this[14]=f,this[15]=S,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(EP)}fromObject(e){return this.check()}fromQuaternion(e){return hP(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=ou,far:a=au}=e;return a===1/0?RP(this,n,r,i,s,o):fP(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return mP(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=ou,far:a=au}=e;return _P(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=TP,aspect:r=wP,focalDistance:i=1,near:s=ou,far:o=au}=e;u_(n);const a=n/2,l=i*Math.tan(a),c=l*r;return this.ortho({left:-c,right:c,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return u_(n),pP(this,n,r,i,s),this.check()}determinant(){return lP(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return aP(this,this),this.check()}invert(){return Uh(this,this),this.check()}multiplyLeft(e){return wr(this,e,this),this.check()}multiplyRight(e){return wr(this,this,e),this.check()}rotateX(e){return Dv(this,this,e),this.check()}rotateY(e){return uP(this,this,e),this.check()}rotateZ(e){return Fv(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return cP(this,this,e,n),this.check()}scale(e){return fd(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return dl(this,this,e),this.check()}transform(e,n){return e.length===4?(n=vo(n||[-0,-0,-0,-0],e,this),iu(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=WC(n||[-0,-0],e,this);break;case 3:i=Ov(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return iu(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=$C(n||[-0,-0],e,this);break;case 3:r=Nv(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return iu(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let ra,ia;function SP(){return ra||(ra=new Jt([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(ra)),ra}function AP(){return ia||(ia=new Jt,Object.freeze(ia)),ia}function u_(t){if(t>Math.PI*2)throw Error("expected radians")}function RP(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),c=(i+r)/(i-r),u=-1,h=-1,f=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=u,t[11]=h,t[12]=0,t[13]=0,t[14]=f,t[15]=0,t}const h_=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`,bP={lightSources:{}};function lu(t={}){const{color:e=[0,0,0],intensity:n=1}=t;return e.map(r=>r*n/255)}function CP({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return t?r["lighting_uAmbientLight.color"]=lu(t):r["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((i,s)=>{r[`lighting_uPointLight[${s}].color`]=lu(i),r[`lighting_uPointLight[${s}].position`]=i.position,r[`lighting_uPointLight[${s}].attenuation`]=i.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,n.forEach((i,s)=>{r[`lighting_uDirectionalLight[${s}].color`]=lu(i),r[`lighting_uDirectionalLight[${s}].direction`]=i.direction}),r.lighting_uDirectionalLightCount=n.length,r}function Uv(t=bP){var e,n;if("lightSources"in t){const{ambientLight:r,pointLights:i,directionalLights:s}=t.lightSources||{};return r||i&&i.length>0||s&&s.length>0?Object.assign({},CP({ambientLight:r,pointLights:i,directionalLights:s}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const r={pointLights:[],directionalLights:[]};for(const i of t.lights||[])switch(i.type){case"ambient":r.ambientLight=i;break;case"directional":(e=r.directionalLights)==null||e.push(i);break;case"point":(n=r.pointLights)==null||n.push(i);break}return Uv({lightSources:r})}return{}}const Bv={name:"lights",vs:h_,fs:h_,getUniforms:Uv,defines:{MAX_LIGHTS:3}},Lv=`uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
vec3 halfway_direction = normalize(light_direction + view_direction);
float lambertian = dot(light_direction, normal_worldspace);
float specular = 0.0;
if (lambertian > 0.0) {
float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
specular = pow(specular_angle, lighting_uShininess);
}
lambertian = max(lambertian, 0.0);
return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = surfaceColor;
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = vec3(0, 0, 0);
vec3 surfaceColor = vec3(0, 0, 0);
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
`,PP={};function xP(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function Vv(t=PP){if(!("material"in t))return{};const{material:e}=t;return e?xP(e):{lighting_uEnabled:!1}}const IP={name:"gouraud-lighting",dependencies:[Bv],vs:Lv,defines:{LIGHTING_VERTEX:1},getUniforms:Vv},MP={name:"phong-lighting",dependencies:[Bv],fs:Lv,defines:{LIGHTING_FRAGMENT:1},getUniforms:Vv},zv="#define SMOOTH_EDGE_RADIUS 0.5",kP=`
${zv}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,NP=`
${zv}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,OP={name:"geometry",vs:kP,fs:NP},ee={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ee,"IDENTITY",{get:()=>(te.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Yt={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},pl={common:0,meters:1,pixels:2},Lh={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},DP=Object.keys(ee).map(t=>`const int COORDINATE_SYSTEM_${t} = ${ee[t]};`).join(""),FP=Object.keys(Yt).map(t=>`const int PROJECTION_MODE_${t} = ${Yt[t]};`).join(""),UP=Object.keys(pl).map(t=>`const int UNIT_${t.toUpperCase()} = ${pl[t]};`).join(""),BP=`${DP}
${FP}
${UP}
uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project_uPseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project_uCommonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project_uCommonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project_uCommonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project_uWrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project_uModelMatrix * position;
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project_uCoordinateOrigin;
}
}
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project_uCoordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
return offset * project_uFocalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project_uScale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project_uScale;
}
`;function LP(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function To(t){let e={},n;return r=>{for(const i in r)if(!LP(r[i],e[i])){n=t(r),e=r;break}return n}}const f_=[0,0,0,0],VP=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],jv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],zP=[0,0,0],Hv=[0,0,0],jP=To($P);function Wv(t,e,n=Hv){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===ee.LNGLAT_OFFSETS||e===ee.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Yt.WEB_MERCATOR:(e===ee.LNGLAT||e===ee.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Yt.WEB_MERCATOR_AUTO_OFFSET:e===ee.LNGLAT?r=i:e===ee.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Yt.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Yt.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function HP(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=f_,l=f_,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:h,offsetMode:f}=Wv(t,e,n);return f&&(l=t.projectPosition(u||h),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=vo([],l,o),s=r||s,o=wr([],i,s),o=wr([],o,VP)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:h,geospatialOrigin:u}}function WP({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=ee.DEFAULT,coordinateOrigin:i=Hv,autoWrapLongitude:s=!1}){r===ee.DEFAULT&&(r=t.isGeospatial?ee.LNGLAT:ee.CARTESIAN);const o=jP({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||jv,o}function $P({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=HP(t,n,r),u=t.getDistanceScales(),h=[t.width*e,t.height*e],f=vo([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,p={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:zP,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:jv,project_uCameraPosition:a};if(c){const T=t.getDistanceScales(c);switch(n){case ee.METER_OFFSETS:p.project_uCommonUnitsPerWorldUnit=T.unitsPerMeter,p.project_uCommonUnitsPerWorldUnit2=T.unitsPerMeter2;break;case ee.LNGLAT:case ee.LNGLAT_OFFSETS:t._pseudoMeters||(p.project_uCommonUnitsPerMeter=T.unitsPerMeter),p.project_uCommonUnitsPerWorldUnit=T.unitsPerDegree,p.project_uCommonUnitsPerWorldUnit2=T.unitsPerDegree2;break;case ee.CARTESIAN:p.project_uCommonUnitsPerWorldUnit=[1,1,T.unitsPerMeter[2]],p.project_uCommonUnitsPerWorldUnit2=[0,0,T.unitsPerMeter2[2]];break}}return p}const XP={};function YP(t=XP){return"viewport"in t?WP(t):{}}const dd={name:"project",dependencies:[AC,OP],vs:BP,getUniforms:YP},KP=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,qP={name:"project32",dependencies:[dd],vs:KP};function ZP(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Ei(t,e){const n=vo([],e,t);return vP(n,n,1/n[3]),n}function d_(t,e){const n=t%e;return n<0?e+n:n}function Vh(t,e,n){return t<e?e:t>n?n:t}function QP(t){return Math.log(t)*Math.LOG2E}const pd=Math.log2||QP;function _n(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const xt=Math.PI,$v=xt/4,vt=xt/180,zh=180/xt,Ui=512,gl=4003e4,sa=85.051129,JP=1.5;function GP(t){return pd(t)}function _l(t){const[e,n]=t;_n(Number.isFinite(e)),_n(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*vt,i=n*vt,s=Ui*(r+xt)/(2*xt),o=Ui*(xt+Math.log(Math.tan($v+i*.5)))/(2*xt);return[s,o]}function Bi(t){const[e,n]=t,r=e/Ui*(2*xt)-xt,i=2*(Math.atan(Math.exp(n/Ui*(2*xt)-xt))-$v);return[r*zh,i*zh]}function e2(t){const{latitude:e}=t;_n(Number.isFinite(e));const n=Math.cos(e*vt);return GP(gl*n)-9}function cu(t){const e=Math.cos(t*vt);return Ui/gl/e}function jh(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;_n(Number.isFinite(e)&&Number.isFinite(n));const i=Ui,s=Math.cos(e*vt),o=i/360,a=o/s,l=i/gl/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const u=vt*Math.tan(e*vt)/s,h=o*u/2,f=i/gl*u,p=f/a*l;c.unitsPerDegree2=[0,h,f],c.unitsPerMeter2=[p,0,p]}return c}function Xv(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=jh({longitude:n,latitude:r,highPrecision:!0}),u=_l(t);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const h=Bi(u),f=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[h[0],h[1],f]:h}function t2(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=ZP();dl(a,a,[0,0,-i]),Dv(a,a,-n*vt),Fv(a,a,r*vt);const l=s/e;return fd(a,a,[l,l,l]),o&&dl(a,a,qC([],o)),a}function n2(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=t;let{fovy:u=ml(JP)}=t;r!==void 0&&(u=ml(r));const h=u*vt,f=i*vt,p=Yv(u);let T=p;o&&(T+=o[2]*a/Math.cos(f)/n);const v=h*(.5+(s?s[1]:0)/n),S=Math.sin(v)*T/Math.sin(Vh(Math.PI/2-f-v,.01,Math.PI-.01)),m=Math.sin(f)*S+T,g=T*10,y=Math.min(m*c,g);return{fov:h,aspect:e/n,focalDistance:p,near:l,far:y}}function ml(t){return 2*Math.atan(.5/t)*zh}function Yv(t){return .5/Math.tan(.5*t*vt)}function Kv(t,e){const[n,r,i=0]=t;return _n(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Ei(e,[n,r,i,1])}function gd(t,e,n=0){const[r,i,s]=t;if(_n(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Ei(e,[r,i,s,1]);const o=Ei(e,[r,i,0,1]),a=Ei(e,[r,i,1,1]),l=o[2],c=a[2],u=l===c?0:((n||0)-l)/(c-l);return kv([],o,a,u)}function r2(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[c,u]]=r,h=i2(t.padding),f=_l([a,Vh(u,-sa,sa)]),p=_l([c,Vh(l,-sa,sa)]),T=[Math.max(Math.abs(p[0]-f[0]),i),Math.max(Math.abs(p[1]-f[1]),i)],v=[e-h.left-h.right-Math.abs(o[0])*2,n-h.top-h.bottom-Math.abs(o[1])*2];_n(v[0]>0&&v[1]>0);const S=v[0]/T[0],m=v[1]/T[1],g=(h.right-h.left)/2/S,y=(h.top-h.bottom)/2/m,R=[(p[0]+f[0])/2+g,(p[1]+f[1])/2+y],P=Bi(R),I=Math.min(s,pd(Math.abs(Math.min(S,m))));return _n(Number.isFinite(I)),{longitude:P[0],latitude:P[1],zoom:I}}function i2(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(_n(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const p_=Math.PI/180;function s2(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,c;const u=t.fovy?.5*t.fovy*p_:Math.atan(.5/t.altitude),h=(90-t.pitch)*p_;return u>h-.01?(l=g_(t,0,e),c=g_(t,n,e)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}function g_(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Ei(r,[e,0,1,1]),s=Ei(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=kv([],i,s,a),c=Bi(l);return c.push(n),c}const __=512;function o2(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=d_(i+180,360)-180),(a<-180||a>180)&&(a=d_(a+180,360)-180);const l=pd(n/__);if(o<=l)o=l,s=0;else{const c=n/2/Math.pow(2,o),u=Bi([0,c])[1];if(s<u)s=u;else{const h=Bi([0,__-c])[1];s>h&&(s=h)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const a2=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,l2=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,c2=To(p2),u2=To(g2),h2=[0,0,0,1],f2=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function d2(t,e){const[n,r,i]=t,s=gd([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function p2({viewport:t,center:e}){return new Jt(t.viewProjectionMatrix).invert().transform(e)}function g2({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>d2(o,r));for(const o of e){const a=o.clone().translate(new Qt(t.center).negate()),l=s.map(u=>a.transform(u)),c=new Jt().ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});n.push(c.multiplyRight(o))}return n}function _2(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||h2,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=c2({viewport:t.viewport,center:e.project_uCenter}),s=[],o=u2({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],c=l.clone().translate(new Qt(t.viewport.center).negate());e.project_uCoordinateSystem===ee.LNGLAT&&e.project_uProjectionMode===Yt.WEB_MERCATOR?(o[a]=c,s[a]=i):(o[a]=l.clone().multiplyRight(f2),s[a]=c.transform(i))}for(let a=0;a<o.length;a++)r[`shadow_uViewProjectionMatrices[${a}]`]=o[a],r[`shadow_uProjectCenters[${a}]`]=s[a];for(let a=0;a<2;a++)r[`shadow_uShadowMap${a}`]=t.shadowMaps&&t.shadowMaps[a]||t.dummyShadowMap;return r}const m_={name:"shadow",dependencies:[dd],vs:a2,fs:l2,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?_2(t,e):{}},m2={...a_,defaultUniforms:{...a_.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},y2=[dd],v2=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function T2(){const t=rl.getDefaultShaderAssembler();for(const e of y2)t.addDefaultModule(e);for(const e of v2)t.addShaderHook(e);return t}const w2=[255,255,255],E2=1;let S2=0;class qv{constructor(e={}){this.type="ambient";const{color:n=w2}=e,{intensity:r=E2}=e;this.id=e.id||`ambient-${S2++}`,this.color=n,this.intensity=r}}const A2=[255,255,255],R2=1,b2=[0,0,-1];let C2=0;class y_{constructor(e={}){this.type="directional";const{color:n=A2}=e,{intensity:r=R2}=e,{direction:i=b2}=e,{_shadow:s=!1}=e;this.id=e.id||`directional-${C2++}`,this.color=n,this.intensity=r,this.type="directional",this.direction=new Qt(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class P2{constructor(e,n={id:"pass"}){const{id:r}=n;this.id=r,this.device=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class _d extends P2{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[n,r]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,s=e.clearColor??(i?[0,0,0,0]:!1),o=i?1:!1,a=i?0:!1,l=e.colorMask??15,c={viewport:[0,0,n,r]};e.colorMask&&(c.colorMask=l),e.scissorRect&&(c.scissorRect=e.scissorRect);const u=this.device.beginRenderPass({framebuffer:e.target,parameters:c,clearColor:s,clearDepth:o,clearStencil:a});try{return this._drawLayers(u,e)}finally{u.end()}}_drawLayers(e,n){const{target:r,moduleParameters:i,viewports:s,views:o,onViewportActive:a,clearStack:l=!0}=n;n.pass=n.pass||"unknown",l&&(this._lastRenderIndex=-1);const c=[];for(const u of s){const h=o&&o[u.id];a==null||a(u);const f=this._getDrawLayerParams(u,n),p=u.subViewports||[u];for(const T of p){const v=this._drawLayersInViewport(e,{target:r,moduleParameters:i,viewport:T,view:h,pass:n.pass,layers:n.layers},f);c.push(v)}}return c}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l},c=!1){var T;const u=[],h=Zv(this._lastRenderIndex+1),f={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},p={};for(let v=0;v<n.length;v++){const S=n[v],m=this._shouldDrawLayer(S,f,s,p),g={shouldDrawLayer:m};m&&!c&&(g.layerRenderIndex=h(S,m),g.moduleParameters=this._getModuleParameters(S,a,r,l),g.layerParameters={...(T=S.context.deck)==null?void 0:T.props.parameters,...this.getLayerParameters(S,v,e)}),u[v]=g}return u}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const c=x2(this.device,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const h=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:c},()=>this.device.clearWebGL(h))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let h=0;h<n.length;h++){const f=n[h],{shouldDrawLayer:p,layerRenderIndex:T,moduleParameters:v,layerParameters:S}=l[h];if(p&&f.props.pickable&&u.pickableCount++,f.isComposite)u.compositeCount++;else if(p){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,T),v.viewport=o,f.context.renderPass=e;try{f._drawLayer({renderPass:e,moduleParameters:v,uniforms:{layerIndex:T},parameters:S})}catch(m){f.raiseError(m,`drawing ${f} to ${i}`)}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var a,l;const s=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create(((a=e.internalState)==null?void 0:a.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,picking:{isActive:0},devicePixelRatio:s});if(n)for(const c of n)Object.assign(o,(l=c.getModuleParameters)==null?void 0:l.call(c,e));return Object.assign(o,this.getModuleParameters(e,n),i)}}function Zv(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in e)&&r(i.parent,!1),l in n){const u=n[l]=n[l]||Zv(e[l],e);c=u(i,s),n[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),n[a]=null):c=t;return s&&c>=t&&(t=c+1),e[a]=c,c};return r}function x2(t,{moduleParameters:e,target:n,viewport:r}){const i=e&&e.devicePixelRatio||t.canvasContext.cssToDeviceRatio(),[,s]=t.canvasContext.getDrawingBufferSize(),o=n?n.height:s,a=r;return[a.x*i,o-(a.y+a.height)*i,a.width*i,a.height*i]}class I2 extends _d{constructor(e,n){super(e,n),this.shadowMap=e.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(e){const n=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],s=i.width*r,o=i.height*r,a=[1,1,1,1];(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,clearColor:a,target:n,pass:"shadow"})}getLayerParameters(e,n,r){return{...e.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}}const M2={color:[255,255,255],intensity:1},v_=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],k2=[0,0,0,200/255];class md{constructor(e={}){this.id="lighting-effect",this.shadowColor=k2,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:n,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(n),r._addDefaultShaderModule(m_),this.dummyShadowMap=n.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(e){for(const n of this.shadowPasses)n.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(m_))}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new Jt().lookAt({eye:new Qt(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new I2(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new qv(M2),this.directionalLights.push(new y_(v_[0]),new y_(v_[1])))}}class N2{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=i||e&&e.constructor||Float32Array,u=n*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let h=1/0;l&&(h=l*r+s);const f=this._allocate(c,u,a,h);return e&&o?f.set(e):a||f.fill(0,0,4),this._release(e),f}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return r&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const so=new N2;function vs(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function O2(t){return[t[12],t[13],t[14]]}function D2(t){return{left:Hr(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Hr(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Hr(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Hr(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Hr(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Hr(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const T_=new Qt;function Hr(t,e,n,r){T_.set(t,e,n);const i=T_.len();return{distance:r/i,normal:new Qt(-t/i,-e/i,-n/i)}}function F2(t){return t-Math.fround(t)}let ls;function uu(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;ls=so.allocate(ls,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const c=t[o++];ls[a+l]=c,ls[a+l+n]=F2(c)}a+=n*2}return ls.subarray(0,s*n*2)}function U2(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const B2=Math.PI/180,L2=vs(),w_=[0,0,0],V2={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function z2({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,c=n?new Jt().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new Jt().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:u=0,right:h=0,top:f=0,bottom:p=0}=s,T=Dn((u+t-h)/2,0,t)-t/2,v=Dn((f+e-p)/2,0,e)-e/2;c[8]-=T*2/t,c[9]+=v*2/e}return c}class wo{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||V2,this.focalDistance=e.focalDistance||1,this.position=e.position||w_,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Yt.WEB_MERCATOR:Yt.WEB_MERCATOR_AUTO_OFFSET:Yt.IDENTITY}equals(e){return e instanceof wo?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&io(e.projectionMatrix,this.projectionMatrix)&&io(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=Kv(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],c=gd([i,a,o],this.pixelUnprojectionMatrix,l),[u,h,f]=this.unprojectPosition(c);return Number.isFinite(o)?[u,h,f]:Number.isFinite(r)?[u,h,r]:[u,h]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=_l(e);return n[1]=Dn(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Bi(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?jh({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,D2(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=e2({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||jh({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=w_;if(s&&(a=o?new Jt(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new Qt(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=L2,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:c=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new Jt().multiplyRight(n).translate(new Qt(this.center).negate()),this.projectionMatrix=r||z2({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*B2,focalDistance:u,padding:c,near:a,far:l});const h=vs();wr(h,h,this.projectionMatrix),wr(h,h,this.viewMatrix),this.viewProjectionMatrix=h,this.viewMatrixInverse=Uh([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=O2(this.viewMatrixInverse);const f=vs(),p=vs();fd(f,f,[this.width/2,-this.height/2,1]),dl(f,f,[1,-1,0]),wr(p,f,this.viewProjectionMatrix),this.pixelProjectionMatrix=p,this.pixelUnprojectionMatrix=Uh(vs(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||te.warn("Pixel project matrix not invertible")()}}wo.displayName="Viewport";class Li extends wo{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:c,farZ:u,orthographic:h=!1,projectionMatrix:f,repeat:p=!1,worldOffset:T=0,position:v,padding:S,legacyMeterSizes:m=!1}=e;let{width:g,height:y,altitude:R=1.5}=e;const P=Math.pow(2,i);g=g||1,y=y||1;let I,k=null;if(f)R=f[5]/2,I=ml(R);else{e.fovy?(I=e.fovy,R=Yv(I)):I=ml(R);let F;if(S){const{top:O=0,bottom:H=0}=S;F=[0,Dn((O+y-H)/2,0,y)-y/2]}k=n2({width:g,height:y,scale:P,center:v&&[0,0,v[2]*cu(n)],offset:F,pitch:s,fovy:I,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(c)&&(k.near=c),Number.isFinite(u)&&(k.far=u)}let N=t2({height:y,pitch:s,bearing:o,scale:P,altitude:R});T&&(N=new Jt().translate([512*T,0,0]).multiplyLeft(N)),super({...e,width:g,height:y,viewMatrix:N,longitude:r,latitude:n,zoom:i,...k,fovy:I,focalDistance:R}),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=R,this.fovy=I,this.orthographic=h,this._subViewports=p?[]:null,this._pseudoMeters=m,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Li({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*cu(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/cu(r);return[n,r,i]}addMetersToLngLat(e,n){return Xv(e,n)}panByPosition(e,n){const r=gd(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=c_([],i,HC([],r)),o=c_([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=s2(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=r2({width:r,height:i,bounds:e,...n});return new Li({width:r,height:i,longitude:s,latitude:o,zoom:a})}}Li.displayName="WebMercatorViewport";const E_=[0,0,0];function hu(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Li){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function j2(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===ee.DEFAULT&&(i=e.isGeospatial?ee.LNGLAT:ee.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function Qv(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=vo([],[o,a,l,1],n)),r){case ee.LNGLAT:return hu([o,a,l],e,s);case ee.LNGLAT_OFFSETS:return hu([o+i[0],a+i[1],l+(i[2]||0)],e,s);case ee.METER_OFFSETS:return hu(Xv(i,[o,a,l]),e,s);case ee.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function Jv(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=j2(e),{autoOffset:l=!0}=e,{geospatialOrigin:c=E_,shaderCoordinateOrigin:u=E_,offsetMode:h=!1}=l?Wv(n,r,i):{},f=Qv(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:h});if(h){const p=n.projectPosition(c||u);iP(f,f,p)}return f}const H2=[255,255,255],W2=1,$2=[0,0,1],X2=[0,0,1];let Y2=0;class Gv{constructor(e={}){this.type="point";const{color:n=H2}=e,{intensity:r=W2}=e,{position:i=X2}=e;this.id=e.id||`point-${Y2++}`,this.color=n,this.intensity=r,this.type="point",this.position=i,this.attenuation=K2(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,r=e.context.viewport,{coordinateSystem:i,coordinateOrigin:s}=e.props,o=Jv(this.position,{viewport:r,coordinateSystem:i,coordinateOrigin:s,fromCoordinateSystem:r.isGeospatial?ee.LNGLAT:ee.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=o,n}}function K2(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:$2}let q2=1,Z2=1;class eT{constructor(){d(this,"time",0);d(this,"channels",new Map);d(this,"animations",new Map);d(this,"playing",!1);d(this,"lastEngineTime",-1)}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=q2++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=Z2++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}let Q2=0;const J2={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:Ti.stats.get(`animation-loop-${Q2++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class G2{constructor(e){d(this,"device",null);d(this,"canvas",null);d(this,"props");d(this,"animationProps",null);d(this,"timeline",null);d(this,"stats");d(this,"cpuTime");d(this,"gpuTime");d(this,"frameRate");d(this,"display");d(this,"needsRedraw","initialized");d(this,"_initialized",!1);d(this,"_running",!1);d(this,"_animationFrameId",null);d(this,"_nextFramePromise",null);d(this,"_resolveNextFrame",null);d(this,"_cpuStartTime",0);if(this.props={...J2,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:n=!0}=this.props;this.stats=e.stats||new tc({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:n}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const n=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(n),n}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return(e=this.device)!=null&&e.isLost?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=F3(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(U3(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var e,n;if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:(n=(e=this.device)==null?void 0:e.canvasContext)==null?void 0:n.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=((e=this.device.canvasContext)==null?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){var s,o,a,l;if(!this.device)return{width:1,height:1,aspect:1};const[e,n]=((o=(s=this.device)==null?void 0:s.canvasContext)==null?void 0:o.getPixelSize())||[1,1];let r=1;const i=(l=(a=this.device)==null?void 0:a.canvasContext)==null?void 0:l.canvas;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e,n;this.props.autoResizeDrawingBuffer&&((n=(e=this.device)==null?void 0:e.canvasContext)==null||n.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}class S_{constructor(e){d(this,"id");d(this,"userData",{});d(this,"topology");d(this,"bufferLayout",[]);d(this,"vertexCount");d(this,"indices");d(this,"attributes");this.id=e.id||Dr("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&le(this.indices.usage===ge.INDEX)}destroy(){var e;(e=this.indices)==null||e.destroy();for(const n of Object.values(this.attributes))n.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(e){return e.byteLength/12}}function ex(t,e){if(e instanceof S_)return e;const n=tx(t,e),{attributes:r,bufferLayout:i}=nx(t,e);return new S_({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:n,attributes:r})}function tx(t,e){if(!e.indices)return;const n=e.indices.value;return t.createBuffer({usage:ge.INDEX,data:n})}function nx(t,e){const n=[],r={};for(const[s,o]of Object.entries(e.attributes)){let a=s;switch(s){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}r[a]=t.createBuffer({data:o.value,id:`${s}-buffer`});const{value:l,size:c,normalized:u}=o;n.push({name:a,format:M3(l,c,u)})}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}class rx{constructor(e){d(this,"modules");d(this,"moduleUniforms");d(this,"moduleBindings");d(this,"moduleUniformsChanged");const n=rc(Object.values(e).filter(r=>r.dependencies));for(const r of n)e[r.name]=r;B.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,i]of Object.entries(e)){const s=r;this.moduleUniforms[s]=i.defaultUniforms||{},this.moduleBindings[s]={}}}destroy(){}setProps(e){var n;for(const r of Object.keys(e)){const i=r,s=e[i],o=this.modules[i];if(!o){B.warn(`Module ${r} not found`)();continue}const a=this.moduleUniforms[i],l=this.moduleBindings[i],c=((n=o.getUniforms)==null?void 0:n.call(o,s,a))||s,{uniforms:u,bindings:h}=hd(c);this.moduleUniforms[i]={...a,...u},this.moduleBindings[i]={...l,...h}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){const e={};for(const n of Object.values(this.moduleBindings))Object.assign(e,n);return e}getDebugTable(){var n;const e={};for(const[r,i]of Object.entries(this.moduleUniforms))for(const[s,o]of Object.entries(i))e[`${r}.${s}`]={type:(n=this.modules[r].uniformTypes)==null?void 0:n[s],value:String(o)};return e}}const Dl=class Dl{constructor(e){d(this,"device");d(this,"_hashCounter",0);d(this,"_hashes",{});d(this,"_renderPipelineCache",{});d(this,"_computePipelineCache",{});this.device=e}static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new Dl(e),e._lumaData.defaultPipelineFactory}createRenderPipeline(e){const n={...Ni.defaultProps,...e},r=this._hashRenderPipeline(n);if(!this._renderPipelineCache[r]){const i=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._renderPipelineCache[r]={pipeline:i,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const n={...cl.defaultProps,...e},r=this._hashComputePipeline(n);if(!this._computePipelineCache[r]){const i=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._computePipelineCache[r]={pipeline:i,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const n=e.hash,r=e instanceof cl?this._computePipelineCache:this._renderPipelineCache;r[n].useCount--,r[n].useCount===0&&(r[n].pipeline.destroy(),delete r[n])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const n=this._getHash(e.vs.source),r=e.fs?this._getHash(e.fs.source):0,i="-",s=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${n}/${r}V${i}BL${s}`;default:const o=this._getHash(JSON.stringify(e.parameters));return`${n}/${r}V${i}T${e.topology}P${o}BL${s}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};d(Dl,"defaultProps",{...Ni.defaultProps});let Hh=Dl;const Fl=class Fl{constructor(e){d(this,"device");d(this,"_cache",{});this.device=e}static getDefaultShaderFactory(e){var n;return(n=e._lumaData).defaultShaderFactory||(n.defaultShaderFactory=new Fl(e)),e._lumaData.defaultShaderFactory}createShader(e){const n=this._hashShader(e);let r=this._cache[n];if(!r){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[n]=r={shader:i,useCount:0}}return r.useCount++,r.shader}release(e){const n=this._hashShader(e),r=this._cache[n];r&&(r.useCount--,r.useCount===0&&(delete this._cache[n],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}};d(Fl,"defaultProps",{...ol.defaultProps});let Wh=Fl;function ix(t,e){var i;const n={},r="Values";if(t.attributes.length===0&&!((i=t.varyings)!=null&&i.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const s of t.attributes)if(s){const o=`${s.location} ${s.name}: ${s.type}`;n[`in ${o}`]={[r]:s.stepMode||"vertex"}}for(const s of t.varyings||[]){const o=`${s.location} ${s.name}`;n[`out ${o}`]={[r]:JSON.stringify(s.accessor)}}return n}let Pe=null,fu=null;function sx(t,{id:e,minimap:n,opaque:r,top:i="0",left:s="0",rgbaScale:o=1}){Pe||(Pe=document.createElement("canvas"),Pe.id=e,Pe.title=e,Pe.style.zIndex="100",Pe.style.position="absolute",Pe.style.top=i,Pe.style.left=s,Pe.style.border="blue 1px solid",Pe.style.transform="scaleY(-1)",document.body.appendChild(Pe),fu=Pe.getContext("2d")),(Pe.width!==t.width||Pe.height!==t.height)&&(Pe.width=t.width/2,Pe.height=t.height/2,Pe.style.width="400px",Pe.style.height="400px");const a=t.device.readPixelsToArrayWebGL(t),l=fu.createImageData(t.width,t.height),c=0;for(let u=0;u<a.length;u+=4)l.data[c+u+0]=a[u+0]*o,l.data[c+u+1]=a[u+1]*o,l.data[c+u+2]=a[u+2]*o,l.data[c+u+3]=r?255:a[u+3]*o;fu.putImageData(l,0,0)}const Wr=2,ox=1e4,Ul=class Ul{constructor(e,n){d(this,"device");d(this,"id");d(this,"source");d(this,"vs");d(this,"fs");d(this,"pipelineFactory");d(this,"shaderFactory");d(this,"userData",{});d(this,"parameters");d(this,"topology");d(this,"bufferLayout");d(this,"isInstanced");d(this,"instanceCount",0);d(this,"vertexCount");d(this,"indexBuffer",null);d(this,"bufferAttributes",{});d(this,"constantAttributes",{});d(this,"bindings",{});d(this,"uniforms",{});d(this,"vertexArray");d(this,"transformFeedback",null);d(this,"pipeline");d(this,"shaderInputs");d(this,"_uniformStore");d(this,"_attributeInfos",{});d(this,"_gpuGeometry",null);d(this,"_getModuleUniforms");d(this,"props");d(this,"_pipelineNeedsUpdate","newly created");d(this,"_needsRedraw","initializing");d(this,"_destroyed",!1);d(this,"_lastDrawTimestamp",-1);d(this,"_lastLogTime",0);d(this,"_logOpen",!1);d(this,"_drawCount",0);var a,l,c,u;this.props={...Ul.defaultProps,...n},n=this.props,this.id=n.id||Dr("model"),this.device=e,Object.assign(this.userData,n.userData);const r=Object.fromEntries(((a=this.props.modules)==null?void 0:a.map(h=>[h.name,h]))||[]);this.setShaderInputs(n.shaderInputs||new rx(r));const i=ax(e),s=(((l=this.props.modules)==null?void 0:l.length)>0?this.props.modules:(c=this.shaderInputs)==null?void 0:c.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){(u=this.props).shaderLayout||(u.shaderLayout=wC(this.props.source));const{source:h,getUniforms:f}=this.props.shaderAssembler.assembleShader({platformInfo:i,...this.props,modules:s});this.source=h,this._getModuleUniforms=f}else{const{vs:h,fs:f,getUniforms:p}=this.props.shaderAssembler.assembleShaderPair({platformInfo:i,...this.props,modules:s});this.vs=h,this.fs=f,this._getModuleUniforms=p}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||Hh.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||Wh.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.uniforms&&this.setUniforms(n.uniforms),n.moduleSettings&&this.updateModuleSettings(n.moduleSettings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),(e=this._gpuGeometry)==null||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){this.predraw();let n;try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),il(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:r}=this.vertexArray,i=r?r.byteLength/(r.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:i,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){var r;(r=this._gpuGeometry)==null||r.destroy();const n=e&&ex(this.device,e);n&&(this.setTopology(n.topology||"triangle-list"),this.bufferLayout=A_(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)),this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){this.bufferLayout=this._gpuGeometry?A_(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){Nh(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new I3(this.shaderInputs.modules);for(const n of Object.keys(this.shaderInputs.modules)){const r=this._uniformStore.getManagedUniformBuffer(this.device,n);this.bindings[`${n}Uniforms`]=r}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindings()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,n){e.indices&&B.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(const[r,i]of Object.entries(e)){const s=this.bufferLayout.find(l=>R_(l).includes(r));if(!s){B.warn(`Model(${this.id}): Missing layout for buffer "${r}".`)();continue}const o=R_(s);let a=!1;for(const l of o){const c=this._attributeInfos[l];c&&(this.vertexArray.setBuffer(c.location,i),a=!0)}!a&&!((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)&&B.warn(`Model(${this.id}): Ignoring buffer "${i.id}" for unknown attribute "${r}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,n){for(const[r,i]of Object.entries(e)){const s=this._attributeInfos[r];s?this.vertexArray.setConstantWebGL(s.location,i):((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)||B.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){il(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettings(e){const{bindings:n,uniforms:r}=hd(this._getModuleUniforms(e));Object.assign(this.bindings,n),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let e=0;for(const n of Object.values(this.bindings))n instanceof sl?e=Math.max(e,n.texture.updateTimestamp):n instanceof ge||n instanceof gt?e=Math.max(e,n.updateTimestamp):n instanceof al||(e=Math.max(e,n.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const n={...e.attributes};for(const[r]of Object.entries(n))!this.pipeline.shaderLayout.attributes.find(i=>i.name===r)&&r!=="positions"&&delete n[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(n,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,n=null;this.pipeline&&(B.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,n=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders});let i=null;this.source?i=r:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:r,fs:i}),this._attributeInfos=mv(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),n&&this.shaderFactory.release(n)}return this.pipeline}_logDrawCallStart(){const e=B.level>3?0:ox;B.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,B.group(Wr,`>>> DRAWING MODEL ${this.id}`,{collapsed:B.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=ix(this.pipeline.shaderLayout,this.id);B.table(Wr,e)();const n=this.shaderInputs.getDebugTable();for(const[i,s]of Object.entries(this.uniforms))n[i]={value:s};B.table(Wr,n)();const r=this._getAttributeDebugTable();B.table(Wr,this._attributeInfos)(),B.table(Wr,r)(),B.groupEnd(Wr)(),this._logOpen=!1}}_logFramebuffer(e){const n=B.get("framebuffer");if(this._drawCount++,!n||this._drawCount++>3&&this._drawCount%60)return;const r=e.props.framebuffer;r&&sx(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[n,r]of Object.entries(this._attributeInfos))e[r.location]={name:n,type:r.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[r.location],r.bufferDataType)};if(this.vertexArray.indexBuffer){const{indexBuffer:n}=this.vertexArray,r=n.indexType==="uint32"?new Uint32Array(n.debugData):new Uint16Array(n.debugData);e.indices={name:"indices",type:n.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,n){const r=Tv(n);return(e instanceof ge?new r(e.debugData):e).toString()}};d(Ul,"defaultProps",{...Ni.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:rl.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let Vi=Ul;function A_(t,e){const n=[...t];for(const r of e){const i=n.findIndex(s=>s.name===r.name);i<0?n.push(r):n[i]=r}return n}function ax(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function R_(t){var e;return t.attributes?(e=t.attributes)==null?void 0:e.map(n=>n.attribute):[t.name]}class oo{constructor(e,n=Vi.defaultProps){d(this,"device");d(this,"model");d(this,"transformFeedback");le(oo.isSupported(e),"BufferTransform not yet implemented on WebGPU"),this.device=e,this.model=new Vi(this.device,{id:n.id||"buffer-transform-model",fs:n.fs||kb(),topology:n.topology||"point-list",...n}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:n.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(e){var n;return((n=e==null?void 0:e.info)==null?void 0:n.type)==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){const n=this.device.beginRenderPass(e);this.model.draw(n),n.end()}update(...e){console.warn("TextureTransform#update() not implemented")}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const n=this.getBuffer(e);if(n instanceof ge)return n.readAsync();const{buffer:r,byteOffset:i=0,byteLength:s=r.byteLength}=n;return r.readAsync(i,s)}}class lx{constructor(e){d(this,"id");d(this,"topology");d(this,"vertexCount");d(this,"indices");d(this,"attributes");d(this,"userData",{});const{attributes:n={},indices:r=null,vertexCount:i=null}=e;this.id=e.id||Dr("geometry"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(const[s,o]of Object.entries(n)){const a=ArrayBuffer.isView(o)?{value:o}:o;le(ArrayBuffer.isView(a.value),`${this._print(s)}: must be typed array or object with value as typed array`),(s==="POSITION"||s==="positions")&&!a.size&&(a.size=3),s==="indices"?(le(!this.indices),this.indices=a):this.attributes[s]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,n){return this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i of Object.values(e)){const{value:s,size:o,constant:a}=i;!a&&s&&o>=1&&(r=Math.min(r,s.length/o))}return le(Number.isFinite(r)),r}}const cx={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class tT extends _d{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:h,effects:f,pass:p="picking",pickZ:T,moduleParameters:v}){this.pickZ=T;const S=this._resetColorEncoder(T),m=[a,l,c,u],g=super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:h,effects:f==null?void 0:f.filter(R=>R.useInPicking),pass:p,isPicking:!0,moduleParameters:v,clearColor:[0,0,0,0],colorMask:15,scissorRect:m});return this._colorEncoderState=null,{decodePickingColor:S&&hx.bind(null,S),stats:g}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(e,n,r){const i={depthMask:!0,depthTest:!0,depthRange:[0,1],...e.props.parameters},{pickable:s,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?i.blend=!1:s&&o.includes("draw")&&(Object.assign(i,cx),i.blend=!0,i.blendColor=ux(this._colorEncoderState,e,r)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function ux(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(te.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function hx(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Yr={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},yl=Symbol.for("component"),Xn=Symbol.for("propTypes"),du=Symbol.for("deprecatedProps"),Si=Symbol.for("asyncPropDefaults"),Pr=Symbol.for("asyncPropOriginal"),Fn=Symbol.for("asyncPropResolved");function yd(t,e=()=>!0){return Array.isArray(t)?nT(t,e,[]):e(t)?[t]:[]}function nT(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?nT(i,e,n):e(i)&&n.push(i)}return n}function fx({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class dx{constructor(e,n,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=tl(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class px{constructor(e){var n;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:(n=e.device)==null?void 0:n.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new dx(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{};let a=o[n];const l=a&&a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(a?(a.onChange=i,a.resourceId=r.id):a={onChange:i,resourceId:r.id},o[n]=a,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const gx="layerManager.setLayers",_x="layerManager.activateViewport";class mx{constructor(e,n){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{Ve(_x,this,a),a&&(this.context.viewport=a)};const{deck:r,stats:i,viewport:s,timeline:o}=n||{};this.layers=[],this.resourceManager=new px({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e==null?void 0:e.gl,deck:r,shaderAssembler:T2(),defaultShaderModules:[],renderPass:void 0,stats:i||new tc({id:"deck.gl"}),viewport:s||new wo({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new eT,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ve(gx,this,n,e),this._lastRenderedLayers=e;const r=yd(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:n}=this.context;n.find(r=>r.name===e.name)||(n.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:n}=this.context,r=n.findIndex(i=>i.name===e.name);r>=0&&(n.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,n,r){r.raiseError(n,`${e} of ${r}`)}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?te.warn(`Multiple old layers with same id ${o.id}`)():r[o.id]=o;if(this._defaultShaderModulesChanged){for(const o of e)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s=`Uniform transition in ${o}`;break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&te.warn(`Multiple new layers with same id ${i.id}`)(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Yr.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Yr.MATCHED,n!==e&&(e.lifecycle=Yr.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=Yr.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Yr.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function It(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!It(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!It(t[s],e[s],n-1))return!1;return!0}return!1}class yx{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=yd(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!It(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):te.warn("missing `viewState` or `initialViewState`")()}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))==null?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const c=!!s.controller;c&&!l&&(r=!0),(r||!c)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const vx=/([0-9]+\.?[0-9]*)(%|px)/;function Sn(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=vx.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error(`Could not parse position string ${t}`)}}function An(t,e){return t.relative?Math.round(t.position*e):t.position}class zi{constructor(e){const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null}=e;this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Sn(r),this._y=Sn(i),this._width=Sn(s),this._height=Sn(o),this._padding=a&&{left:Sn(a.left||0),right:Sn(a.right||0),top:Sn(a.top||0),bottom:Sn(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.ViewportType===e.ViewportType&&It(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:An(this._x,e),y:An(this._y,n),width:An(this._width,e),height:An(this._height,n)};return this._padding&&(r.padding={left:An(this._padding.left,e),top:An(this._padding.top,n),right:An(this._padding.right,e),bottom:An(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class sc{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(r=(n=this.settings).onStart)==null||r.call(n,this)}end(){var e,n;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(n=(e=this.settings).onEnd)==null||n.call(e,this))}cancel(){var e,n;this._inProgress&&((n=(e=this.settings).onInterrupt)==null||n.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(n=(e=this.settings).onUpdate)==null||n.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const b_=()=>{},$h={BREAK:1,SNAP_TO_END:2,IGNORE:3},Tx=t=>t,wx=$h.BREAK;class Ex{constructor(e){this._onTransitionUpdate=n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,c=l(r/a),u=i.interpolateProps(s,o,c);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new sc(e.timeline),this.onViewStateChange=e.onViewStateChange||b_,this.onStateChange=e.onStateChange||b_}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===$h.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===$h.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||Tx,interpolator:s,interruption:n.transitionInterruption||wx,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}function je(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Sx{constructor(e){const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!io(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];je(Number.isFinite(r)||Array.isArray(r),`${n} is required for transition`)})}}const Ax=["longitude","latitude","zoom","bearing","pitch"],Rx=["longitude","latitude","zoom"];class rT extends Sx{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:Ax,required:Rx},super(r.transitionProps),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=fl(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,fl(e.around,n.around,r)))}return i}}const Rn={transitionDuration:0},bx=300,oa=t=>1-(1-t)*(1-t),$r={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},sr={};class Cx{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new Ex({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){var e;for(const n in this._events)this._events[n]&&((e=this.eventManager)==null||e.off(n,this.handleEvent));this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?bx:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=!!this.onViewStateChange;this.toggleEvents($r.WHEEL,u&&r),this.toggleEvents($r.PAN,u),this.toggleEvents($r.PINCH,u&&(a||l)),this.toggleEvents($r.TRIPLE_PAN,u&&l),this.toggleEvents($r.DOUBLE_TAP,u&&o),this.toggleEvents($r.KEYBOARD,u&&c),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Rn,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Rn,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:oa},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Rn,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:oa},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Rn,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Rn,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:oa},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return sr._startPinchRotation=e.rotation,sr._lastPinchEvent=e,this.updateViewport(r,Rn,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:sr._startPinchRotation-r})}return this.updateViewport(n,Rn,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),sr._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=sr;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:oa},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return sr._startPinchRotation=null,sr._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),c.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),c.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(i),c.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(i),c.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(i),c.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(i),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Rn:e?{...n,transitionInterpolator:new rT({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class Px{constructor(e,n){this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const C_=5,xx=1.2;class Ix extends Px{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:h=20,minZoom:f=0,maxPitch:p=60,minPitch:T=0,startPanLngLat:v,startZoomLngLat:S,startRotatePos:m,startBearing:g,startPitch:y,startZoom:R,normalize:P=!0}=e;je(Number.isFinite(s)),je(Number.isFinite(i)),je(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:h,minZoom:f,maxPitch:p,minPitch:T,normalize:P,position:u},{startPanLngLat:v,startZoomLngLat:S,startRotatePos:m,startBearing:g,startPitch:y,startZoom:R}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Dn(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Dn(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Dn(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,o2(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:c,height:u}=this.getViewportProps(),h=s/c;let f=0;o>0?Math.abs(u-l)>C_&&(f=o/(l-u)*xx):o<0&&l>C_&&(f=1-a/l),f=Dn(f,-1,1);const{minPitch:p,maxPitch:T}=this.getViewportProps(),v=i+180*h;let S=r;return f>0?S=r+f*(T-r):f<0&&(S=r-f*(p-r)),{pitch:S,bearing:v}}}class Mx extends Cx{constructor(){super(...arguments),this.ControllerState=Ix,this.transition={transitionDuration:300,transitionInterpolator:new rT({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class iT extends zi{constructor(e={}){super(e)}get ViewportType(){return Li}get ControllerType(){return Mx}}iT.displayName="MapView";const kx=new md;function Nx(t,e){const n=t.order??1/0,r=e.order??1/0;return n-r}class Ox{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>Nx(i,e)>0);r<0?n.push(e):n.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(It(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];let o=i;s&&s!==i?s.setProps?(s.setProps(i.props),o=s):s.cleanup(this._context):s||i.setup(this._context),r.push(o),delete n[i.id]}for(const i in n)n[i].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof md)||this._resolvedEffects.push(kx),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class Dx extends _d{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const Fx="deckRenderer.renderLayers";class Ux{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Dx(e),this.pickLayersPass=new tT(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);const s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Ve(Fx,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,n=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(r=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${r}`,colorAttachments:[i]}))});for(const r of e)r.resize(n)}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1]};for(const s of e)if(s.postRender){i.target=s.id===this.lastPostProcessEffect?n.target:void 0;const o=s.postRender(i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const Bx={pickedColor:null,pickedObjectIndex:-1};function Lx({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:c}=s;let u=i*i,h=-1,f=0;for(let p=0;p<c;p++){const T=p+a-r,v=T*T;if(v>u)f+=4*l;else for(let S=0;S<l;S++){if(t[f+3]-1>=0){const g=S+o-n,y=g*g+v;y<=u&&(u=y,h=f)}f+=4}}if(h>=0){const p=t.slice(h,h+4),T=e(p);if(T){const v=Math.floor(h/4/l),S=h/4-v*l;return{...T,pickedColor:p,pickedX:o+S,pickedY:a+v}}te.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Bx}function Vx({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):te.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function sT({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=jx((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function zx(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const h=n.index,f=n.layerId,p=o?o.props.id:null;if(p!==f||a!==h){if(p!==f){const T=i.find(v=>v.props.id===f);T&&l.unshift(T)}n.layerId=p,n.index=a,n.info=null}}const c=sT(t),u=new Map;return u.set(null,c),l.forEach(h=>{let f={...c};h===o&&(f.color=s,f.index=a,f.picked=!0),f=oT({layer:h,info:f,mode:r});const p=f.layer;h===o&&r==="hover"&&(n.info=f),u.set(p.id,f),r==="hover"&&p.updateAutoHighlight(f)}),u}function oT({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function jx(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class Hx{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new tT(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(f=>f.id===o):null,c=a&&i.find(f=>f.id===a)||i[0],u=c&&c.unproject([e-c.x,n-c.y]);return{...s,...{x:e,y:n,viewport:c,coordinate:u,layer:l}}}_resizeBuffer(){var n,r;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const i=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=i}const{canvas:e}=this.device.getCanvasContext();(n=this.pickingFBO)==null||n.resize({width:e.width,height:e.height}),(r=this.depthFBO)==null||r.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:h}){const f=this.device.canvasContext.cssToDeviceRatio(),p=this._getPickable(e);if(!p||r.length===0)return{result:[],emptyInfo:sT({viewports:r,x:i,y:s,pixelRatio:f})};this._resizeBuffer();const T=this.device.canvasContext.cssToDevicePixels([i,s],!0),v=[T.x+Math.floor(T.width/2),T.y+Math.floor(T.height/2)],S=Math.round(o*f),{width:m,height:g}=this.pickingFBO,y=this._getPickingRect({deviceX:v[0],deviceY:v[1],deviceRadius:S,deviceWidth:m,deviceHeight:g}),R={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let P;const I=[],k=new Set;for(let N=0;N<a;N++){let F;if(y){const H=this._drawAndSample({layers:p,views:n,viewports:r,onViewportActive:u,deviceRect:y,cullRect:R,effects:h,pass:`picking:${l}`});F=Lx({...H,deviceX:v[0],deviceY:v[1],deviceRadius:S,deviceRect:y})}else F={pickedColor:null,pickedObjectIndex:-1};let O;if(F.pickedLayer&&c&&this.depthFBO){const{pickedColors:H}=this._drawAndSample({layers:[F.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:F.pickedX,y:F.pickedY,width:1,height:1},cullRect:R,effects:h,pass:`picking:${l}:z`},!0);H[3]&&(O=H[0])}F.pickedLayer&&N+1<a&&(k.add(F.pickedLayer),F.pickedLayer.disablePickingIndex(F.pickedObjectIndex)),P=zx({pickInfo:F,lastPickedInfo:this.lastPickedInfo,mode:l,layers:p,viewports:r,x:i,y:s,z:O,pixelRatio:f});for(const H of P.values())H.layer&&I.push(H);if(!F.pickedColor)break}for(const N of k)N.restorePickingColors();return{result:I,emptyInfo:P.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:h}){const f=this._getPickable(e);if(!f||r.length===0)return[];this._resizeBuffer();const p=this.device.canvasContext.cssToDeviceRatio(),T=this.device.canvasContext.cssToDevicePixels([i,s],!0),v=T.x,S=T.y+T.height,m=this.device.canvasContext.cssToDevicePixels([i+o,s+a],!0),g=m.x+m.width,y=m.y,R={x:v,y,width:g-v,height:S-y},P=this._drawAndSample({layers:f,views:n,viewports:r,onViewportActive:u,deviceRect:R,cullRect:{x:i,y:s,width:o,height:a},effects:h,pass:`picking:${l}`}),I=Vx(P),k=new Map,N=[],F=Number.isFinite(c);for(let O=0;O<I.length&&!(F&&N.length>=c);O++){const H=I[O];let W={color:H.pickedColor,layer:null,index:H.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:p};W=oT({layer:H.pickedLayer,info:W,mode:l});const q=W.layer.id;k.has(q)||k.set(q,new Set);const K=k.get(q),We=W.object??W.index;K.has(We)||(K.add(We),N.push(W))}return N}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,h={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{}};for(const g of a)g.useInPicking&&(h.preRenderStats[g.id]=g.preRender(h));const{decodePickingColor:f}=this.pickLayersPass.render(h),{x:p,y:T,width:v,height:S}=s,m=new(c?Float32Array:Uint8Array)(v*S*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:p,sourceY:T,sourceWidth:v,sourceHeight:S,target:m}),{pickedColors:m,decodePickingColor:f}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const Wx={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},$x="top-left",P_="__root";class Xx{constructor({deck:e,parentElement:n}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!It(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(n=>n.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const n={};for(const r of this.resolvedWidgets)n[r.id]=r;this.resolvedWidgets.length=0;for(const r of this.defaultWidgets)n[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){const i=n[r.id];i?i.viewId!==r.viewId||i.placement!==r.placement?(this._remove(i),this._add(r)):r!==i&&(i.setProps(r.props),r=i):this._add(r),n[r.id]=null,this.resolvedWidgets.push(r)}for(const r in n){const i=n[r];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:n=null,placement:r=$x}=e,i=e.onAdd({deck:this.deck,viewId:n});i&&this._getContainer(n,r).append(i),e._element=i}_remove(e){e.onRemove(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,n){var o;const r=e||P_;let i=this.containers[r];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",(o=this.parentElement)==null||o.append(i),this.containers[r]=i);let s=i.querySelector(`.${n}`);return s||(s=document.createElement("div"),s.className=n,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,Wx[n]),i.append(s)),s}_updateContainers(){const e=this.deck.width,n=this.deck.height;for(const r in this.containers){const i=this.lastViewports[r]||null,s=r===P_||i,o=this.containers[r];s?(o.style.display="block",o.style.left=`${i?i.x:0}px`,o.style.top=`${i?i.y:0}px`,o.style.width=`${i?i.width:e}px`,o.style.height=`${i?i.height:n}px`):o.style.display="none"}}onRedraw({viewports:e,layers:n}){var s,o;const r=e.reduce((a,l)=>(a[l.id]=l,a),{}),{lastViewports:i}=this;for(const a of this.getWidgets()){const{viewId:l}=a;if(l){const c=r[l];c&&(a.onViewportChange&&!c.equals(i[l])&&a.onViewportChange(c),(s=a.onRedraw)==null||s.call(a,{viewports:[c],layers:n}))}else{if(a.onViewportChange)for(const c of e)c.equals(i[c.id])||a.onViewportChange(c);(o=a.onRedraw)==null||o.call(a,{viewports:e,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,n){var r,i;for(const s of this.getWidgets()){const{viewId:o}=s;(!o||o===((r=e.viewport)==null?void 0:r.id))&&((i=s.onHover)==null||i.call(s,e,n))}}onEvent(e,n){var i,s;const r=Lh[n.type];if(r)for(const o of this.getWidgets()){const{viewId:a}=o;(!a||a===((i=e.viewport)==null?void 0:i.id))&&((s=o[r.handler])==null||s.call(o,e,n))}}}const Yx={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Kx{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,Yx),this.deck=e,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var n;this.isVisible&&e.id===((n=this.lastViewport)==null?void 0:n.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:n}=this,r=n&&n.props.getTooltip;if(!r)return;const i=r(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,n,r){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${n}px, ${r}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var li;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(li||(li={}));const vd={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Se=(t,e,n)=>e?t.enable(n):t.disable(n),x_=(t,e,n)=>t.hint(n,e),nt=(t,e,n)=>t.pixelStorei(n,e),I_=(t,e,n)=>{const r=n===36006?36009:36008;return t.bindFramebuffer(r,e)},cs=(t,e,n)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];t.bindBuffer(i,e)};function pu(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const qx={3042:Se,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Se,2885:(t,e)=>t.cullFace(e),2929:Se,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Se,35723:x_,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>{var n;return(n=t.bindTransformFeedback)==null?void 0:n.call(t,36386,e)},34229:(t,e)=>t.bindVertexArray(e),36006:I_,36010:I_,34964:cs,36662:cs,36663:cs,35053:cs,35055:cs,2886:(t,e)=>t.frontFace(e),33170:x_,2849:(t,e)=>t.lineWidth(e),32823:Se,32824:"polygonOffset",10752:"polygonOffset",35977:Se,32926:Se,32928:Se,32938:"sampleCoverage",32939:"sampleCoverage",3089:Se,3088:(t,e)=>t.scissor(...e),2960:Se,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:Se,10754:Se,12288:Se,12289:Se,12290:Se,12291:Se,12292:Se,12293:Se,12294:Se,12295:Se,3333:nt,3317:nt,37440:nt,37441:nt,37443:nt,3330:nt,3332:nt,3331:nt,3314:nt,32878:nt,3316:nt,3315:nt,32877:nt,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const n=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...n)},blendFunc:(t,e)=>{const n=(e==null?void 0:e.length)===2?[...e,...e]:e;t.blendFuncSeparate(...n)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=pu(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=pu(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=pu(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function ye(t,e,n){return e[t]!==void 0?e[t]:n[t]}const Zx={blendEquation:(t,e,n)=>t.blendEquationSeparate(ye(32777,e,n),ye(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ye(32969,e,n),ye(32968,e,n),ye(32971,e,n),ye(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ye(32824,e,n),ye(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ye(32938,e,n),ye(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ye(2962,e,n),ye(2967,e,n),ye(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ye(34816,e,n),ye(36003,e,n),ye(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ye(2964,e,n),ye(2965,e,n),ye(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ye(34817,e,n),ye(34818,e,n),ye(34819,e,n))},M_={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,n)=>t({36007:n}),bindTransformFeedback:(t,e,n)=>t({36389:n}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},bindBuffer:(t,e,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?t({[r]:n}):{valueChanged:!0}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},Vt=(t,e)=>t.isEnabled(e),k_={3042:Vt,2884:Vt,2929:Vt,3024:Vt,32823:Vt,32926:Vt,32928:Vt,3089:Vt,2960:Vt,35977:Vt},Qx=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function $i(t,e){if(Gx(e))return;const n={};for(const i in e){const s=Number(i),o=qx[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=Zx[i];s(t,e,r)}}function aT(t,e=vd){if(typeof e=="number"){const i=e,s=k_[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=k_[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function Jx(t){$i(t,vd)}function Gx(t){for(const e in t)return!1;return!0}function eI(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class tI{constructor(e,{copyState:n=!1,log:r=()=>{}}={}){d(this,"gl");d(this,"program",null);d(this,"stateStack",[]);d(this,"enable",!0);d(this,"cache");d(this,"log");this.gl=e,this.cache=n?aT(e):Object.assign({},vd),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){le(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];$i(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){le(s!==void 0);const o=e[s],a=this.cache[s];eI(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function xr(t){return t.state}function lT(t,e){const{enable:n=!0,copyState:r}=e;if(le(r!==void 0),!t.state){t.state=new tI(t,{copyState:r}),rI(t);for(const s in M_){const o=M_[s];nI(t,s,o)}N_(t,"getParameter"),N_(t,"isEnabled")}const i=xr(t);return i.enable=n,t}function oc(t){let e=xr(t);e||(lT(t,{copyState:!1}),e=xr(t)),e.push()}function ao(t){const e=xr(t);le(e),e.pop()}function N_(t,e){const n=t[e].bind(t);t[e]=function(i){if(i===void 0||Qx.has(i))return n(i);const s=xr(t);return i in s.cache||(s.cache[i]=n(i)),s.enable?s.cache[i]:n(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function nI(t,e,n){if(!t[e])return;const r=t[e].bind(t);t[e]=function(...s){const o=xr(t),{valueChanged:a,oldValue:l}=n(o._updateCache,...s);return a&&r(...s),l},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function rI(t){const e=t.useProgram.bind(t);t.useProgram=function(r){const i=xr(t);i.program!==r&&(e(r),i.program=r)}}const iI={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function sI(t,e){e={...iI,...e};let n=null;const r=s=>n=s.statusMessage||n;t.addEventListener("webglcontextcreationerror",r,!1);let i=null;if(i||(i=t.getContext("webgl2",e)),t.removeEventListener("webglcontextcreationerror",r,!1),!i)throw new Error(`Failed to create WebGL context: ${n||"Unknown error"}`);if(e.onContextLost){const{onContextLost:s}=e;t.addEventListener("webglcontextlost",o=>s(o),!1)}if(e.onContextRestored){const{onContextRestored:s}=e;t.addEventListener("webglcontextrestored",o=>s(o),!1)}return i}function Qn(t,e,n){return n[e]===void 0&&(n[e]=t.getExtension(e)||null),n[e]}function oI(t,e){const n=t.getParameter(7936),r=t.getParameter(7937);Qn(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,s=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),o=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),a=s||n,l=o||r,c=t.getParameter(7938),u=cT(a,l),h=aI(a,l),f=lI(a,l);return{type:"webgl",gpu:u,gpuType:f,gpuBackend:h,vendor:a,renderer:l,version:c,shadingLanguage:"glsl",shadingLanguageVersion:300}}function cT(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function aI(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function lI(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(cT(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function uT(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const Le="texture-compression-bc",re="texture-compression-astc",zt="texture-compression-etc2",cI="texture-compression-etc1-webgl",aa="texture-compression-pvrtc-webgl",gu="texture-compression-atc-webgl",us="float32-renderable-webgl",_u="float16-renderable-webgl",uI="rgb9e5ufloat_renderable-webgl",mu="snorm8-renderable-webgl",hs="norm16-renderable-webgl",yu="snorm16-renderable-webgl",la="float32-filterable",O_="float16-filterable-webgl",Ts="WEBGL_compressed_texture_s3tc",ws="WEBGL_compressed_texture_s3tc_srgb",ci="EXT_texture_compression_rgtc",ui="EXT_texture_compression_bptc",hI="WEBGL_compressed_texture_etc",fI="WEBGL_compressed_texture_astc",dI="WEBGL_compressed_texture_etc1",pI="WEBGL_compressed_texture_pvrtc",gI="WEBGL_compressed_texture_atc",D_="EXT_texture_norm16",F_="EXT_render_snorm",_I="EXT_color_buffer_float",Td={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[F_],"norm16-renderable-webgl":[D_],"snorm16-renderable-webgl":[D_,F_],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Ts,ws,ci,ui],"texture-compression-bc5-webgl":[ci],"texture-compression-bc7-webgl":[ui],"texture-compression-etc2":[hI],"texture-compression-astc":[fI],"texture-compression-etc1-webgl":[dI],"texture-compression-pvrtc-webgl":[pI],"texture-compression-atc-webgl":[gI]};function mI(t){return t in Td}function yI(t,e,n){return(Td[e]||[]).every(i=>Qn(t,i,n))}const ac={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:mu},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:mu},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:_u,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:hs,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:yu},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:mu},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:_u,filter:O_,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:hs},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:yu},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:us,filter:la},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:uI},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:us,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:hs},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:hs},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:us,filter:la,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:_u,filter:O_},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:hs,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:yu},"rgb32float-webgl":{gl:34837,render:us,filter:la,gl2ext:_I,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:us,filter:la,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Ts,f:Le},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:ws,f:Le},"bc1-rgba-unorm":{gl:33777,x:Ts,f:Le},"bc1-rgba-unorm-srgb":{gl:35916,x:ws,f:Le},"bc2-rgba-unorm":{gl:33778,x:Ts,f:Le},"bc2-rgba-unorm-srgb":{gl:35918,x:ws,f:Le},"bc3-rgba-unorm":{gl:33779,x:Ts,f:Le},"bc3-rgba-unorm-srgb":{gl:35919,x:ws,f:Le},"bc4-r-unorm":{gl:36283,x:ci,f:Le},"bc4-r-snorm":{gl:36284,x:ci,f:Le},"bc5-rg-unorm":{gl:36285,x:ci,f:Le},"bc5-rg-snorm":{gl:36286,x:ci,f:Le},"bc6h-rgb-ufloat":{gl:36495,x:ui,f:Le},"bc6h-rgb-float":{gl:36494,x:ui,f:Le},"bc7-rgba-unorm":{gl:36492,x:ui,f:Le},"bc7-rgba-unorm-srgb":{gl:36493,x:ui,f:Le},"etc2-rgb8unorm":{gl:37492,f:zt},"etc2-rgb8unorm-srgb":{gl:37494,f:zt},"etc2-rgb8a1unorm":{gl:37496,f:zt},"etc2-rgb8a1unorm-srgb":{gl:37497,f:zt},"etc2-rgba8unorm":{gl:37493,f:zt},"etc2-rgba8unorm-srgb":{gl:37495,f:zt},"eac-r11unorm":{gl:37488,f:zt},"eac-r11snorm":{gl:37489,f:zt},"eac-rg11unorm":{gl:37490,f:zt},"eac-rg11snorm":{gl:37491,f:zt},"astc-4x4-unorm":{gl:37808,f:re},"astc-4x4-unorm-srgb":{gl:37840,f:re},"astc-5x4-unorm":{gl:37809,f:re},"astc-5x4-unorm-srgb":{gl:37841,f:re},"astc-5x5-unorm":{gl:37810,f:re},"astc-5x5-unorm-srgb":{gl:37842,f:re},"astc-6x5-unorm":{gl:37811,f:re},"astc-6x5-unorm-srgb":{gl:37843,f:re},"astc-6x6-unorm":{gl:37812,f:re},"astc-6x6-unorm-srgb":{gl:37844,f:re},"astc-8x5-unorm":{gl:37813,f:re},"astc-8x5-unorm-srgb":{gl:37845,f:re},"astc-8x6-unorm":{gl:37814,f:re},"astc-8x6-unorm-srgb":{gl:37846,f:re},"astc-8x8-unorm":{gl:37815,f:re},"astc-8x8-unorm-srgb":{gl:37847,f:re},"astc-10x5-unorm":{gl:37819,f:re},"astc-10x5-unorm-srgb":{gl:37851,f:re},"astc-10x6-unorm":{gl:37817,f:re},"astc-10x6-unorm-srgb":{gl:37849,f:re},"astc-10x8-unorm":{gl:37818,f:re},"astc-10x8-unorm-srgb":{gl:37850,f:re},"astc-10x10-unorm":{gl:37819,f:re},"astc-10x10-unorm-srgb":{gl:37851,f:re},"astc-12x10-unorm":{gl:37820,f:re},"astc-12x10-unorm-srgb":{gl:37852,f:re},"astc-12x12-unorm":{gl:37821,f:re},"astc-12x12-unorm-srgb":{gl:37853,f:re},"pvrtc-rgb4unorm-webgl":{gl:35840,f:aa},"pvrtc-rgba4unorm-webgl":{gl:35842,f:aa},"pvrtc-rbg2unorm-webgl":{gl:35841,f:aa},"pvrtc-rgba2unorm-webgl":{gl:35843,f:aa},"etc1-rbg-unorm-webgl":{gl:36196,f:cI},"atc-rgb-unorm-webgl":{gl:35986,f:gu},"atc-rgba-unorm-webgl":{gl:35986,f:gu},"atc-rgbai-unorm-webgl":{gl:34798,f:gu}},vI={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},TI={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function wd(t,e,n){const r=ac[e];if(!r||r.gl===void 0)return!1;const i=r.x||r.gl2ext;return i?!!Qn(t,i,n):!0}function hT(t){const e=ac[t],n=e==null?void 0:e.gl;if(n===void 0)throw new Error(`Unsupported texture format ${t}`);return n}function wI(t,e,n){if(!wd(t,e,n)||e.startsWith("depth")||e.startsWith("stencil"))return!1;try{if(dv(e).signed)return!1}catch{return!1}return e.endsWith("32float")?!!Qn(t,"OES_texture_float_linear, extensions",n):e.endsWith("16float")?!!Qn(t,"OES_texture_half_float_linear, extensions",n):!0}function EI(t,e,n){return!(!wd(t,e,n)||typeof e=="number")}function vl(t){var i;const e=ac[t],n=hT(t),r=dv(t);return{format:n,dataFormat:(e==null?void 0:e.dataFormat)||AI(r.format,r.integer,r.normalized,n),type:r.dataType?uT(r.dataType):((i=e==null?void 0:e.types)==null?void 0:i[0])||5121,compressed:r.compressed}}function SI(t){const e=ac[t];if(!(e!=null&&e.attachment))throw new Error(`${t} is not a depth stencil format`);return e.attachment}function U_(t){const e=vl(t),n=vI[e.dataFormat]||4,r=TI[e.type]||1;return n*r}function AI(t,e,n,r){if(r===6408||r===6407)return r;switch(t){case"r":return e&&!n?36244:6403;case"rg":return e&&!n?33320:33319;case"rgb":return e&&!n?36248:6407;case"rgba":return e&&!n?36249:6408;default:return 6408}}const B_={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class RI extends Kb{constructor(n,r,i){super([],i);d(this,"gl");d(this,"extensions");d(this,"testedFeatures",new Set);this.gl=n,this.extensions=r,Qn(n,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const n=this.getFeatures();for(const r of n)this.has(r)&&(yield r);return[]}has(n){return this.disabledFeatures[n]?!1:(this.testedFeatures.has(n)||(this.testedFeatures.add(n),mI(n)&&yI(this.gl,n,this.extensions)&&this.features.add(n),this.getWebGLFeature(n)&&this.features.add(n)),this.features.has(n))}initializeFeatures(){const n=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of n)this.has(r)}getFeatures(){return[...Object.keys(B_),...Object.keys(Td)]}getWebGLFeature(n){const r=B_[n];return typeof r=="string"?!!Qn(this.gl,r,this.extensions):!!r}}class bI extends Yb{constructor(n){super();d(this,"gl");d(this,"limits",{});this.gl=n}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(n){return this.limits[n]===void 0&&(this.limits[n]=this.gl.getParameter(n)),this.limits[n]}}function Un(t,e,n){if(CI(e))return n(t);const{nocatch:r=!0}=e;oc(t),$i(t,e);let i;if(r)i=n(t),ao(t);else try{i=n(t)}finally{ao(t)}return i}function CI(t){for(const e in t)return!1;return!0}function PI(t,e,n,r){if(il(e))return r(t);const i=t;oc(i.gl);try{return xI(t,e),$i(i.gl,n),r(t)}finally{ao(i.gl)}}function xI(t,e){const n=t,{gl:r}=n;if(e.cullMode)switch(e.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace(Er("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const s=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=Er("provokingVertex",e.provokingVertex,{first:36429,last:36430});s==null||s.provokingVertexWEBGL(o)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const s=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=Er("polygonMode",e.polygonMode,{fill:6914,line:6913});s==null||s.polygonModeWEBGL(1028,o),s==null||s.polygonModeWEBGL(1029,o)}e.polygonOffsetLine&&r.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask(MI("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?r.enable(2929):r.disable(2929),r.depthFunc(Xh("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&B.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,s=Xh("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,s,0,i),r.stencilFuncSeparate(1029,s,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=vu("stencilPassOperation",e.stencilPassOperation),s=vu("stencilFailOperation",e.stencilFailOperation),o=vu("stencilDepthFailOperation",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,s,o,i),r.stencilOpSeparate(1029,s,o,i)}if(e.blendColorOperation||e.blendAlphaOperation){r.enable(3042);const i=L_("blendColorOperation",e.blendColorOperation||"add"),s=L_("blendAlphaOperation",e.blendAlphaOperation||"add");r.blendEquationSeparate(i,s);const o=ca("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=ca("blendColorDstFactor",e.blendColorDstFactor||"zero"),l=ca("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),c=ca("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");r.blendFuncSeparate(o,a,l,c)}}function Xh(t,e){return Er(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function vu(t,e){return Er(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function L_(t,e){return Er(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function ca(t,e){return Er(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function II(t,e){return`Illegal parameter ${e} for ${t}`}function Er(t,e,n){if(!(e in n))throw new Error(II(t,e));return n[e]}function MI(t,e){return e}function fT(t){const e={};return t.addressModeU&&(e[10242]=Tu(t.addressModeU)),t.addressModeV&&(e[10243]=Tu(t.addressModeV)),t.addressModeW&&(e[32882]=Tu(t.addressModeW)),t.magFilter&&(e[10240]=dT(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=kI(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=Xh("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function Tu(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function dT(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function kI(t,e){if(!e)return dT(t);switch(t){case"nearest":return e==="nearest"?9984:9986;case"linear":return e==="nearest"?9985:9987}}class Yn extends ge{constructor(n,r={}){super(n,r);d(this,"device");d(this,"gl");d(this,"handle");d(this,"glTarget");d(this,"glUsage");d(this,"glIndexType",5123);d(this,"byteLength");d(this,"bytesUsed");this.device=n,this.gl=this.device.gl;const i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),n.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=NI(this.props.usage),this.glUsage=OI(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(n,r=0,i=n.byteLength+r){const s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,r,n),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(n,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(n){le(n>=0);let r=n;n===0&&(r=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(null,0,n),this.trackAllocatedMemory(n),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(n,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,n),this.gl.bindBuffer(36663,null),this._setDebugData(n,r,n.byteLength)}async readAsync(n=0,r){return this.readSyncWebGL(n,r)}readSyncWebGL(n=0,r){r=r??this.byteLength-n;const i=new Uint8Array(r),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,i,s,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,n,r),i}}function NI(t){return t&ge.INDEX?34963:t&ge.VERTEX?34962:t&ge.UNIFORM?35345:34962}function OI(t){return t&ge.INDEX||t&ge.VERTEX?35044:t&ge.UNIFORM?35048:35044}class Yh extends al{constructor(n,r){super(n,r);d(this,"device");d(this,"handle");d(this,"parameters");this.device=n,this.parameters=fT(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(n){for(const[r,i]of Object.entries(n)){const s=Number(r);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}}class hi extends sl{constructor(n,r){super(n,{...gt.defaultProps,...r});d(this,"device");d(this,"gl");d(this,"handle");d(this,"texture");this.device=n,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const DI={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0},Bs=class Bs extends gt{constructor(n,r){var i;super(n,{...DI,format:"rgba8unorm",...r});d(this,"MAX_ATTRIBUTES");d(this,"device");d(this,"gl");d(this,"handle");d(this,"sampler");d(this,"view");d(this,"glFormat");d(this,"type");d(this,"dataFormat");d(this,"mipmaps");d(this,"target");d(this,"textureUnit");d(this,"loaded",!1);d(this,"_video");this.device=n,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=FI(this.props),this.loaded=!1,typeof((i=this.props)==null?void 0:i.data)=="string"&&Object.assign(this.props,{data:D3(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(n){return new hi(this.device,{...n,texture:this})}initialize(n={}){if(this.props.dimension==="cube")return this.initializeCube(n);let r=n.data;if(r instanceof Promise)return r.then(m=>this.initialize(Object.assign({},n,{pixels:m,data:m}))),this;const i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(i&&r.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,r.addEventListener("loadeddata",()=>this.initialize(n)),this;const{parameters:s={}}=n,{pixels:o=null,pixelStore:a={},textureUnit:l=void 0,mipmaps:c=!0}=n;r||(r=o);let{width:u,height:h,dataFormat:f,type:p,compressed:T=!1}=n;const{depth:v=0}=n,S=hT(n.format);return{width:u,height:h,compressed:T,dataFormat:f,type:p}=this._deduceParameters({format:n.format,type:p,dataFormat:f,compressed:T,data:r,width:u,height:h}),this.width=u,this.height=h,this.glFormat=S,this.type=p,this.dataFormat=f,this.textureUnit=l,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=c,this.setImageData({data:r,width:u,height:h,depth:v,format:n.format,type:p,dataFormat:f,parameters:a,compressed:T}),this.setSampler(n.sampler),this._setSamplerParameters(s),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),c&&this.device.isTextureFormatFilterable(n.format)&&this.generateMipmap(),i&&(this._video={video:r,parameters:s,lastTime:r.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?r.currentTime:-1}),this}initializeCube(n){const{mipmaps:r=!0,parameters:i={}}=n;return this.setCubeMapImageData(n).then(()=>{this.loaded=!0,r&&this.generateMipmap(n),this.setSampler(n.sampler),this._setSamplerParameters(i)}),this}setSampler(n={}){let r;n instanceof Yh?(this.sampler=n,r=n.props):(this.sampler=new Yh(this.device,n),r=n);const i=fT(r);return this._setSamplerParameters(i),this}resize(n){const{height:r,width:i,mipmaps:s=!1}=n;return i!==this.width||r!==this.height?this.initialize({width:i,height:r,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:s}):this}update(){if(this._video){const{video:n,parameters:r,lastTime:i}=this._video;if(i===n.currentTime||n.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:n,parameters:r}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=n.currentTime}}generateMipmap(n={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Un(this.gl,n,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(n){if(this.props.dimension==="3d"||this.props.dimension==="2d-array")return this.setImageData3D(n);this.trackDeallocatedMemory("Texture");const{target:r=this.target,pixels:i=null,level:s=0,glFormat:o=this.glFormat,offset:a=0,parameters:l={}}=n;let{data:c=null,type:u=this.type,width:h=this.width,height:f=this.height,dataFormat:p=this.dataFormat,compressed:T=!1}=n;c||(c=i),{type:u,dataFormat:p,compressed:T,width:h,height:f}=this._deduceParameters({format:this.props.format,type:u,dataFormat:p,compressed:T,data:c,width:h,height:f});const{gl:v}=this;v.bindTexture(this.target,this.handle);let S=null;if({data:c,dataType:S}=this._getDataType({data:c,compressed:T}),Un(this.gl,l,()=>{switch(S){case"null":v.texImage2D(r,s,o,h,f,0,p,u,c);break;case"typed-array":v.texImage2D(r,s,o,h,f,0,p,u,c,a);break;case"buffer":this.device.gl.bindBuffer(35052,c.handle||c),this.device.gl.texImage2D(r,s,o,h,f,0,p,u,a),this.device.gl.bindBuffer(35052,null);break;case"browser-object":v.texImage2D(r,s,o,h,f,0,p,u,c);break;case"compressed":for(const[m,g]of c.entries())v.compressedTexImage2D(r,m,g.format,g.width,g.height,0,g.data);break;default:le(!1,"Unknown image data type")}}),c&&c.byteLength)this.trackAllocatedMemory(c.byteLength,"Texture");else{const m=U_(this.props.format);this.trackAllocatedMemory(this.width*this.height*m,"Texture")}return this.loaded=!0,this}setSubImageData({target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:c=0,glFormat:u=this.glFormat,type:h=this.type,dataFormat:f=this.dataFormat,compressed:p=!1,offset:T=0,parameters:v={}}){if({type:h,dataFormat:f,compressed:p,width:a,height:l}=this._deduceParameters({format:this.props.format,type:h,dataFormat:f,compressed:p,data:i,width:a,height:l}),le(this.depth===1,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const S=i;i=S.data,a=S.shape[0],l=S.shape[1]}i instanceof Yn&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Un(this.gl,v,()=>{p?this.gl.compressedTexSubImage2D(n,c,s,o,a,l,u,i):i===null?this.gl.texSubImage2D(n,c,s,o,a,l,f,h,null):ArrayBuffer.isView(i)?this.gl.texSubImage2D(n,c,s,o,a,l,f,h,i,T):typeof WebGLBuffer<"u"&&i instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,i),this.device.gl.texSubImage2D(n,c,s,o,a,l,f,h,T),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(n,c,s,o,a,l,f,h,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(n={}){return B.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(n=this.textureUnit){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.target,this.handle),n}unbind(n=this.textureUnit){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.target,null),n}_getDataType({data:n,compressed:r=!1}){return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof Yn?{data:n.handle,dataType:"buffer"}:typeof WebGLBuffer<"u"&&n instanceof WebGLBuffer?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(n){const{format:r,data:i}=n;let{width:s,height:o,dataFormat:a,type:l,compressed:c}=n;const u=vl(r);return a=a||u.dataFormat,l=l||u.type,c=c||u.compressed,{width:s,height:o}=this._deduceImageSize(i,s,o),{dataFormat:a,type:l,compressed:c,width:s,height:o,format:r,data:i}}_deduceImageSize(n,r,i){let s;return typeof ImageData<"u"&&n instanceof ImageData?s={width:n.width,height:n.height}:typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement?s={width:n.naturalWidth,height:n.naturalHeight}:typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement?s={width:n.width,height:n.height}:typeof ImageBitmap<"u"&&n instanceof ImageBitmap?s={width:n.width,height:n.height}:typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?s={width:n.videoWidth,height:n.videoHeight}:n?s={width:r,height:i}:s={width:r>=0?r:1,height:i>=0?i:1},le(s,"Could not deduced texture size"),le(r===void 0||s.width===r,"Deduced texture width does not match supplied width"),le(i===void 0||s.height===i,"Deduced texture height does not match supplied height"),s}async setCubeMapImageData(n){const{gl:r}=this,{width:i,height:s,pixels:o,data:a,format:l=6408,type:c=5121}=n,u=o||a,h=await Promise.all(Bs.FACES.map(f=>{const p=u[f];return Promise.all(Array.isArray(p)?p:[p])}));this.bind(),Bs.FACES.forEach((f,p)=>{h[p].length>1&&this.props.mipmaps!==!1&&B.warn(`${this.id} has mipmap and multiple LODs.`)(),h[p].forEach((T,v)=>{i&&s?r.texImage2D(f,v,l,i,s,0,l,c,T):r.texImage2D(f,v,l,l,c,T)})}),this.unbind()}setImageDataForFace(n){const{face:r,width:i,height:s,pixels:o,data:a,format:l=6408,type:c=5121}=n,{gl:u}=this,h=o||a;return this.bind(),h instanceof Promise?h.then(f=>this.setImageDataForFace(Object.assign({},n,{face:r,data:f,pixels:f}))):this.width||this.height?u.texImage2D(r,0,l,i,s,0,l,c,h):u.texImage2D(r,0,l,l,c,h),this}setImageData3D(n){const{level:r=0,dataFormat:i,format:s,type:o,width:a,height:l,depth:c=1,offset:u=0,data:h,parameters:f={}}=n;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);const p=vl(s);if(Un(this.gl,f,()=>{ArrayBuffer.isView(h)&&this.gl.texImage3D(this.target,r,p.format,a,l,c,0,p.dataFormat,p.type,h),h instanceof Yn&&(this.gl.bindBuffer(35052,h.handle),this.gl.texImage3D(this.target,r,i,a,l,c,0,s,o,u))}),h&&h.byteLength)this.trackAllocatedMemory(h.byteLength,"Texture");else{const T=U_(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*T,"Texture")}return this.loaded=!0,this}_setSamplerParameters(n){if(!il(n)){UI(n),this.gl.bindTexture(this.target,this.handle);for(const[r,i]of Object.entries(n)){const s=Number(r),o=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.target,s,o);break;default:this.gl.texParameteri(this.target,s,o);break}}this.gl.bindTexture(this.target,null)}}};d(Bs,"FACES",[34069,34070,34071,34072,34073,34074]);let Kt=Bs;function FI(t){switch(t.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;case"1d":case"cube-array":default:throw new Error(t.dimension)}}function UI(t){B.log(1,"texture sampler parameters",t)()}class Ns extends ll{constructor(n,r){super(n,r);d(this,"device");d(this,"gl");d(this,"handle");const i=r.handle===null;if(this.device=n,this.gl=n.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),!i){n.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();const s=this.gl.bindFramebuffer(36160,this.handle);for(let o=0;o<this.colorAttachments.length;++o){const a=this.colorAttachments[o],l=36064+o;a&&this._attachOne(l,a)}if(this.depthStencilAttachment&&this._attachOne(SI(this.depthStencilAttachment.props.format),this.depthStencilAttachment),r.check!==!1){const o=this.gl.checkFramebufferStatus(36160);if(o!==36053)throw new Error(`Framebuffer ${LI(o)}`)}this.gl.bindFramebuffer(36160,s)}}get texture(){return this.colorAttachments[0]}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(n){return new Kt(this.device,{id:`${this.id}-depth-stencil`,format:n,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(n,r){if(this.handle===null)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight);for(const i of this.colorAttachments)i.texture.resize({width:n,height:r});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:n,height:r}),this}_attachOne(n,r){if(Array.isArray(r)){const[i,s=0,o=0]=r;return this._attachTexture(n,i,s,o),i}if(r instanceof Kt)return this._attachTexture(n,r,0,0),r;if(r instanceof hi){const i=r;return this._attachTexture(n,i.texture,i.props.baseMipLevel,i.props.baseArrayLayer),r.texture}throw new Error("attach")}_attachTexture(n,r,i,s){const{gl:o}=this.device;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:o.framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const a=BI(i);o.framebufferTexture2D(36160,n,a,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:le(!1,"Illegal texture type")}o.bindTexture(r.target,null)}}function BI(t){return t<34069?t+34069:t}function LI(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class VI extends ud{constructor(n,r){super(r);d(this,"device");d(this,"presentationSize");d(this,"_framebuffer",null);this.device=n,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Ns(this.device,{handle:null}),this._framebuffer}update(){const n=this.getPixelSize();(n[0]!==this.presentationSize[0]||n[1]!==this.presentationSize[1])&&(this.presentationSize=n,this.resize())}resize(n){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(n==null?void 0:n.useDevicePixels);this.setDevicePixelRatio(r,n);return}}commit(){}}const zI={spector:B.get("spector")||B.get("spectorjs")},jI="https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",HI=1;let ie=null,V_=!1;async function WI(t){if(!globalThis.SPECTOR)try{await wv(jI)}catch(e){B.warn(String(e))}}function $I(t){if(t={...zI,...t},!(t!=null&&t.spector)||(!ie&&globalThis.SPECTOR&&(B.probe(HI,"SPECTOR found and initialized")(),ie=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=ie)),!ie))return null;if(V_||(V_=!0,ie.spyCanvases(),ie==null||ie.onCaptureStarted.add(e=>B.info("Spector capture started:",e)()),ie==null||ie.onCapture.add(e=>{B.info("Spector capture complete:",e)(),ie==null||ie.getResultUI(),ie==null||ie.resultView.display(),ie==null||ie.resultView.addCapture(e)})),t!=null&&t.canvas){if(typeof t.spector=="string"&&t.spector!==t.canvas.id)return ie;ie==null||ie.startCapture(t==null?void 0:t.canvas,500),new Promise(e=>setTimeout(e,2e3)).then(e=>{B.info("Spector capture stopped after 2 seconds")(),ie==null||ie.stopCapture()})}return ie}const XI="https://unpkg.com/webgl-debug@2.0.1/index.js";function pT(t){return t.luma=t.luma||{},t.luma}async function YI(){tr()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await wv(XI))}function KI(t,e={}){return t?e.debug?ZI(t,e):qI(t):null}function qI(t){const e=pT(t);return e.realContext?e.realContext:t}function ZI(t,e){if(!globalThis.WebGLDebugUtils)return B.warn("webgl-debug not loaded")(),t;const n=pT(t);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...li,...t});const r=globalThis.WebGLDebugUtils.makeDebugContext(t,QI.bind(null,e),JI.bind(null,e));for(const o in li)!(o in r)&&typeof li[o]=="number"&&(r[o]=li[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=t,n.debugContext=s,s.debug=!0,s}function wu(t,e){e=Array.from(e).map(r=>r===void 0?"undefined":r);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${t}(${n})`}function QI(t,e,n,r){r=Array.from(r).map(a=>a===void 0?"undefined":a);const i=globalThis.WebGLDebugUtils.glEnumToString(e),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),o=`${i} in gl.${n}(${s})`;B.error(o)();debugger;if(t.throwOnError)throw new Error(o)}function JI(t,e,n){let r="";if(B.level>=1&&(r=wu(e,n),B.log(1,r)()),t.break&&t.break.length>0&&(r=r||wu(e,n),t.break.every(s=>r.indexOf(s)!==-1)))debugger;for(const i of n)if(i===void 0){if(r=r||wu(e,n),t.throwOnError)throw new Error(`Undefined argument: ${r}`);B.error(`Undefined argument: ${r}`)();debugger}}function GI(t){const e=t.split(/\r?\n/),n=[];for(const r of e){if(r.length<=1)continue;const i=r.split(":");if(i.length===2){const[h,f]=i;n.push({message:f.trim(),type:z_(h),lineNum:0,linePos:0});continue}const[s,o,a,...l]=i;let c=parseInt(a,10);isNaN(c)&&(c=0);let u=parseInt(o,10);isNaN(u)&&(u=0),n.push({message:l.join(":").trim(),type:z_(s),lineNum:c,linePos:u})}return n}function z_(t){const e=["warning","error","info"],n=t.toLowerCase();return e.includes(n)?n:"info"}class eM extends ol{constructor(n,r){super(n,r);d(this,"device");d(this,"handle");switch(this.device=n,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const n=this.device.gl.getShaderInfoLog(this.handle);return GI(n)}getTranslatedSource(){const r=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return r==null?void 0:r.getTranslatedShaderSource(this.handle)}async _compile(n){n=(s=>s.startsWith("#version ")?s:`#version 100
${s}`)(n);const{gl:i}=this.device;if(i.shaderSource(this.handle,n),i.compileShader(this.handle),B.level===0){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}B.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),B.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await n(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}const tM=256,nM=1024,rM=16384,Eu=6144,iM=[1,2,4,8];class sM extends Ch{constructor(n,r){super(n,r);d(this,"device");d(this,"glParameters");this.device=n,oc(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){ao(this.device.gl)}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}setParameters(n={}){const r={...this.glParameters};this.props.framebuffer&&(r.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,n.viewport&&(n.viewport.length>=6?(r.viewport=n.viewport.slice(0,4),r.depthRange=[n.viewport[4],n.viewport[5]]):r.viewport=n.viewport),n.scissorRect&&(r.scissorTest=!0,r.scissor=n.scissorRect),n.blendConstant&&(r.blendColor=n.blendConstant),n.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),n[2967]=n.stencilReference),n.colorMask&&(r.colorMask=iM.map(i=>!!(i&n.colorMask))),this.glParameters=r,$i(this.device.gl,r)}beginOcclusionQuery(n){const r=this.props.occlusionQuerySet;r==null||r.beginOcclusionQuery()}endOcclusionQuery(){const n=this.props.occlusionQuerySet;n==null||n.endOcclusionQuery()}clear(){const n={...this.glParameters};let r=0;this.props.clearColor!==!1&&(r|=rM,n.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=tM,n.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=nM,n.clearStencil=this.props.clearStencil),r!==0&&Un(this.device.gl,n,()=>{this.device.gl.clear(r)})}clearColorBuffer(n=0,r=[0,0,0,0]){Un(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int32Array:this.device.gl.clearBufferiv(Eu,n,r);break;case Uint32Array:this.device.gl.clearBufferuiv(Eu,n,r);break;case Float32Array:default:this.device.gl.clearBufferfv(Eu,n,r);break}})}}const oM="Failed to deduce GL constant from typed array";function aM(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(oM)}}function Kh(t,e){const{clamped:n=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}const lM={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},cM={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Os{constructor(...e){d(this,"offset");d(this,"stride");d(this,"type");d(this,"size");d(this,"divisor");d(this,"normalized");d(this,"integer");d(this,"buffer");d(this,"index");e.forEach(n=>this._assign(n)),Object.freeze(this)}static getBytesPerElement(e){return Kh(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return le(e.size),Kh(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new Os(lM,...e)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Os.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Os.getBytesPerVertex(this)}_assign(e={}){return e=N3("Accessor",e,cM),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalize!==void 0&&(this.normalized=e.normalize),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this.offset===void 0&&delete this.offset,this.stride===void 0&&delete this.stride,this.type===void 0&&delete this.type,this.size===void 0&&delete this.size,this.divisor===void 0&&delete this.divisor,this.normalized===void 0&&delete this.normalized,this.integer===void 0&&delete this.integer,this.buffer===void 0&&delete this.buffer,this.index===void 0&&delete this.index,this}}function uM(t){return hM.includes(t)}const hM=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],gT={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function _T(t){const e=gT[t];if(!e)throw new Error("uniform");const[n,r,,i]=e;return{format:i,components:r,glType:n}}function fM(t){const e=gT[t];if(!e)throw new Error("attribute");const[,n,,r,i]=e;return{attributeType:r,vertexFormat:i,components:n}}function dM(t,e){const n={attributes:[],bindings:[]};n.attributes=pM(t,e);const r=mM(t,e);for(const a of r){const l=a.uniforms.map(c=>({name:c.name,format:c.format,byteOffset:c.byteOffset,byteStride:c.byteStride,arrayLength:c.arrayLength}));n.bindings.push({type:"uniform",name:a.name,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:l})}const i=_M(t,e);let s=0;for(const a of i)if(uM(a.type)){const{viewDimension:l,sampleType:c}=vM(a.type);n.bindings.push({type:"texture",name:a.name,location:s,viewDimension:l,sampleType:c}),a.textureUnit=s,s+=1}i.length&&(n.uniforms=i);const o=gM(t,e);return o!=null&&o.length&&(n.varyings=o),n}function pM(t,e){const n=[],r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a}=s,l=t.getAttribLocation(e,o);if(l>=0){const{attributeType:c}=fM(a),u=/instance/i.test(o)?"instance":"vertex";n.push({name:o,location:l,stepMode:u,type:c})}}return n.sort((i,s)=>i.location-s.location),n}function gM(t,e){const n=[],r=t.getProgramParameter(e,35971);for(let i=0;i<r;i++){const s=t.getTransformFeedbackVarying(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a,size:l}=s,{glType:c,components:u}=_T(a),h=new Os({type:c,size:l*u}),f={location:i,name:o,accessor:h};n.push(f)}return n.sort((i,s)=>i.location-s.location),n}function _M(t,e){const n=[],r=t.getProgramParameter(e,35718);for(let i=0;i<r;i++){const s=t.getActiveUniform(e,i);if(!s)throw new Error("activeInfo");const{name:o,size:a,type:l}=s,{name:c,isArray:u}=TM(o);let h=t.getUniformLocation(e,c);const f={location:h,name:c,size:a,type:l,isArray:u};if(n.push(f),f.size>1)for(let p=0;p<f.size;p++){const T=`${c}[${p}]`;h=t.getUniformLocation(e,T);const v={...f,name:T,location:h};n.push(v)}}return n}function mM(t,e){const n=(s,o)=>t.getActiveUniformBlockParameter(e,s,o),r=[],i=t.getProgramParameter(e,35382);for(let s=0;s<i;s++){const o={name:t.getActiveUniformBlockName(e,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},a=n(s,35395)||[],l=t.getActiveUniforms(e,a,35383),c=t.getActiveUniforms(e,a,35384),u=t.getActiveUniforms(e,a,35387),h=t.getActiveUniforms(e,a,35388);for(let f=0;f<o.uniformCount;++f){const p=t.getActiveUniform(e,a[f]);if(!p)throw new Error("activeInfo");o.uniforms.push({name:p.name,format:_T(l[f]).format,type:l[f],arrayLength:c[f],byteOffset:u[f],byteStride:h[f]})}r.push(o)}return r.sort((s,o)=>s.location-o.location),r}const yM={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function vM(t){const e=yM[t];if(!e)throw new Error("sampler");const[n,r]=e;return{viewDimension:n,sampleType:r}}function TM(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const n=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:n[1],length:n[2]?1:0,isArray:!!n[2]}}function wM(t,e,n,r){const i=t;let s=r;s===!0&&(s=1),s===!1&&(s=0);const o=typeof s=="number"?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,r);case 5126:return t.uniform1fv(e,o);case 35664:return t.uniform2fv(e,o);case 35665:return t.uniform3fv(e,o);case 35666:return t.uniform4fv(e,o);case 5124:return t.uniform1iv(e,o);case 35667:return t.uniform2iv(e,o);case 35668:return t.uniform3iv(e,o);case 35669:return t.uniform4iv(e,o);case 35670:return t.uniform1iv(e,o);case 35671:return t.uniform2iv(e,o);case 35672:return t.uniform3iv(e,o);case 35673:return t.uniform4iv(e,o);case 5125:return i.uniform1uiv(e,o,1);case 36294:return i.uniform2uiv(e,o,2);case 36295:return i.uniform3uiv(e,o,3);case 36296:return i.uniform4uiv(e,o,4);case 35674:return t.uniformMatrix2fv(e,!1,o);case 35675:return t.uniformMatrix3fv(e,!1,o);case 35676:return t.uniformMatrix4fv(e,!1,o);case 35685:return i.uniformMatrix2x3fv(e,!1,o);case 35686:return i.uniformMatrix2x4fv(e,!1,o);case 35687:return i.uniformMatrix3x2fv(e,!1,o);case 35688:return i.uniformMatrix3x4fv(e,!1,o);case 35689:return i.uniformMatrix4x2fv(e,!1,o);case 35690:return i.uniformMatrix4x3fv(e,!1,o)}throw new Error("Illegal uniform")}function EM(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(t)}}function SM(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"line-loop-webgl":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;case"triangle-fan-webgl":return 4;default:throw new Error(t)}}const j_=4;class AM extends Ni{constructor(n,r){super(n,r);d(this,"device");d(this,"handle");d(this,"vs");d(this,"fs");d(this,"introspectedLayout");d(this,"uniforms",{});d(this,"bindings",{});d(this,"varyings",null);d(this,"_uniformCount",0);d(this,"_uniformSetters",{});this.device=n,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:i,bufferMode:s=35981}=r;switch(i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),B.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=dM(this.device.gl,this.handle),B.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=T3(this.introspectedLayout,r.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":B.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`);break}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(n,r){for(const[i,s]of Object.entries(n)){const o=this.shaderLayout.bindings.find(a=>a.name===i)||this.shaderLayout.bindings.find(a=>a.name===`${i}Uniforms`);if(!o){const a=this.shaderLayout.bindings.map(l=>`"${l.name}"`).join(", ");r!=null&&r.disableWarnings||B.warn(`Unknown binding "${i}" in render pipeline "${this.id}", expected one of ${a}`)();continue}switch(s||B.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(s instanceof Yn)&&!(s.buffer instanceof Yn))throw new Error("buffer value");break;case"texture":if(!(s instanceof hi||s instanceof Kt||s instanceof Ns))throw new Error("texture value");break;case"sampler":B.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(o.type)}this.bindings[i]=s}}draw(n){var S;const{renderPass:r,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:o,vertexCount:a,instanceCount:l,isInstanced:c=!1,firstVertex:u=0,transformFeedback:h}=n,f=EM(s),p=!!o.indexBuffer,T=(S=o.indexBuffer)==null?void 0:S.glIndexType;if(this.linkStatus!=="success")return B.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||a===0)return B.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(a===0)return B.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),o.bindBeforeRender(r),h&&h.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const v=r;return PI(this.device,i,v.glParameters,()=>{p&&c?this.device.gl.drawElementsInstanced(f,a||0,T,u,l||0):p?this.device.gl.drawElements(f,a||0,T,u):c?this.device.gl.drawArraysInstanced(f,u,a||0,l||0):this.device.gl.drawArrays(f,u,a||0),h&&h.end()}),o.unbindAfterRender(r),!0}setUniformsWebGL(n){const{bindings:r}=hd(n);Object.keys(r).forEach(i=>{B.warn(`Unsupported value "${JSON.stringify(r[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,n)}async _linkShaders(){const{gl:n}=this.device;if(n.attachShader(this.handle,this.vs.handle),n.attachShader(this.handle,this.fs.handle),B.time(j_,`linkProgram for ${this.id}`)(),n.linkProgram(this.handle),B.timeEnd(j_,`linkProgram for ${this.id}`)(),B.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}B.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),B.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}_reportLinkStatus(n){var r;switch(n){case"success":return;default:throw this.vs.compilationStatus==="error"?(this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`)):((r=this.fs)==null?void 0:r.compilationStatus)==="error"?(this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`)):new Error(`Error during ${n}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){const{gl:n}=this.device;return n.getProgramParameter(this.handle,35714)?(n.validateProgram(this.handle),n.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await n(10)}}_areTexturesRenderable(){let n=!0;for(const[,r]of Object.entries(this.bindings))r instanceof Kt&&(r.update(),n=n&&r.loaded);return n}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:n}=this.device;n.useProgram(this.handle);let r=0,i=0;for(const s of this.shaderLayout.bindings){const o=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":const{name:a}=s,l=n.getUniformBlockIndex(this.handle,a);if(l===4294967295)throw new Error(`Invalid uniform block name ${a}`);n.uniformBlockBinding(this.handle,i,l),o instanceof Yn?n.bindBufferBase(35345,i,o.handle):n.bindBufferRange(35345,i,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),i+=1;break;case"texture":if(!(o instanceof hi||o instanceof Kt||o instanceof Ns))throw new Error("texture");let c;if(o instanceof hi)c=o.texture;else if(o instanceof Kt)c=o;else if(o instanceof Ns&&o.colorAttachments[0]instanceof hi)B.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=o.colorAttachments[0].texture;else throw new Error("No texture");n.activeTexture(33984+r),n.bindTexture(c.target,c.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(const n of this.shaderLayout.uniforms||[]){const{name:r,location:i,type:s,textureUnit:o}=n,a=this.uniforms[r]??o;a!==void 0&&wM(this.device.gl,i,s,a)}}}class RM extends xh{constructor(n){super(n,{});d(this,"device");d(this,"commands",[]);this.device=n}submitCommands(n=this.commands){for(const r of n)switch(r.name){case"copy-buffer-to-buffer":bM(this.device,r.options);break;case"copy-buffer-to-texture":CM(this.device,r.options);break;case"copy-texture-to-buffer":PM(this.device,r.options);break;case"copy-texture-to-texture":xM(this.device,r.options);break}}}function bM(t,e){const n=e.source,r=e.destination;t.gl.bindBuffer(36662,n.handle),t.gl.bindBuffer(36663,r.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function CM(t,e){throw new Error("Not implemented")}function PM(t,e){const{source:n,mipLevel:r=0,aspect:i="all",width:s=e.source.width,height:o=e.source.height,depthOrArrayLayers:a=0,origin:l=[0,0],destination:c,byteOffset:u=0,bytesPerRow:h,rowsPerImage:f}=e;if(i!=="all")throw new Error("not supported");if(r!==0||a!==0||h||f)throw new Error("not implemented");const{framebuffer:p,destroyFramebuffer:T}=mT(n);let v;try{const S=c,m=s||p.width,g=o||p.height,y=vl(p.texture.props.format),R=y.dataFormat,P=y.type;t.gl.bindBuffer(35051,S.handle),v=t.gl.bindFramebuffer(36160,p.handle),t.gl.readPixels(l[0],l[1],m,g,R,P,u)}finally{t.gl.bindBuffer(35051,null),v!==void 0&&t.gl.bindFramebuffer(36160,v),T&&p.destroy()}}function xM(t,e){const{source:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destination:o}=e;let{width:a=e.destination.width,height:l=e.destination.height}=e;const{framebuffer:c,destroyFramebuffer:u}=mT(n),[h,f]=i,[p,T,v]=s,S=t.gl.bindFramebuffer(36160,c.handle);let m=null,g;if(o instanceof Kt)m=o,a=Number.isFinite(a)?a:m.width,l=Number.isFinite(l)?l:m.height,m.bind(0),g=m.target;else throw new Error("invalid destination");switch(g){case 3553:case 34067:t.gl.copyTexSubImage2D(g,r,p,T,h,f,a,l);break;case 35866:case 32879:t.gl.copyTexSubImage3D(g,r,p,T,v,h,f,a,l);break}m&&m.unbind(),t.gl.bindFramebuffer(36160,S),u&&c.destroy()}function mT(t){if(t instanceof gt){const{width:e,height:n,id:r}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:n,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class IM extends Ph{constructor(n,r){super(n,r);d(this,"device");d(this,"commandBuffer");this.device=n,this.commandBuffer=new RM(n)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(n){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:n})}copyBufferToTexture(n){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:n})}copyTextureToBuffer(n){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:n})}copyTextureToTexture(n){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:n})}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}resolveQuerySet(n,r,i){}}class Ed extends Ih{constructor(n,r){super(n,r);d(this,"device");d(this,"handle");d(this,"buffer",null);d(this,"bufferValue",null);this.device=n,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(n){return I1()==="Chrome"}destroy(){var n;super.destroy(),this.buffer&&((n=this.buffer)==null||n.destroy()),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(n){const r=n;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(n,r){const i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:s,type:o,stride:a,offset:l,normalized:c,integer:u,divisor:h}=this._getAccessor(n);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),u?this.device.gl.vertexAttribIPointer(n,s,o,a,l):this.device.gl.vertexAttribPointer(n,s,o,c,a,l),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(n),this.device.gl.vertexAttribDivisor(n,h||0),this.attributes[n]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(n,r){this._enable(n,!1),this.attributes[n]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let n=0;n<this.maxVertexAttributes;++n){const r=this.attributes[n];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(n,r)}}_getAccessor(n){const r=this.attributeInfos[n];if(!r)throw new Error(`Unknown attribute location ${n}`);const i=uT(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(n,r=!0){const s=Ed.isConstantAttributeZeroSupported(this.device)||n!==0;(r||s)&&(n=Number(n),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(n):this.device.gl.disableVertexAttribArray(n),this.device.gl.bindVertexArray(null))}getConstantBuffer(n,r){const i=MM(r),s=i.byteLength*n,o=i.length*n;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let a=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),a=a||!kM(i,this.bufferValue),a){const l=A3(r.constructor,o);R3({target:l,source:i,start:0,count:o}),this.buffer.write(l),this.bufferValue=r}return this.buffer}}function MM(t){return Array.isArray(t)?new Float32Array(t):t}function kM(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}class NM extends Mh{constructor(n,r){super(n,r);d(this,"device");d(this,"gl");d(this,"handle");d(this,"layout");d(this,"buffers",{});d(this,"unusedBuffers",{});d(this,"bindOnUse",!0);d(this,"_bound",!1);this.device=n,this.gl=n.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(n="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(SM(n))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(n){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in n)this.setBuffer(r,n[r])})}setBuffer(n,r){const i=this._getVaryingIndex(n),{buffer:s,byteLength:o,byteOffset:a}=this._getBufferRange(r);if(i<0){this.unusedBuffers[n]=s,B.warn(`${this.id} unusedBuffers varying buffer ${n}`)();return}this.buffers[i]={buffer:s,byteLength:o,byteOffset:a},this.bindOnUse||this._bindBuffer(i,s,a,o)}getBuffer(n){if(H_(n))return this.buffers[n]||null;const r=this._getVaryingIndex(n);return r>=0?this.buffers[r]:null}bind(n=this.handle){if(typeof n!="function")return this.gl.bindTransformFeedback(36386,n),this;let r;return this._bound?r=n():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=n(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(n){if(n instanceof Yn)return{buffer:n,byteOffset:0,byteLength:n.byteLength};const{buffer:r,byteOffset:i=0,byteLength:s=n.buffer.byteLength}=n;return{buffer:r,byteOffset:i,byteLength:s}}_getVaryingIndex(n){if(H_(n))return Number(n);for(const r of this.layout.varyings)if(n===r.name)return r.location;return-1}_bindBuffers(){for(const n in this.buffers){const{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[n]);this._bindBuffer(Number(n),r,s,i)}}_unbindBuffers(){for(const n in this.buffers)this.gl.bindBufferBase(35982,Number(n),null)}_bindBuffer(n,r,i=0,s){const o=r&&r.handle;!o||s===void 0?this.gl.bindBufferBase(35982,n,o):this.gl.bindBufferRange(35982,n,o,i,s)}}function H_(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class OM extends kh{constructor(n,r){super(n,r);d(this,"device");d(this,"handle");d(this,"target",null);d(this,"_queryPending",!1);d(this,"_pollingPromise",null);if(this.device=n,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(n){return this._begin(n!=null&&n.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(n){this._queryPending||(this.target=n,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const n=this.device.gl.getQueryParameter(this.handle,34919);return n&&(this._queryPending=!1),n}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(n=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,s)=>{const o=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>n?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}function yT(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return le(!1),0}}function DM(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return le(!1),0}}function FM(t,e){var S,m;const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408,sourceAttachment:s=36064}=e||{};let{target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e||{};const{framebuffer:u,deleteFramebuffer:h}=vT(t);le(u);const{gl:f,handle:p}=u;a=a||u.width,l=l||u.height;const T=s-36064;c=c||((m=(S=u.colorAttachments[T])==null?void 0:S.texture)==null?void 0:m.type)||5121,o=LM(o,c,i,a,l),c=c||aM(o);const v=f.bindFramebuffer(36160,p);return f.readPixels(n,r,a,l,i,c,o),f.bindFramebuffer(36160,v||null),h&&u.destroy(),o}function UM(t,e){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=e||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=e||{};const{framebuffer:u,deleteFramebuffer:h}=vT(t);le(u),a=a||u.width,l=l||u.height;const f=u;c=c||5121;let p=n;if(!p){const v=yT(s),S=DM(c),m=o+a*l*v*S;p=f.device.createBuffer({byteLength:m})}const T=t.device.createCommandEncoder();return T.copyTextureToBuffer({source:t,width:a,height:l,origin:[r,i],destination:p,byteOffset:o}),T.destroy(),h&&u.destroy(),p}function vT(t){return t instanceof ll?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:BM(t),deleteFramebuffer:!0}}function BM(t,e){const{device:n,width:r,height:i,id:s}=t;return n.createFramebuffer({...e,id:`framebuffer-for-${s}`,width:r,height:i,colorAttachments:[t]})}function LM(t,e,n,r,i){if(t)return t;e=e||5121;const s=Kh(e,{clamped:!1}),o=yT(n);return new s(r*i*o)}const VM=256,zM=1024,jM=16384,HM="clear: bad arguments";function WM(t,e){const{framebuffer:n=null,color:r=null,depth:i=null,stencil:s=null}=e||{},o={};n&&(o.framebuffer=n);let a=0;r&&(a|=jM,r!==!0&&(o.clearColor=r)),i&&(a|=VM,i!==!0&&(o.clearDepth=i)),s&&(a|=zM,i!==!0&&(o.clearStencil=i)),le(a!==0,HM);const l=t.gl;Un(l,o,()=>{l.clear(a)})}const fs=1,hr=class hr extends ki{constructor(n){var l,c;super({...n,id:n.id||Dr("webgl-device")});d(this,"type","webgl");d(this,"handle");d(this,"features");d(this,"limits");d(this,"info");d(this,"canvasContext");d(this,"lost");d(this,"_resolveContextLost");d(this,"renderPass",null);d(this,"gl");d(this,"debug",!1);d(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});d(this,"_extensions",{});d(this,"_polyfilled",!1);d(this,"spectorJS");d(this,"_constants");const r=(l=n.gl)==null?void 0:l.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);const i=((c=n.gl)==null?void 0:c.canvas)||n.canvas;this.canvasContext=new VI(this,{...n,canvas:i}),this.lost=new Promise(u=>{this._resolveContextLost=u});let s=n.gl||null;if(s||(s=sI(this.canvasContext.canvas,{...n,onContextLost:u=>{var h;return(h=this._resolveContextLost)==null?void 0:h.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}})),!s)throw new Error("WebGL context creation failed");this.handle=s,this.gl=s,this.gl.device=this,this.gl._version=2,n.spector&&(this.spectorJS=$I({...this.props,canvas:this.handle.canvas})),this.info=oI(this.gl,this._extensions),this.limits=new bI(this.gl),this.features=new RI(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),this.canvasContext.resize();const{enable:o=!0,copyState:a=!1}=n;lT(this.gl,{enable:o,copyState:a,log:(...u)=>B.log(1,...u)()}),n.debug&&(this.gl=KI(this.gl,{...n,throwOnError:!0}),this.debug=!0,B.level=Math.max(B.level,1),B.warn("WebGL debug mode activated. Performance reduced.")())}static isSupported(){return typeof WebGL2RenderingContext<"u"}static attach(n){if(n instanceof hr)return n;if((n==null?void 0:n.device)instanceof ki)return n.device;if(!$M(n))throw new Error("Invalid WebGL2RenderingContext");return new hr({gl:n})}static async create(n={}){var a;B.groupCollapsed(fs,"WebGLDevice created")();const r=[];n.debug&&r.push(YI()),n.spector&&r.push(WI()),typeof n.canvas=="string"&&r.push(ud.pageLoaded);const i=await Promise.allSettled(r);for(const l of i)l.status==="rejected"&&B.error(`Failed to initialize debug libraries ${l.reason}`)();if(B.probe(fs+1,"DOM is loaded")(),(a=n.gl)!=null&&a.device)return B.warn("reattaching existing device")(),hr.attach(n.gl);const s=new hr(n),o=`Created ${s.type}${s.debug?" debug":""} context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return B.probe(fs,o)(),B.table(fs,s.info)(),B.groupEnd(fs)(),s}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(n){return wd(this.gl,n,this._extensions)}isTextureFormatFilterable(n){return wI(this.gl,n,this._extensions)}isTextureFormatRenderable(n){return EI(this.gl,n,this._extensions)}createCanvasContext(n){throw new Error("WebGL only supports a single canvas")}createBuffer(n){const r=this._getBufferProps(n);return new Yn(this,r)}_createTexture(n){return new Kt(this,n)}createExternalTexture(n){throw new Error("createExternalTexture() not implemented")}createSampler(n){return new Yh(this,n)}createShader(n){return new eM(this,n)}createFramebuffer(n){return new Ns(this,n)}createVertexArray(n){return new Ed(this,n)}createTransformFeedback(n){return new NM(this,n)}createQuerySet(n){return new OM(this,n)}createRenderPipeline(n){return new AM(this,n)}beginRenderPass(n){return new sM(this,n)}createComputePipeline(n){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(n){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(n){return new IM(this,n)}submit(){var n;(n=this.renderPass)==null||n.end(),this.renderPass=null}readPixelsToArrayWebGL(n,r){return FM(n,r)}readPixelsToBufferWebGL(n,r){return UM(n,r)}setParametersWebGL(n){$i(this.gl,n)}getParametersWebGL(n){return aT(this.gl,n)}withParametersWebGL(n,r){return Un(this.gl,n,r)}clearWebGL(n){WM(this,n)}resetWebGL(){B.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Jx(this.gl)}loseDevice(){var s;let n=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(n=!0,i.loseContext()),(s=this._resolveContextLost)==null||s.call(this,{reason:"destroyed",message:"Application triggered context loss"}),n}pushState(){oc(this.gl)}popState(){ao(this.gl)}setSpectorMetadata(n,r){n.__SPECTOR_Metadata=r}getGLKey(n,r){r=r||this.gl2||this.gl;const i=Number(n);for(const s in r)if(r[s]===i)return`GL.${s}`;return String(n)}setConstantAttributeWebGL(n,r){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const s=this._constants[n];switch(s&&qM(s,r)&&B.info(1,`setConstantAttributeWebGL(${n}) could have been skipped, value unchanged`)(),this._constants[n]=r,r.constructor){case Float32Array:XM(this,n,r);break;case Int32Array:YM(this,n,r);break;case Uint32Array:KM(this,n,r);break;default:le(!1)}}getExtension(n){return Qn(this.gl,n,this._extensions),this._extensions}};d(hr,"type","webgl");let Ds=hr;function $M(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function XM(t,e,n){switch(n.length){case 1:t.gl.vertexAttrib1fv(e,n);break;case 2:t.gl.vertexAttrib2fv(e,n);break;case 3:t.gl.vertexAttrib3fv(e,n);break;case 4:t.gl.vertexAttrib4fv(e,n);break;default:le(!1)}}function YM(t,e,n){t.gl.vertexAttribI4iv(e,n)}function KM(t,e,n){t.gl.vertexAttribI4uiv(e,n)}function qM(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}var TT={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function h(_,w,A){return setTimeout(y(_,A),w)}function f(_,w,A){return Array.isArray(_)?(p(_,A[w],A),!0):!1}function p(_,w,A){var M;if(_)if(_.forEach)_.forEach(w,A);else if(_.length!==i)for(M=0;M<_.length;)w.call(A,_[M],M,_),M++;else for(M in _)_.hasOwnProperty(M)&&w.call(A,_[M],M,_)}function T(_,w,A){var M="DEPRECATED METHOD: "+w+`
`+A+` AT 
`;return function(){var D=new Error("get-stack-trace"),z=D&&D.stack?D.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Z=e.console&&(e.console.warn||e.console.log);return Z&&Z.call(e.console,M,z),_.apply(this,arguments)}}var v;typeof Object.assign!="function"?v=function(w){if(w===i||w===null)throw new TypeError("Cannot convert undefined or null to object");for(var A=Object(w),M=1;M<arguments.length;M++){var D=arguments[M];if(D!==i&&D!==null)for(var z in D)D.hasOwnProperty(z)&&(A[z]=D[z])}return A}:v=Object.assign;var S=T(function(w,A,M){for(var D=Object.keys(A),z=0;z<D.length;)(!M||M&&w[D[z]]===i)&&(w[D[z]]=A[D[z]]),z++;return w},"extend","Use `assign`."),m=T(function(w,A){return S(w,A,!0)},"merge","Use `assign`.");function g(_,w,A){var M=w.prototype,D;D=_.prototype=Object.create(M),D.constructor=_,D._super=M,A&&v(D,A)}function y(_,w){return function(){return _.apply(w,arguments)}}function R(_,w){return typeof _==a?_.apply(w&&w[0]||i,w):_}function P(_,w){return _===i?w:_}function I(_,w,A){p(O(w),function(M){_.addEventListener(M,A,!1)})}function k(_,w,A){p(O(w),function(M){_.removeEventListener(M,A,!1)})}function N(_,w){for(;_;){if(_==w)return!0;_=_.parentNode}return!1}function F(_,w){return _.indexOf(w)>-1}function O(_){return _.trim().split(/\s+/g)}function H(_,w,A){if(_.indexOf&&!A)return _.indexOf(w);for(var M=0;M<_.length;){if(A&&_[M][A]==w||!A&&_[M]===w)return M;M++}return-1}function W(_){return Array.prototype.slice.call(_,0)}function q(_,w,A){for(var M=[],D=[],z=0;z<_.length;){var Z=_[z][w];H(D,Z)<0&&M.push(_[z]),D[z]=Z,z++}return M=M.sort(function(Me,$e){return Me[w]>$e[w]}),M}function K(_,w){for(var A,M,D=w[0].toUpperCase()+w.slice(1),z=0;z<s.length;){if(A=s[z],M=A?A+D:w,M in _)return M;z++}return i}var We=1;function vn(){return We++}function Et(_){var w=_.ownerDocument||_;return w.defaultView||w.parentWindow||e}var V=/mobile|tablet|ip(ad|hone|od)|android/i,$="ontouchstart"in e,X=K(e,"PointerEvent")!==i,Y=$&&V.test(navigator.userAgent),G="touch",he="pen",Fe="mouse",St="kinect",en=25,we=1,nr=2,Ee=4,Ze=8,Ao=1,Xi=2,Yi=4,Ki=8,qi=16,Dt=Xi|Yi,rr=Ki|qi,Md=Dt|rr,kd=["x","y"],Ro=["clientX","clientY"];function ut(_,w){var A=this;this.manager=_,this.callback=w,this.element=_.element,this.target=_.options.inputTarget,this.domHandler=function(M){R(_.options.enable,[_])&&A.handler(M)},this.init()}ut.prototype={handler:function(){},init:function(){this.evEl&&I(this.element,this.evEl,this.domHandler),this.evTarget&&I(this.target,this.evTarget,this.domHandler),this.evWin&&I(Et(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(Et(this.element),this.evWin,this.domHandler)}};function ew(_){var w,A=_.options.inputClass;return A?w=A:X?w=dc:Y?w=Po:$?w=pc:w=Co,new w(_,tw)}function tw(_,w,A){var M=A.pointers.length,D=A.changedPointers.length,z=w&we&&M-D===0,Z=w&(Ee|Ze)&&M-D===0;A.isFirst=!!z,A.isFinal=!!Z,z&&(_.session={}),A.eventType=w,nw(_,A),_.emit("hammer.input",A),_.recognize(A),_.session.prevInput=A}function nw(_,w){var A=_.session,M=w.pointers,D=M.length;A.firstInput||(A.firstInput=Nd(w)),D>1&&!A.firstMultiple?A.firstMultiple=Nd(w):D===1&&(A.firstMultiple=!1);var z=A.firstInput,Z=A.firstMultiple,Ce=Z?Z.center:z.center,Me=w.center=Od(M);w.timeStamp=u(),w.deltaTime=w.timeStamp-z.timeStamp,w.angle=fc(Ce,Me),w.distance=bo(Ce,Me),rw(A,w),w.offsetDirection=Fd(w.deltaX,w.deltaY);var $e=Dd(w.deltaTime,w.deltaX,w.deltaY);w.overallVelocityX=$e.x,w.overallVelocityY=$e.y,w.overallVelocity=c($e.x)>c($e.y)?$e.x:$e.y,w.scale=Z?ow(Z.pointers,M):1,w.rotation=Z?sw(Z.pointers,M):0,w.maxPointers=A.prevInput?w.pointers.length>A.prevInput.maxPointers?w.pointers.length:A.prevInput.maxPointers:w.pointers.length,iw(A,w);var Ut=_.element;N(w.srcEvent.target,Ut)&&(Ut=w.srcEvent.target),w.target=Ut}function rw(_,w){var A=w.center,M=_.offsetDelta||{},D=_.prevDelta||{},z=_.prevInput||{};(w.eventType===we||z.eventType===Ee)&&(D=_.prevDelta={x:z.deltaX||0,y:z.deltaY||0},M=_.offsetDelta={x:A.x,y:A.y}),w.deltaX=D.x+(A.x-M.x),w.deltaY=D.y+(A.y-M.y)}function iw(_,w){var A=_.lastInterval||w,M=w.timeStamp-A.timeStamp,D,z,Z,Ce;if(w.eventType!=Ze&&(M>en||A.velocity===i)){var Me=w.deltaX-A.deltaX,$e=w.deltaY-A.deltaY,Ut=Dd(M,Me,$e);z=Ut.x,Z=Ut.y,D=c(Ut.x)>c(Ut.y)?Ut.x:Ut.y,Ce=Fd(Me,$e),_.lastInterval=w}else D=A.velocity,z=A.velocityX,Z=A.velocityY,Ce=A.direction;w.velocity=D,w.velocityX=z,w.velocityY=Z,w.direction=Ce}function Nd(_){for(var w=[],A=0;A<_.pointers.length;)w[A]={clientX:l(_.pointers[A].clientX),clientY:l(_.pointers[A].clientY)},A++;return{timeStamp:u(),pointers:w,center:Od(w),deltaX:_.deltaX,deltaY:_.deltaY}}function Od(_){var w=_.length;if(w===1)return{x:l(_[0].clientX),y:l(_[0].clientY)};for(var A=0,M=0,D=0;D<w;)A+=_[D].clientX,M+=_[D].clientY,D++;return{x:l(A/w),y:l(M/w)}}function Dd(_,w,A){return{x:w/_||0,y:A/_||0}}function Fd(_,w){return _===w?Ao:c(_)>=c(w)?_<0?Xi:Yi:w<0?Ki:qi}function bo(_,w,A){A||(A=kd);var M=w[A[0]]-_[A[0]],D=w[A[1]]-_[A[1]];return Math.sqrt(M*M+D*D)}function fc(_,w,A){A||(A=kd);var M=w[A[0]]-_[A[0]],D=w[A[1]]-_[A[1]];return Math.atan2(D,M)*180/Math.PI}function sw(_,w){return fc(w[1],w[0],Ro)+fc(_[1],_[0],Ro)}function ow(_,w){return bo(w[0],w[1],Ro)/bo(_[0],_[1],Ro)}var aw={mousedown:we,mousemove:nr,mouseup:Ee},lw="mousedown",cw="mousemove mouseup";function Co(){this.evEl=lw,this.evWin=cw,this.pressed=!1,ut.apply(this,arguments)}g(Co,ut,{handler:function(w){var A=aw[w.type];A&we&&w.button===0&&(this.pressed=!0),A&nr&&w.which!==1&&(A=Ee),this.pressed&&(A&Ee&&(this.pressed=!1),this.callback(this.manager,A,{pointers:[w],changedPointers:[w],pointerType:Fe,srcEvent:w}))}});var uw={pointerdown:we,pointermove:nr,pointerup:Ee,pointercancel:Ze,pointerout:Ze},hw={2:G,3:he,4:Fe,5:St},Ud="pointerdown",Bd="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ud="MSPointerDown",Bd="MSPointerMove MSPointerUp MSPointerCancel");function dc(){this.evEl=Ud,this.evWin=Bd,ut.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}g(dc,ut,{handler:function(w){var A=this.store,M=!1,D=w.type.toLowerCase().replace("ms",""),z=uw[D],Z=hw[w.pointerType]||w.pointerType,Ce=Z==G,Me=H(A,w.pointerId,"pointerId");z&we&&(w.button===0||Ce)?Me<0&&(A.push(w),Me=A.length-1):z&(Ee|Ze)&&(M=!0),!(Me<0)&&(A[Me]=w,this.callback(this.manager,z,{pointers:A,changedPointers:[w],pointerType:Z,srcEvent:w}),M&&A.splice(Me,1))}});var fw={touchstart:we,touchmove:nr,touchend:Ee,touchcancel:Ze},dw="touchstart",pw="touchstart touchmove touchend touchcancel";function Ld(){this.evTarget=dw,this.evWin=pw,this.started=!1,ut.apply(this,arguments)}g(Ld,ut,{handler:function(w){var A=fw[w.type];if(A===we&&(this.started=!0),!!this.started){var M=gw.call(this,w,A);A&(Ee|Ze)&&M[0].length-M[1].length===0&&(this.started=!1),this.callback(this.manager,A,{pointers:M[0],changedPointers:M[1],pointerType:G,srcEvent:w})}}});function gw(_,w){var A=W(_.touches),M=W(_.changedTouches);return w&(Ee|Ze)&&(A=q(A.concat(M),"identifier")),[A,M]}var _w={touchstart:we,touchmove:nr,touchend:Ee,touchcancel:Ze},mw="touchstart touchmove touchend touchcancel";function Po(){this.evTarget=mw,this.targetIds={},ut.apply(this,arguments)}g(Po,ut,{handler:function(w){var A=_w[w.type],M=yw.call(this,w,A);M&&this.callback(this.manager,A,{pointers:M[0],changedPointers:M[1],pointerType:G,srcEvent:w})}});function yw(_,w){var A=W(_.touches),M=this.targetIds;if(w&(we|nr)&&A.length===1)return M[A[0].identifier]=!0,[A,A];var D,z,Z=W(_.changedTouches),Ce=[],Me=this.target;if(z=A.filter(function($e){return N($e.target,Me)}),w===we)for(D=0;D<z.length;)M[z[D].identifier]=!0,D++;for(D=0;D<Z.length;)M[Z[D].identifier]&&Ce.push(Z[D]),w&(Ee|Ze)&&delete M[Z[D].identifier],D++;if(Ce.length)return[q(z.concat(Ce),"identifier"),Ce]}var vw=2500,Vd=25;function pc(){ut.apply(this,arguments);var _=y(this.handler,this);this.touch=new Po(this.manager,_),this.mouse=new Co(this.manager,_),this.primaryTouch=null,this.lastTouches=[]}g(pc,ut,{handler:function(w,A,M){var D=M.pointerType==G,z=M.pointerType==Fe;if(!(z&&M.sourceCapabilities&&M.sourceCapabilities.firesTouchEvents)){if(D)Tw.call(this,A,M);else if(z&&ww.call(this,M))return;this.callback(w,A,M)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Tw(_,w){_&we?(this.primaryTouch=w.changedPointers[0].identifier,zd.call(this,w)):_&(Ee|Ze)&&zd.call(this,w)}function zd(_){var w=_.changedPointers[0];if(w.identifier===this.primaryTouch){var A={x:w.clientX,y:w.clientY};this.lastTouches.push(A);var M=this.lastTouches,D=function(){var z=M.indexOf(A);z>-1&&M.splice(z,1)};setTimeout(D,vw)}}function ww(_){for(var w=_.srcEvent.clientX,A=_.srcEvent.clientY,M=0;M<this.lastTouches.length;M++){var D=this.lastTouches[M],z=Math.abs(w-D.x),Z=Math.abs(A-D.y);if(z<=Vd&&Z<=Vd)return!0}return!1}var jd=K(o.style,"touchAction"),Hd=jd!==i,Wd="compute",$d="auto",gc="manipulation",ir="none",Zi="pan-x",Qi="pan-y",xo=Sw();function _c(_,w){this.manager=_,this.set(w)}_c.prototype={set:function(_){_==Wd&&(_=this.compute()),Hd&&this.manager.element.style&&xo[_]&&(this.manager.element.style[jd]=_),this.actions=_.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var _=[];return p(this.manager.recognizers,function(w){R(w.options.enable,[w])&&(_=_.concat(w.getTouchAction()))}),Ew(_.join(" "))},preventDefaults:function(_){var w=_.srcEvent,A=_.offsetDirection;if(this.manager.session.prevented){w.preventDefault();return}var M=this.actions,D=F(M,ir)&&!xo[ir],z=F(M,Qi)&&!xo[Qi],Z=F(M,Zi)&&!xo[Zi];if(D){var Ce=_.pointers.length===1,Me=_.distance<2,$e=_.deltaTime<250;if(Ce&&Me&&$e)return}if(!(Z&&z)&&(D||z&&A&Dt||Z&&A&rr))return this.preventSrc(w)},preventSrc:function(_){this.manager.session.prevented=!0,_.preventDefault()}};function Ew(_){if(F(_,ir))return ir;var w=F(_,Zi),A=F(_,Qi);return w&&A?ir:w||A?w?Zi:Qi:F(_,gc)?gc:$d}function Sw(){if(!Hd)return!1;var _={},w=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(A){_[A]=w?e.CSS.supports("touch-action",A):!0}),_}var Io=1,ht=2,Ur=4,Tn=8,tn=Tn,Ji=16,Ft=32;function nn(_){this.options=v({},this.defaults,_||{}),this.id=vn(),this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=Io,this.simultaneous={},this.requireFail=[]}nn.prototype={defaults:{},set:function(_){return v(this.options,_),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(_){if(f(_,"recognizeWith",this))return this;var w=this.simultaneous;return _=Mo(_,this),w[_.id]||(w[_.id]=_,_.recognizeWith(this)),this},dropRecognizeWith:function(_){return f(_,"dropRecognizeWith",this)?this:(_=Mo(_,this),delete this.simultaneous[_.id],this)},requireFailure:function(_){if(f(_,"requireFailure",this))return this;var w=this.requireFail;return _=Mo(_,this),H(w,_)===-1&&(w.push(_),_.requireFailure(this)),this},dropRequireFailure:function(_){if(f(_,"dropRequireFailure",this))return this;_=Mo(_,this);var w=H(this.requireFail,_);return w>-1&&this.requireFail.splice(w,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(_){return!!this.simultaneous[_.id]},emit:function(_){var w=this,A=this.state;function M(D){w.manager.emit(D,_)}A<Tn&&M(w.options.event+Xd(A)),M(w.options.event),_.additionalEvent&&M(_.additionalEvent),A>=Tn&&M(w.options.event+Xd(A))},tryEmit:function(_){if(this.canEmit())return this.emit(_);this.state=Ft},canEmit:function(){for(var _=0;_<this.requireFail.length;){if(!(this.requireFail[_].state&(Ft|Io)))return!1;_++}return!0},recognize:function(_){var w=v({},_);if(!R(this.options.enable,[this,w])){this.reset(),this.state=Ft;return}this.state&(tn|Ji|Ft)&&(this.state=Io),this.state=this.process(w),this.state&(ht|Ur|Tn|Ji)&&this.tryEmit(w)},process:function(_){},getTouchAction:function(){},reset:function(){}};function Xd(_){return _&Ji?"cancel":_&Tn?"end":_&Ur?"move":_&ht?"start":""}function Yd(_){return _==qi?"down":_==Ki?"up":_==Xi?"left":_==Yi?"right":""}function Mo(_,w){var A=w.manager;return A?A.get(_):_}function At(){nn.apply(this,arguments)}g(At,nn,{defaults:{pointers:1},attrTest:function(_){var w=this.options.pointers;return w===0||_.pointers.length===w},process:function(_){var w=this.state,A=_.eventType,M=w&(ht|Ur),D=this.attrTest(_);return M&&(A&Ze||!D)?w|Ji:M||D?A&Ee?w|Tn:w&ht?w|Ur:ht:Ft}});function ko(){At.apply(this,arguments),this.pX=null,this.pY=null}g(ko,At,{defaults:{event:"pan",threshold:10,pointers:1,direction:Md},getTouchAction:function(){var _=this.options.direction,w=[];return _&Dt&&w.push(Qi),_&rr&&w.push(Zi),w},directionTest:function(_){var w=this.options,A=!0,M=_.distance,D=_.direction,z=_.deltaX,Z=_.deltaY;return D&w.direction||(w.direction&Dt?(D=z===0?Ao:z<0?Xi:Yi,A=z!=this.pX,M=Math.abs(_.deltaX)):(D=Z===0?Ao:Z<0?Ki:qi,A=Z!=this.pY,M=Math.abs(_.deltaY))),_.direction=D,A&&M>w.threshold&&D&w.direction},attrTest:function(_){return At.prototype.attrTest.call(this,_)&&(this.state&ht||!(this.state&ht)&&this.directionTest(_))},emit:function(_){this.pX=_.deltaX,this.pY=_.deltaY;var w=Yd(_.direction);w&&(_.additionalEvent=this.options.event+w),this._super.emit.call(this,_)}});function mc(){At.apply(this,arguments)}g(mc,At,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ir]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.scale-1)>this.options.threshold||this.state&ht)},emit:function(_){if(_.scale!==1){var w=_.scale<1?"in":"out";_.additionalEvent=this.options.event+w}this._super.emit.call(this,_)}});function yc(){nn.apply(this,arguments),this._timer=null,this._input=null}g(yc,nn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[$d]},process:function(_){var w=this.options,A=_.pointers.length===w.pointers,M=_.distance<w.threshold,D=_.deltaTime>w.time;if(this._input=_,!M||!A||_.eventType&(Ee|Ze)&&!D)this.reset();else if(_.eventType&we)this.reset(),this._timer=h(function(){this.state=tn,this.tryEmit()},w.time,this);else if(_.eventType&Ee)return tn;return Ft},reset:function(){clearTimeout(this._timer)},emit:function(_){this.state===tn&&(_&&_.eventType&Ee?this.manager.emit(this.options.event+"up",_):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function vc(){At.apply(this,arguments)}g(vc,At,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ir]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.rotation)>this.options.threshold||this.state&ht)}});function Tc(){At.apply(this,arguments)}g(Tc,At,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Dt|rr,pointers:1},getTouchAction:function(){return ko.prototype.getTouchAction.call(this)},attrTest:function(_){var w=this.options.direction,A;return w&(Dt|rr)?A=_.overallVelocity:w&Dt?A=_.overallVelocityX:w&rr&&(A=_.overallVelocityY),this._super.attrTest.call(this,_)&&w&_.offsetDirection&&_.distance>this.options.threshold&&_.maxPointers==this.options.pointers&&c(A)>this.options.velocity&&_.eventType&Ee},emit:function(_){var w=Yd(_.offsetDirection);w&&this.manager.emit(this.options.event+w,_),this.manager.emit(this.options.event,_)}});function No(){nn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}g(No,nn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gc]},process:function(_){var w=this.options,A=_.pointers.length===w.pointers,M=_.distance<w.threshold,D=_.deltaTime<w.time;if(this.reset(),_.eventType&we&&this.count===0)return this.failTimeout();if(M&&D&&A){if(_.eventType!=Ee)return this.failTimeout();var z=this.pTime?_.timeStamp-this.pTime<w.interval:!0,Z=!this.pCenter||bo(this.pCenter,_.center)<w.posThreshold;this.pTime=_.timeStamp,this.pCenter=_.center,!Z||!z?this.count=1:this.count+=1,this._input=_;var Ce=this.count%w.taps;if(Ce===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=tn,this.tryEmit()},w.interval,this),ht):tn}return Ft},failTimeout:function(){return this._timer=h(function(){this.state=Ft},this.options.interval,this),Ft},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==tn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function wn(_,w){return w=w||{},w.recognizers=P(w.recognizers,wn.defaults.preset),new wc(_,w)}wn.VERSION="2.0.7",wn.defaults={domEvents:!1,touchAction:Wd,enable:!0,inputTarget:null,inputClass:null,preset:[[vc,{enable:!1}],[mc,{enable:!1},["rotate"]],[Tc,{direction:Dt}],[ko,{direction:Dt},["swipe"]],[No],[No,{event:"doubletap",taps:2},["tap"]],[yc]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Aw=1,Kd=2;function wc(_,w){this.options=v({},wn.defaults,w||{}),this.options.inputTarget=this.options.inputTarget||_,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=_,this.input=ew(this),this.touchAction=new _c(this,this.options.touchAction),qd(this,!0),p(this.options.recognizers,function(A){var M=this.add(new A[0](A[1]));A[2]&&M.recognizeWith(A[2]),A[3]&&M.requireFailure(A[3])},this)}wc.prototype={set:function(_){return v(this.options,_),_.touchAction&&this.touchAction.update(),_.inputTarget&&(this.input.destroy(),this.input.target=_.inputTarget,this.input.init()),this},stop:function(_){this.session.stopped=_?Kd:Aw},recognize:function(_){var w=this.session;if(!w.stopped){this.touchAction.preventDefaults(_);var A,M=this.recognizers,D=w.curRecognizer;(!D||D&&D.state&tn)&&(D=w.curRecognizer=null);for(var z=0;z<M.length;)A=M[z],w.stopped!==Kd&&(!D||A==D||A.canRecognizeWith(D))?A.recognize(_):A.reset(),!D&&A.state&(ht|Ur|Tn)&&(D=w.curRecognizer=A),z++}},get:function(_){if(_ instanceof nn)return _;for(var w=this.recognizers,A=0;A<w.length;A++)if(w[A].options.event==_)return w[A];return null},add:function(_){if(f(_,"add",this))return this;var w=this.get(_.options.event);return w&&this.remove(w),this.recognizers.push(_),_.manager=this,this.touchAction.update(),_},remove:function(_){if(f(_,"remove",this))return this;if(_=this.get(_),_){var w=this.recognizers,A=H(w,_);A!==-1&&(w.splice(A,1),this.touchAction.update())}return this},on:function(_,w){if(_!==i&&w!==i){var A=this.handlers;return p(O(_),function(M){A[M]=A[M]||[],A[M].push(w)}),this}},off:function(_,w){if(_!==i){var A=this.handlers;return p(O(_),function(M){w?A[M]&&A[M].splice(H(A[M],w),1):delete A[M]}),this}},emit:function(_,w){this.options.domEvents&&Rw(_,w);var A=this.handlers[_]&&this.handlers[_].slice();if(!(!A||!A.length)){w.type=_,w.preventDefault=function(){w.srcEvent.preventDefault()};for(var M=0;M<A.length;)A[M](w),M++}},destroy:function(){this.element&&qd(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function qd(_,w){var A=_.element;if(A.style){var M;p(_.options.cssProps,function(D,z){M=K(A.style,z),w?(_.oldCssProps[M]=A.style[M],A.style[M]=D):A.style[M]=_.oldCssProps[M]||""}),w||(_.oldCssProps={})}}function Rw(_,w){var A=n.createEvent("Event");A.initEvent(_,!0,!0),A.gesture=w,w.target.dispatchEvent(A)}v(wn,{INPUT_START:we,INPUT_MOVE:nr,INPUT_END:Ee,INPUT_CANCEL:Ze,STATE_POSSIBLE:Io,STATE_BEGAN:ht,STATE_CHANGED:Ur,STATE_ENDED:Tn,STATE_RECOGNIZED:tn,STATE_CANCELLED:Ji,STATE_FAILED:Ft,DIRECTION_NONE:Ao,DIRECTION_LEFT:Xi,DIRECTION_RIGHT:Yi,DIRECTION_UP:Ki,DIRECTION_DOWN:qi,DIRECTION_HORIZONTAL:Dt,DIRECTION_VERTICAL:rr,DIRECTION_ALL:Md,Manager:wc,Input:ut,TouchAction:_c,TouchInput:Po,MouseInput:Co,PointerEventInput:dc,TouchMouseInput:pc,SingleTouchInput:Ld,Recognizer:nn,AttrRecognizer:At,Tap:No,Pan:ko,Swipe:Tc,Pinch:mc,Rotate:vc,Press:yc,on:I,off:k,each:p,merge:m,extend:S,assign:v,inherit:g,bindFn:y,prefixed:K});var bw=typeof e<"u"?e:typeof self<"u"?self:{};bw.Hammer=wn,t.exports?t.exports=wn:e[r]=wn})(window,document,"Hammer")})(TT);var Eo=TT.exports;const ZM=Iw(Eo),jt=xw({__proto__:null,default:ZM},[Eo]),wT=1,ET=2,qh=4,QM={mousedown:wT,mousemove:ET,mouseup:qh};function JM(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function GM(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(JM(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function ek(t){t.prototype.handler=function(n){let r=QM[n.type];r&wT&&n.button>=0&&(this.pressed=!0),r&ET&&n.buttons===0&&(r=qh),this.pressed&&(r&qh&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}GM(Eo.PointerEventInput);ek(Eo.MouseInput);const tk=Eo.Manager;class lc{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const nk=jt?[[jt.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[jt.Rotate,{enable:!1}],[jt.Pinch,{enable:!1}],[jt.Swipe,{enable:!1}],[jt.Pan,{threshold:0,enable:!1}],[jt.Press,{enable:!1}],[jt.Tap,{event:"doubletap",taps:2,enable:!1}],[jt.Tap,{event:"anytap",enable:!1}],[jt.Tap,{enable:!1}]]:null,W_={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},rk={doubletap:["tap"]},ik={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Sd={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},sk={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},$_={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},ok=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",fi=typeof window<"u"?window:global;let Zh=!1;try{const t={get passive(){return Zh=!0,!0}};fi.addEventListener("test",null,t),fi.removeEventListener("test",null)}catch{Zh=!1}const ak=ok.indexOf("firefox")!==-1,{WHEEL_EVENTS:lk}=Sd,X_="wheel",Y_=4.000244140625,ck=40,uk=.25;class hk extends lc{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;fi.WheelEvent&&(ak&&i.deltaMode===fi.WheelEvent.DOM_DELTA_PIXEL&&(s/=fi.devicePixelRatio),i.deltaMode===fi.WheelEvent.DOM_DELTA_LINE&&(s*=ck)),s!==0&&s%Y_===0&&(s=Math.floor(s/Y_)),i.shiftKey&&s&&(s=s*uk),this.callback({type:X_,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(lk),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Zh?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===X_&&(this.options.enable=n)}}const{MOUSE_EVENTS:fk}=Sd,K_="pointermove",q_="pointerover",Z_="pointerout",Q_="pointerenter",J_="pointerleave";class dk extends lc{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(fk),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===K_&&(this.enableMoveEvent=n),e===q_&&(this.enableOverEvent=n),e===Z_&&(this.enableOutEvent=n),e===Q_&&(this.enableEnterEvent=n),e===J_&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(q_,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Z_,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Q_,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(J_,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(K_,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:pk}=Sd,G_="keydown",em="keyup";class gk extends lc{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:G_,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:em,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(pk),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===G_&&(this.enableDownEvent=n),e===em&&(this.enableUpEvent=n)}}const tm="contextmenu";class _k extends lc{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:tm,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===tm&&(this.options.enable=n)}}const nm=1,Qh=2,rm=4,mk={pointerdown:nm,pointermove:Qh,pointerup:rm,mousedown:nm,mousemove:Qh,mouseup:rm},yk=0,vk=1,Tk=2,wk=1,Ek=2,Sk=4;function Ak(t){const e=mk[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,s=!1,o=!1;return e===Qh?(i=!!(n&wk),s=!!(n&Sk),o=!!(n&Ek)):(i=r===yk,s=r===vk,o=r===Tk),{leftButton:i,middleButton:s,rightButton:o}}function Rk(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Su={srcElement:"root",priority:0};class bk{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Su;typeof r=="string"||r&&r.addEventListener?l={...Su,srcElement:r}:r&&(l={...Su,...r});let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let h=c.length-1;for(;h>=0&&!(c[h].priority>=u.priority);)h--;c.splice(h+1,0,u)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:c,handler:u,once:h}=r[l];if(u({...e,type:c,stopPropagation:s,stopImmediatePropagation:o}),h&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...Ak(e),...Rk(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Ck={events:null,recognizers:null,recognizerOptions:{},Manager:tk,touchAction:"none",tabIndex:0};class Pk{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=ik[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...Ck,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||nk}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(W_).forEach(i=>{const s=this.manager.get(i);s&&W_[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new hk(e,this._onOtherEvent,{enable:!1}),this.moveInput=new dk(e,this._onOtherEvent,{enable:!1}),this.keyInput=new gk(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new _k(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=rk[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const u in e)this._addEventHandler(u,e[u],r,i,s);return}const{manager:o,events:a}=this,l=$_[e]||e;let c=a.get(l);c||(c=new bk(this),a.set(l,c),c.recognizerName=sk[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,n,r,i,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=$_[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function bn(){}const xk=({isDragging:t})=>t?"grabbing":"grab",ST={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:bn,onWebGLInitialized:bn,onResize:bn,onViewStateChange:bn,onInteractionStateChange:bn,onBeforeRender:bn,onAfterRender:bn,onLoad:bn,onError:t=>te.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:xk,getTooltip:null,debug:!1,drawPickingColors:!1};class Ad{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new tc({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{const{_pickRequest:i}=this;if(r.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(r.leftButton||r.rightButton)return;{const s=r.offsetCenter;if(!s)return;i.x=s.x,i.y=s.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=r},this._onEvent=r=>{const i=Lh[r.type],s=r.offsetCenter;if(!i||!s||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:o,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:l}=a,c=l&&(l[i.handler]||l.props[i.handler]),u=this.props[i.handler];let h=!1;c&&(h=c.call(l,a,r)),h||(u==null||u(a,r),this.widgetManager.onEvent(a,r))},this._onPointerDown=r=>{const i=r.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo},this.props={...ST,...e},e=this.props,e.viewState&&e.initialViewState&&te.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device?this.device=e.device:e.gl&&(e.gl instanceof WebGLRenderingContext&&te.error("WebGL1 context not supported.")(),this.device=Ds.attach(e.gl));let n=this.device;n||(Ti.registerDevices([Ds]),n=Ti.createDevice({...e.deviceProps,canvas:this._createCanvas(e)})),this.animationLoop=this._createAnimationLoop(n,e),this.setProps(e),e._typedArrayManagerProps&&so.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,l,c,u;(e=this.animationLoop)==null||e.stop(),(n=this.animationLoop)==null||n.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,(r=this.layerManager)==null||r.finalize(),this.layerManager=null,(i=this.viewManager)==null||i.finalize(),this.viewManager=null,(s=this.effectManager)==null||s.finalize(),this.effectManager=null,(o=this.deckRenderer)==null||o.finalize(),this.deckRenderer=null,(a=this.deckPicker)==null||a.finalize(),this.deckPicker=null,(l=this.eventManager)==null||l.destroy(),this.eventManager=null,(c=this.widgetManager)==null||c.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&((u=this.canvas.parentElement)==null||u.removeChild(this.canvas),this.canvas=null)}setProps(e){var r;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&te.removed("onLayerHover","onHover")(),"onLayerClick"in e&&te.removed("onLayerClick","onClick")(),e.initialViewState&&!It(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),(r=this.animationLoop)==null||r.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return je(this.viewManager),this.viewManager.views}getViewports(e){return je(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var n;(n=this.layerManager)==null||n.removeDefaultShaderModule(e)}_pick(e,n,r){je(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),je(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){var i;if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?`${n}px`:n;this.canvas.style.width=s}if(r||r===0){const s=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=((i=e.style)==null?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var i,s;const{canvas:e}=this;if(!e)return;const n=e.clientWidth??e.width,r=e.clientHeight??e.height;(n!==this.width||r!==this.height)&&(this.width=n,this.height=r,(i=this.viewManager)==null||i.setProps({width:n,height:r}),(s=this.layerManager)==null||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:r}))}_createAnimationLoop(e,n){const{gl:r,onError:i,useDevicePixels:s}=n;return new G2({device:e,useDevicePixels:s,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,n=Array.isArray(e)?e:e?[e]:[new iT({id:"default-view"})];return n.length&&this.props.controller&&(n[0].props.controller=this.props.controller),n}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var n,r,i;const{_pickRequest:e}=this;if(e.event){const{result:s,emptyInfo:o}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=s.length>0;let a=o,l=!1;for(const c of s)a=c,l=((n=c.layer)==null?void 0:n.onHover(c,e.event))||l;l||((i=(r=this.props).onHover)==null||i.call(r,a,e.event),this.widgetManager.onHover(a,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var i,s;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=(i=this.device.canvasContext)==null?void 0:i.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof Ds&&this.props.onWebGLInitialized(this.device.gl);const n=new eT;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new Pk(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const o in Lh)this.eventManager.on(o,this._onEvent);this.viewManager=new yx({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new mx(this.device,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new Ox({deck:this,device:this.device}),this.deckRenderer=new Ux(this.device),this.deckPicker=new Hx(this.device),this.widgetManager=new Xx({deck:this,parentElement:(s=this.canvas)==null?void 0:s.parentElement}),this.widgetManager.addDefault(new Kx),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){var o;const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n};(o=this.deckRenderer)==null||o.renderLayers(s),s.pass==="screen"&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),te.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Ti.stats.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}Ad.defaultProps=ST;Ad.VERSION=ob;function Ik(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Tv(t)}}const Mk=vv;function ua(t,e){return{attribute:t,format:e.size>1?`${e.type}x${e.size}`:e.type,byteOffset:e.offset||0}}function mr(t){return t.stride||t.size*t.bytesPerElement}function kk(t,e){return t.type===e.type&&t.size===e.size&&mr(t)===mr(e)&&(t.offset||0)===(e.offset||0)}function Jh(t,e){e.offset&&te.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=mr(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function Nk(t,e){const n=Jh(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class Ok{constructor(e,n,r){this._buffer=null,this.device=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i==="float64";let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a="float32":!i&&n.isIndexed?a="uint32":a=i||"float32";let l=Ik(i||a);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*mr(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),so.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,n=null){const r={};if(this.state.constant){const i=this.value;if(n){const s=Jh(this.getAccessor(),n),o=s.offset/i.BYTES_PER_ELEMENT,a=s.size||this.size;r[e]=i.subarray(o,o+a)}else r[e]=i}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,n=null){const r=this.getAccessor(),i=[],s={name:this.id,byteStride:mr(r),attributes:i};if(this.doublePrecision){const o=Nk(r,n||{});i.push(ua(e,{...r,...o.high}),ua(`${e}64Low`,{...r,...o.low}))}else if(n){const o=Jh(r,n);i.push(ua(e,{...r,...o}))}else i.push(ua(e,r));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let c=0;c<i;c++){const u=n[l++];u<o[c]&&(o[c]=u),u>a[c]&&(a[c]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ge?r={buffer:e}:r=e;const i={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)i.type="float32";else{const o=Mk(r.value);i.type=i.normalized?o.replace("int","norm"):o}i.bytesPerElement=r.value.BYTES_PER_ELEMENT,i.stride=mr(i)}if(n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=ArrayBuffer.isView(s)?s:new Float32Array(s)}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s;let{buffer:o}=this;const a=mr(i),l=(i.vertexOffset||0)*a;if(this.doublePrecision&&s instanceof Float64Array&&(s=uu(s,i)),this.settings.isIndexed){const u=this.settings.defaultType;s.constructor!==u&&(s=new u(s))}const c=s.byteLength+l+a*2;(!o||o.byteLength<c)&&(o=this._createBuffer(c)),o.write(s,l)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&n instanceof Float64Array?uu(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),r*n.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=so.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{byteOffset:o}=this;let{buffer:a}=this;return(!a||a.byteLength<s.byteLength+o)&&(a=this._createBuffer(s.byteLength+o),n&&i&&a.write(i instanceof Float64Array?uu(i,this):i,o)),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error(`Attribute ${this.id} value is not TypedArray`);const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${n.constructor.name}`);!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&te.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(n=>(n+128)/255*2-1);case"snorm16":return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(n=>n/255);case"unorm16":return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}_createBuffer(e){var i;this._buffer&&this._buffer.destroy();const{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer({...(i=this._buffer)==null?void 0:i.props,id:this.id,usage:n?ge.INDEX:ge.VERTEX,indexType:n?r:void 0,byteLength:e}),this._buffer}}const im=[],sm=[];function AT(t,e=0,n=1/0){let r=im;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(sm.length=t.length,r=sm):r=im,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function RT(t){return t&&t[Symbol.asyncIterator]}function Dk(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((t.length-c)/l);return(h,{index:f,target:p})=>{if(!s){const m=f*l+c;for(let g=0;g<n;g++)p[g]=t[m+g];return p}const T=s[f],v=s[f+1]||u;let S;if(o){S=new Array(v-T);for(let m=T;m<v;m++){const g=m*l+c;p=new Array(n);for(let y=0;y<n;y++)p[y]=t[g+y];S[m-T]=p}}else if(l===n)S=t.subarray(T*n+c,v*n+c);else{S=new t.constructor((v-T)*n);let m=0;for(let g=T;g<v;g++){const y=g*l+c;for(let R=0;R<n;R++)S[m++]=t[y+R]}}return S}}const Fk=[],ba=[[0,1/0]];function Uk(t,e){if(t===ba||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}const Bk={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function bT(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Bk[n],...e,...t,type:n}}class CT extends Ok{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:ba}),this.constant=!1,this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var n;(n=this.state).layoutChanged||(n.layoutChanged=!kk(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return bT(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=Uk(this.state.updateRanges,[r,i])}else this.state.updateRanges=ba}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Fk}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==ba),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(i,this,{data:n,startRow:c,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[c,u]of s){const h=Number.isFinite(c)?this.getVertexOffset(c):0,f=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:h,endOffset:f})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;je(ArrayBuffer.isView(o.value),`invalid ${i.accessor}`);const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=Dk(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,n=super.getValue();if(!e)return n;for(const r in e)Object.assign(n,super.getValue(r,e[r]));return n}getBufferLayout(e){this.state.layoutChanged=!1;const n=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?r.stepMode=e?e.isInstanced?"instance":"vertex":"instance":r.stepMode=i??"vertex",!n)return r;for(const s in n){const o=super._getBufferLayout(s,n[s]);r.attributes.push(...o.attributes)}return r}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:h}=e,{accessor:f,transform:p}=a,T=l.binaryAccessor||(typeof f=="function"?f:s[f]);je(typeof T=="function",`accessor "${f}" is not a function`);let v=e.getVertexOffset(r);const{iterable:S,objectInfo:m}=AT(n,r,i);for(const g of S){m.index++;let y=T(g,m);if(p&&(y=p.call(this,y)),h){const R=(m.index<h.length-1?h[m.index+1]:o)-h[m.index];if(y&&Array.isArray(y[0])){let P=v;for(const I of y)e._normalizeValue(I,c,P),P+=u}else y&&y.length>u?c.set(y,v):(e._normalizeValue(y,m.target,0),fx({target:c,source:m.target,start:v,count:R}));v+=R*u}else e._normalizeValue(y,c,v),v+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function Au(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let c=a;for(;c<l;){const u=s(c,e);for(let h=0;h<i;h++)n[r+c]=u[h]||0,c++}}function Lk({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!i||!s)return Au({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((u,h)=>r(u+a,h)),c=Math.min(i.length,s.length);for(let u=1;u<c;u++){const h=i[u]*n,f=s[u]*n;Au({source:t.subarray(o,h),target:e,start:a,end:f,size:n,getData:l}),o=h,a=f}return a<e.length&&Au({source:[],target:e,start:a,size:n,getData:l}),e}function Vk(t){const{device:e,settings:n,value:r}=t,i=new CT(e,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function PT(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function xT(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function IT(t){t.push(t.shift())}function zk(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=t.settings;if(l)for(const c of Object.values(l))a=Math.max(a,c.vertexOffset??0);return(r.noAlloc?i.length:(e+a)*s)*o}function MT({device:t,source:e,target:n}){return(!n||n.byteLength<e.byteLength)&&(n==null||n.destroy(),n=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),n}function kT({device:t,buffer:e,attribute:n,fromLength:r,toLength:i,fromStartIndices:s,getData:o=a=>a}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*a,c=n.byteOffset,u=n.settings.bytesPerElement<4?c/n.settings.bytesPerElement*4:c,h=n.startIndices,f=s&&h,p=n.isConstant;if(!f&&e&&r>=i)return e;const T=n.value instanceof Float64Array?Float32Array:n.value.constructor,v=p?n.value:new T(n.getBuffer().readSyncWebGL(c,i*T.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!p){const y=o;o=(R,P)=>n.normalizeConstant(y(R,P))}const S=p?(y,R)=>o(v,R):(y,R)=>o(v.subarray(y+c,y+c+l),R),m=e?new Float32Array(e.readSyncWebGL(u,r*4).buffer):new Float32Array(0),g=new Float32Array(i);return Lk({source:m,target:g,sourceStartIndices:s,targetStartIndices:h,size:l,getData:S}),(!e||e.byteLength<g.byteLength+u)&&(e==null||e.destroy(),e=t.createBuffer({byteLength:g.byteLength+u,usage:35050})),e.write(g,u),e}class NT{constructor({device:e,attribute:n,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new sc(r),this.attribute=n,this.attributeInTransition=Vk(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,n,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=zk(this.attribute,n),this.transition.start({...e,duration:r})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class jk extends NT{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="interpolation",this.transform=$k(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;if(super.start(e,n,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:s,attribute:o}=this;IT(s),s[0]=kT({device:this.device,buffer:s[0],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),s[1]=MT({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:a}=this,l=a.model;let c=Math.floor(this.currentLength/o.size);OT(o)&&(c/=2),l.setVertexCount(c),o.isConstant?(l.setAttributes({aFrom:s[0]}),l.setConstantAttributes({aTo:o.value})):l.setAttributes({aFrom:s[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:n}=this.settings,{time:r}=this.transition;let i=r/e;n&&(i=n(i));const{model:s}=this.transform;s.setUniforms({time:i}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const Hk=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`,Wk=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function OT(t){return t.doublePrecision&&t.value instanceof Float64Array}function $k(t,e){const n=e.size,r=PT(n),i=xT(n),s=e.getBufferLayout();return OT(e)?new oo(t,{vs:Wk,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[OC],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new oo(t,{vs:Hk,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}class Xk extends NT{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="spring",this.texture=Zk(e),this.framebuffer=Qk(e,this.texture),this.transform=qk(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;super.start(e,n);const{buffers:s,attribute:o}=this;for(let l=0;l<2;l++)s[l]=kT({device:this.device,buffer:s[l],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});s[2]=MT({device:this.device,source:s[0],target:s[2]}),this.setBuffer(s[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this,s=this.settings;n.model.setAttributes({aPrev:e[0],aCur:e[1]}),n.transformFeedback.setBuffers({vNext:e[2]}),n.model.setUniforms({stiffness:s.stiffness,damping:s.damping}),n.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),IT(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const Yk=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,Kk=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function qk(t,e){const n=PT(e.size),r=xT(e.size);return new oo(t,{vs:Yk,fs:Kk,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function Zk(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function Qk(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const Jk={interpolation:jk,spring:Xk};class Gk{constructor(e,{id:n,timeline:r}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){i&&this._removeTransition(e);const o=Jk[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,device:this.device}):(te.error(`unsupported transition type '${r.type}'`)(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const om="attributeManager.invalidate",eN="attributeManager.updateStart",tN="attributeManager.updateEnd",nN="attribute.updateStart",rN="attribute.allocate",iN="attribute.updateEnd";class DT{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){this.mergeBoundsMemoized=To(U2),this.id=n,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Gk(e,{id:`${n}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ve(om,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ve(om,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;Ve(eN,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],h=u.settings.accessor;u.startIndices=r,u.numInstances=n,s[c]&&te.removed(`props.${c}`,`data.attributes.${c}`)(),u.setExternalBuffer(o[c])||u.setBinaryValue(typeof h=="string"?o[h]:void 0,e.startIndices)||typeof h=="string"&&!o[h]&&u.setConstantValue(s[h])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}l&&Ve(tN,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])==null?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(n=>n.getBufferLayout(e))}_add(e,n){for(const r in e){const i=e[r],s={...i,id:r,size:i.isIndexed&&1||i.size||1,...n};this.attributes[r]=new CT(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ve(nN,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ve(rN,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ve(iN,n,r))}}class sN extends sc{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=fl(n,r,o)}}const am=1e-5;function lm(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function oN(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=lm(t[o],e[o],n[o],r,i);return s}return lm(t,e,n,r,i)}function cm(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class aN extends sc{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=oN(s,o,n,r,i);const l=cm(a,n),c=cm(a,o);l<am&&c<am&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const lN={interpolation:sN,spring:aN};class cN{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;n=c,this.remove(e)}if(i=bT(i),!i)return;const o=lN[i.type];if(!o){te.error(`unsupported transition type '${i.type}'`)();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function uN(t){const e=t[Xn];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error(`Invalid prop ${n}: ${t[n]}`)}}function hN(t,e){const n=Rd({newProps:t,oldProps:e,propTypes:t[Xn],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=dN(t,e);let i=!1;return r||(i=pN(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:gN(t,e),transitionsChanged:fN(t,e)}}function fN(t,e){if(!t.transitions)return!1;const n={},r=t[Xn];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Gh(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function Rd({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return`${i}.${s} added`;const o=Gh(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return`${i}.${s} dropped`;if(!Object.hasOwnProperty.call(t,s)){const o=Gh(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}}return!1}function Gh(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function dN(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function pN(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&um(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&um(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function gN(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function um(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},Rd({oldProps:i,newProps:r,triggerName:n})}const _N="count(): argument not an object",mN="count(): argument not a container";function yN(t){if(!TN(t))throw new Error(_N);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(vN(t))return Object.keys(t).length;throw new Error(mN)}function vN(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function TN(t){return t!==null&&typeof t=="object"}function hm(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const wN={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},ef={};function EN(t,e,n,r){if(n instanceof gt)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=e.createTexture({...n,sampler:{...wN,...i,...r}});return ef[s.id]=t,s}function SN(t,e){!e||!(e instanceof gt)||ef[e.id]===t&&(e.delete(),delete ef[e.id])}const AN={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||tf(t)&&(t.length===3||t.length===4)},equal(t,e,n){return It(t,e,1)}},accessor:{validate(t,e){const n=Tl(t);return n==="function"||n===Tl(e.value)},equal(t,e,n){return typeof e=="function"?!0:It(t,e,1)}},array:{validate(t,e){return e.optional&&!t||tf(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?It(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?It(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{if(!t)return t;const{dataTransform:r}=n.props;return r?r(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.device?null:EN(n.id,r.device,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{SN(n.id,t)}}};function RN(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=bN(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function bN(t,e){switch(Tl(e)){case"object":return ds(t,e);case"array":return ds(t,{type:"array",value:e,compare:!1});case"boolean":return ds(t,{type:"boolean",value:e});case"number":return ds(t,{type:"number",value:e});case"function":return ds(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function ds(t,e){return"type"in e?{name:t,...AN[e.type],...e}:"value"in e?{name:t,type:Tl(e.value),...e}:{name:t,type:"object",value:e}}function tf(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Tl(t){return tf(t)?"array":t===null?"null":typeof t}function CN(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=nf(t.constructor,n),i=Object.create(r);i[yl]=t,i[Pr]={},i[Fn]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const PN="_mergedDefaultProps";function nf(t,e){if(!(t instanceof cc.constructor))return{};let n=PN;if(e)for(const i of e){const s=i.constructor;s&&(n+=`:${s.extensionName||s.name}`)}const r=FT(t,n);return r||(t[n]=xN(t,e||[]))}function xN(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=nf(r),s=FT(t,"defaultProps")||{},o=RN(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i==null?void 0:i[Xn],o.propTypes),c=Object.assign(Object.create(null),i==null?void 0:i[du],o.deprecatedProps);for(const u of e){const h=nf(u.constructor);h&&(Object.assign(a,h),Object.assign(l,h[Xn]),Object.assign(c,h[du]))}return IN(a,t),kN(a,l),MN(a,c),a[Xn]=l,a[du]=c,e.length===0&&!bd(t,"_propTypes")&&(t._propTypes=l),a}function IN(t,e){const n=ON(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function MN(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i=`${this.id}: ${n}`;for(const s of e[n])bd(this,s)||(this[s]=r);te.deprecated(i,e[n].join("/"))()}})}function kN(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=NN(o))}t[Si]=n,t[Pr]={},Object.defineProperties(t,r)}function NN(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||RT(e)?this[Pr][t]=e:this[Fn][t]=e},get(){if(this[Fn]){if(t in this[Fn])return this[Fn][t]||this[Si][t];if(t in this[Pr]){const e=this[yl]&&this[yl].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Si][t]}}return this[Si][t]}}}function bd(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function FT(t,e){return bd(t,e)&&t[e]}function ON(t){const e=t.componentName;return e||te.warn(`${t.name}.componentName not specified`)(),e||t.name}let DN=0;class cc{constructor(...e){this.props=CN(this,e),this.id=this.props.id,this.count=DN++}clone(e){const{props:n}=this,r={};for(const i in n[Si])i in n[Fn]?r[i]=n[Fn][i]:i in n[Pr]&&(r[i]=n[Pr][i]);return new this.constructor({...n,...r,...e})}}cc.componentName="Component";cc.defaultProps={};const FN=Object.freeze({});class UN{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||FN}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[yl]||this.component;const n=e[Fn]||{},r=e[Pr]||e,i=e[Si]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(RT(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Xn];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class BN extends UN{constructor({attributeManager:e,layer:n}){super(n),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,`loading ${e} of ${this.layer}`)}}const LN="layer.changeFlag",VN="layer.initialize",zN="layer.update",jN="layer.finalize",HN="layer.matched",fm=2**24-1,WN=Object.freeze([]),$N=To(({oldViewport:t,viewport:e})=>t.equals(e));let Ht=new Uint8ClampedArray(0);const XN={data:{type:"data",value:WN,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;i=i||n.getLoadOptions(),r=r||n.props.loaders,s&&(i={...i,fetch:{...i==null?void 0:i.fetch,signal:s}});let a=o.contains(t);return!a&&!i&&(o.add({resourceId:t,data:tl(t,r),persistent:!1}),a=!0),a?o.subscribe({resourceId:t,onChange:l=>{var c;return(c=n.internalState)==null?void 0:c.reloadAsyncProp(e,l)},consumerId:n.id,requestId:e}):tl(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ee.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class So extends cc{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Yr.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){je(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=Qv(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=Kv(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return je(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){je(this.internalState);const r=this.internalState.viewport||this.context.viewport;return Jv(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}setShaderModuleProps(...e){for(const n of this.getModels())n.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ee.DEFAULT||e===ee.LNGLAT||e===ee.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){je(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:yN(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=hm(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const n of this.props.extensions)e=hm(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=n.attributes,c=a||l;c&&(o&&c.constant&&(c.constant=!1,n.invalidate(c.id)),!c.value&&!o&&(c.constant=!0,c.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.destroy();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i,s,o;n&&(e=new Error(`${n}: ${e.message}`,{cause:e})),(i=(r=this.props).onError)!=null&&i.call(r,e)||(o=(s=this.context)==null?void 0:s.onError)==null||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)==null?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!$N({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){let n=!1;for(const r in e)e[r].layoutChanged()&&(n=!0);for(const r of this.getModels())this._setModelAttributes(r,e,n)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Ht.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>fm&&te.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ht=so.allocate(Ht,n,{size:4,copy:!0,maxCount:Math.max(n,fm)});const i=Math.floor(Ht.length/4),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),Ht[o*4+0]=s[0],Ht[o*4+1]=s[1],Ht[o*4+2]=s[2]}e.value=Ht.subarray(0,n*4)}_setModelAttributes(e,n,r=!1){var a;if(!Object.keys(n).length)return;if(r){const l=this.getAttributeManager();e.setBufferLayout(l.getBufferLayouts(e)),n=l.getAttributes()}const i=((a=e.userData)==null?void 0:a.excludeAttributes)||{},s={},o={};for(const l in n){if(i[l])continue;const c=n[l].getValue();for(const u in c){const h=c[u];h instanceof ge?n[l].settings.isIndexed?e.setIndexBuffer(h):s[u]=h:h&&(o[u]=h)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,l=this.encodePickingColor(e);for(let c=0;c<n.length;c++){const u=s.getVertexOffset(c);a[u]===l[0]&&a[u+1]===l[1]&&a[u+2]===l[2]&&this._disablePickingIndex(c)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(o-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Ht.buffer&&(r.value=Ht.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){je(!this.internalState),je(Number.isFinite(this.props.coordinateSystem)),Ve(VN,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new BN({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(te.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new cN(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ve(HN,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ve(zN,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.device)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const c=this.getModels()[0]!==l[0];this._postUpdate(a,c)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ve(jN,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,moduleParameters:n=null,uniforms:r={},parameters:i={}}){this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;const a=this.props.opacity;r.opacity=Math.pow(a,1/2.2);try{if(n){const{isActive:u,isAttribute:h}=n.picking;this.setModuleParameters(n),this.setShaderModuleProps({picking:{isActive:u,isAttribute:h}})}const{getPolygonOffset:l}=this.props,c=l&&l(r)||[0,0];o.device.setParametersWebGL({polygonOffset:c});for(const u of this.getModels())u.setParameters(i);o.device.withParametersWebGL(i,()=>{const u={renderPass:e,moduleParameters:n,uniforms:r,parameters:i,context:o};for(const h of this.props.extensions)h.draw.call(this,u,h);this.draw(u)})}finally{this.props=s}}getChangeFlags(){var e;return(e=this.internalState)==null?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Ve(LN,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){var i;const r=hN(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)==null?void 0:i[s]);return this.setChangeFlags(r)}validateProps(){uN(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.highlightColor=r(e)),this.setShaderModuleProps({picking:n}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new DT(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const s=this.state.model;s!=null&&s.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const c={};Array.isArray(l)&&(c.highlightColor=l),(n||i.autoHighlight!==o||a!==i.highlightedObjectIndex)&&(c.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:c})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}So.defaultProps=XN;So.layerName="Layer";const YN="compositeLayer.renderLayers";class UT extends So{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var k;const{opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:T,extensions:v,fetch:S,operation:m,_subLayerProps:g}=this.props,y={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:T,extensions:v,fetch:S,operation:m},R=g&&e.id&&g[e.id],P=R&&R.updateTriggers,I=e.id||"sublayer";if(R){const N=this.props[Xn],F=e.type?e.type._propTypes:{};for(const O in R){const H=F[O]||N[O];H&&H.type==="accessor"&&(R[O]=this.getSubLayerAccessor(R[O]))}}Object.assign(y,e,R),y.id=`${this.props.id}-${I}`,y.updateTriggers={all:(k=this.props.updateTriggers)==null?void 0:k.all,...e.updateTriggers,...P};for(const N of v){const F=N.getSubLayerProps.call(this,N);F&&Object.assign(y,F,{updateTriggers:Object.assign(y.updateTriggers,F.updateTriggers)})}return y}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=yd(s,Boolean),this.internalState.subLayers=r}Ve(YN,this,i,r);for(const s of r)s.parent=this}}UT.layerName="CompositeLayer";const Xr={SUM:1,MEAN:2,MIN:3,MAX:4};function BT(t,e){return t+e}function KN(t,e){return e>t?e:t}function qN(t,e){return e<t?e:t}function ZN(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(BT,0)/n.length:null}function QN(t,e){if(Number.isFinite(e))return t.length?t.length*e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(BT,0):null}function JN(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(KN,-1/0):null}function GN(t,e){if(Number.isFinite(e))return t.length?e:null;const n=t.map(e).filter(Number.isFinite);return n.length?n.reduce(qN,1/0):null}function eO(t,e,n){const r=Xr[t]||Xr.SUM;switch(e=tO(e,n),r){case Xr.MIN:return i=>GN(i,e);case Xr.SUM:return i=>QN(i,e);case Xr.MEAN:return i=>ZN(i,e);case Xr.MAX:return i=>JN(i,e);default:return null}}function tO(t,e={}){return Number.isFinite(t)?t:n=>(e.index=n.index,t(n.source,e))}function nO(t,e={}){return n=>(e.indices=n.map(r=>r.index),t(n.map(r=>r.source),e))}const rO=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function iO(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}class LT extends UT{initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:iO(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){const r=this.getShaders({});r&&r.defines&&(r.defines.NON_INSTANCED_MODEL=1),this.updateShaders(r)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getAttributes()}getModuleSettings(){const{viewport:e,mousePosition:n,device:r}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,picking:{isActive:0},devicePixelRatio:r.canvasContext.cssToDeviceRatio()})}updateShaders(e){}isAggregationDirty(e,n={}){const{props:r,oldProps:i,changeFlags:s}=e,{compareAll:o=!1,dimension:a}=n,{ignoreProps:l}=this.state,{props:c,accessors:u=[]}=a,{updateTriggersChanged:h}=s;if(s.dataChanged)return!0;if(h){if(h.all)return!0;for(const f of u)if(h[f])return!0}if(o)return s.extensionsChanged?!0:Rd({oldProps:i,newProps:r,ignoreProps:l,propTypes:this.constructor._propTypes});for(const f of c)if(r[f]!==i[f])return!0;return!1}isAttributeChanged(e){const{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!sO(n)}_getAttributeManager(){return new DT(this.context.device,{id:this.props.id,stats:this.context.stats})}}LT.layerName="AggregationLayer";function sO(t){let e=!0;for(const n in t){e=!1;break}return e}function uc(t,e,n){const r=n;return r.domain=()=>t,r.range=()=>e,r}function dm(t,e){return uc(t,e,r=>dO(t,e,r))}function oO(t,e){return uc(t,e,r=>pO(t,e,r))}function aO(t,e){const n=t.sort(VT);let r=0;const i=Math.max(1,e.length),s=new Array(i-1);for(;++r<i;)s[r-1]=lO(n,r/i);const o=a=>uO(s,e,a);return o.thresholds=()=>s,uc(t,e,o)}function VT(t,e){return t-e}function lO(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const r=(n-1)*e,i=Math.floor(r),s=t[i],o=t[i+1];return s+(o-s)*(r-i)}function cO(t,e){let n=0,r=t.length;for(;n<r;){const i=n+r>>>1;VT(t[i],e)>0?r=i:n=i+1}return n}function uO(t,e,n){return e[cO(t,n)]}function hO(t,e,n,r){const i=`${r}`;let s=e.get(i);return s===void 0&&(s=t.push(r),e.set(i,s)),n[(s-1)%n.length]}function fO(t,e){const n=new Map,r=[];for(const s of t){const o=`${s}`;n.has(o)||n.set(o,r.push(s))}return uc(t,e,s=>hO(r,n,e,s))}function dO(t,e,n){const r=t[1]-t[0];if(r<=0)return te.warn("quantizeScale: invalid domain, returning range[0]")(),e[0];const i=r/e.length,s=Math.floor((n-t[0])/i),o=Math.max(Math.min(s,e.length-1),0);return e[o]}function pO(t,e,n){return(n-t[0])/(t[1]-t[0])*(e[1]-e[0])+e[0]}function zT(t){return t!=null}function gO(t){const e=[];return t.forEach(n=>{!e.includes(n)&&zT(n)&&e.push(n)}),e}function jT(t,e){return(typeof e=="function"?t.map(e):t).filter(zT)}function _O(t,e){return jT(t,e)}function mO(t,e){return gO(jT(t,e))}function yO(t,e,n){return Math.max(e,Math.min(n,t))}function vO(t){switch(t){case"quantize":return dm;case"linear":return oO;case"quantile":return aO;case"ordinal":return fO;default:return dm}}const HT=t=>t.length,TO=3402823466e29,WT=t=>t.points,$T=t=>t.index,pm=(t,e)=>t<e?-1:t>e?1:t>=e?0:NaN,wO={getValue:HT,getPoints:WT,getIndex:$T,filterData:null};class EO{constructor(e=[],n=wO){this.aggregatedBins=this.getAggregatedBins(e,n),this._updateMinMaxValues(),this.binMap=this.getBinMap()}getAggregatedBins(e,n){const{getValue:r=HT,getPoints:i=WT,getIndex:s=$T,filterData:o}=n,a=typeof o=="function",l=e.length,c=[];let u=0;for(let h=0;h<l;h++){const f=e[h],p=i(f),T=s(f),v=a?p.filter(o):p;f.filteredPoints=a?v:null;const S=v.length?r(v):null;S!=null&&(c[u]={i:Number.isFinite(T)?T:h,value:S,counts:v.length},u++)}return c}_percentileToIndex(e){const n=this.sortedBins.length;if(n<2)return[0,0];const[r,i]=e.map(a=>yO(a,0,100)),s=Math.ceil(r/100*(n-1)),o=Math.floor(i/100*(n-1));return[s,o]}getBinMap(){const e={};for(const n of this.aggregatedBins)e[n.i]=n;return e}_updateMinMaxValues(){let e=0,n=0,r=TO,i=0;for(const s of this.aggregatedBins)e=e>s.counts?e:s.counts,n=n>s.value?n:s.value,r=r<s.value?r:s.value,i+=s.counts;this.maxCount=e,this.maxValue=n,this.minValue=r,this.totalCount=i}getValueRange(e){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((i,s)=>pm(i.value,s.value))),!this.sortedBins.length)return[];let n=0,r=this.sortedBins.length-1;if(Array.isArray(e)){const i=this._percentileToIndex(e);n=i[0],r=i[1]}return[this.sortedBins[n].value,this.sortedBins[r].value]}getValueDomainByScale(e,[n=0,r=100]=[]){if(this.sortedBins||(this.sortedBins=this.aggregatedBins.sort((s,o)=>pm(s.value,o.value))),!this.sortedBins.length)return[];const i=this._percentileToIndex([n,r]);return this._getScaleDomain(e,i)}_getScaleDomain(e,[n,r]){const i=this.sortedBins;switch(e){case"quantize":case"linear":return[i[n].value,i[r].value];case"quantile":return _O(i.slice(n,r+1),s=>s.value);case"ordinal":return mO(i,s=>s.value);default:return[i[n].value,i[r].value]}}}const SO={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function AO(t,e,n={}){return RO(t,n)!==e?(CO(t,n),!0):!1}function RO(t,e={}){return Math.sign(bO(t,e))}const gm={x:0,y:1,z:2};function bO(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e,s=e.size||2;let o=0;const a=gm[i[0]],l=gm[i[1]];for(let c=n,u=r-s;c<r;c+=s)o+=(t[c+a]-t[u+a])*(t[c+l]+t[u+l]),u=c;return o/2}function CO(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,c=n+(s-1-a)*i;for(let u=0;u<i;++u){const h=t[l+u];t[l+u]=t[c+u],t[c+u]=h}}}class PO extends lx{constructor(e){const{indices:n,attributes:r}=xO(e);super({...e,indices:n,attributes:r})}}function xO(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(te.assert(i.length>=r),i=i.flatMap(p=>[p[0],p[1]]),AO(i,SO.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,l=Math.PI*2/r,c=new Uint16Array(s?r*3*2:0),u=new Float32Array(a*3),h=new Float32Array(a*3);let f=0;if(s){for(let p=0;p<o;p++){const T=p*l,v=p%r,S=Math.sin(T),m=Math.cos(T);for(let g=0;g<2;g++)u[f+0]=i?i[v*2]:m*e,u[f+1]=i?i[v*2+1]:S*e,u[f+2]=(1/2-g)*n,h[f+0]=i?i[v*2]:m,h[f+1]=i?i[v*2+1]:S,f+=3}u[f+0]=u[f-3],u[f+1]=u[f-2],u[f+2]=u[f-1],f+=3}for(let p=s?0:1;p<o;p++){const T=Math.floor(p/2)*Math.sign(.5-p%2),v=T*l,S=(T+r)%r,m=Math.sin(v),g=Math.cos(v);u[f+0]=i?i[S*2]:g*e,u[f+1]=i?i[S*2+1]:m*e,u[f+2]=n/2,h[f+2]=1,f+=3}if(s){let p=0;for(let T=0;T<r;T++)c[p++]=T*2+0,c[p++]=T*2+2,c[p++]=T*2+0,c[p++]=T*2+1,c[p++]=T*2+1,c[p++]=T*2+3}return{indices:c,attributes:{POSITION:{size:3,value:u},NORMAL:{size:3,value:h}}}}const IO=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
} else if (stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
if (isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = radius * coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
if (radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded && !isStroke) {
#ifdef FLAT_SHADING
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,MO=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (extruded && !isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,wl=[0,0,0,255],kO={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:wl},getLineColor:{type:"accessor",value:wl},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Cd extends So{getShaders(){const e={},{flatShading:n}=this.props;return n&&(e.FLAT_SHADING=1),super.getShaders({vs:IO,fs:MO,defines:e,modules:[qP,n?MP:IP,m2]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:wl},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:wl},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){var a;super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;s&&((a=this.state.models)==null||a.forEach(l=>l.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const o=this.getNumInstances();this.state.fillModel.setInstanceCount(o),this.state.wireframeModel.setInstanceCount(o),(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new PO({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o],l=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=l/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModels(){const e=this.getShaders(),n=this.getAttributeManager().getBufferLayouts(),r=new Vi(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:n,isInstanced:!0}),i=new Vi(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:n,isInstanced:!0});return{fillModel:r,wireframeModel:i,models:[i,r]}}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3});const o=this.state.fillModel,a=this.state.wireframeModel;o.setGeometry(s),o.setTopology("triangle-strip"),o.setIndexBuffer(null),a.setGeometry(s),a.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:l,filled:c,stroked:u,wireframe:h,offset:f,coverage:p,radius:T,angle:v}=this.props,S=this.state.fillModel,m=this.state.wireframeModel,{fillVertexCount:g,edgeDistance:y}=this.state,R={...e,radius:T,angle:v/180*Math.PI,offset:f,extruded:l,stroked:u,coverage:p,elevationScale:a,edgeDistance:y,radiusUnits:pl[o],widthUnits:pl[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s};l&&h&&(m.setUniforms(R),m.setUniforms({isStroke:!0}),m.draw(this.context.renderPass)),S.setUniforms(R),c&&(S.setVertexCount(g),S.setUniforms({isStroke:!1}),S.draw(this.context.renderPass)),!l&&u&&(S.setVertexCount(g*2/3),S.setUniforms({isStroke:!0}),S.draw(this.context.renderPass))}}Cd.layerName="ColumnLayer";Cd.defaultProps=kO;function _m(){}const mm=["getBins","getDomain","getScaleFunc"],ym=[{key:"fillColor",accessor:"getFillColor",pickingInfo:"colorValue",getBins:{triggers:{value:{prop:"getColorValue",updateTrigger:"getColorValue"},weight:{prop:"getColorWeight",updateTrigger:"getColorWeight"},aggregation:{prop:"colorAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"lowerPercentile"},upperPercentile:{prop:"upperPercentile"},scaleType:{prop:"colorScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"colorDomain"},range:{prop:"colorRange"}},onSet:{props:"onSetColorDomain"}},nullValue:[0,0,0,0]},{key:"elevation",accessor:"getElevation",pickingInfo:"elevationValue",getBins:{triggers:{value:{prop:"getElevationValue",updateTrigger:"getElevationValue"},weight:{prop:"getElevationWeight",updateTrigger:"getElevationWeight"},aggregation:{prop:"elevationAggregation"},filterData:{prop:"_filterData",updateTrigger:"_filterData"}}},getDomain:{triggers:{lowerPercentile:{prop:"elevationLowerPercentile"},upperPercentile:{prop:"elevationUpperPercentile"},scaleType:{prop:"elevationScaleType"}}},getScaleFunc:{triggers:{domain:{prop:"elevationDomain"},range:{prop:"elevationRange"}},onSet:{props:"onSetElevationDomain"}},nullValue:-1}],NO=t=>t.cellSize;class OO{constructor(e){this.state={layerData:{data:void 0},dimensions:{}},this.changeFlags={},this.dimensionUpdaters={},this._getCellSize=e.getCellSize||NO,this._getAggregator=e.getAggregator,this._addDimension(e.dimensions||ym)}static defaultDimensions(){return ym}updateState(e,n){const{oldProps:r,props:i,changeFlags:s}=e;this.updateGetValueFuncs(r,i,s);const o=this.needsReProjectPoints(r,i,s);let a=!1;return s.dataChanged||o?(this.getAggregatedData(i,n),a=!0):((this.getDimensionChanges(r,i,s)||[]).forEach(c=>typeof c=="function"&&c()),a=!0),this.setState({aggregationDirty:a}),this.state}setState(e){this.state={...this.state,...e}}setDimensionState(e,n){this.setState({dimensions:{...this.state.dimensions,[e]:{...this.state.dimensions[e],...n}}})}normalizeResult(e={}){return e.hexagons?{data:e.hexagons,...e}:e.layerData?{data:e.layerData,...e}:e}getAggregatedData(e,n){const i=this._getAggregator(e)(e,n);this.setState({layerData:this.normalizeResult(i)}),this.changeFlags={layerData:!0},this.getSortedBins(e)}updateGetValueFuncs(e,n,r){for(const i in this.dimensionUpdaters){const{value:s,weight:o,aggregation:a}=this.dimensionUpdaters[i].getBins.triggers;let l=n[s.prop];this.needUpdateDimensionStep(this.dimensionUpdaters[i].getBins,e,n,r)&&(l?l=nO(l,{data:n.data}):l=eO(n[a.prop],n[o.prop],{data:n.data})),l&&this.setDimensionState(i,{getValue:l})}}needsReProjectPoints(e,n,r){return this._getCellSize(e)!==this._getCellSize(n)||this._getAggregator(e)!==this._getAggregator(n)||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPosition)}addDimension(e){this._addDimension(e)}_addDimension(e=[]){e.forEach(n=>{const{key:r}=n;this.dimensionUpdaters[r]=this.getDimensionUpdaters(n),this.state.dimensions[r]={getValue:null,domain:null,sortedBins:null,scaleFunc:_m}})}getDimensionUpdaters({key:e,accessor:n,pickingInfo:r,getBins:i,getDomain:s,getScaleFunc:o,nullValue:a}){return{key:e,accessor:n,pickingInfo:r,getBins:{updater:this.getDimensionSortedBins.bind(this),...i},getDomain:{updater:this.getDimensionValueDomain.bind(this),...s},getScaleFunc:{updater:this.getDimensionScale.bind(this),...o},attributeAccessor:this.getSubLayerDimensionAttribute(e,a)}}needUpdateDimensionStep(e,n,r,i){return Object.values(e.triggers).some(s=>s.updateTrigger?i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged[s.updateTrigger]):n[s.prop]!==r[s.prop])}getDimensionChanges(e,n,r){const i=[];for(const s in this.dimensionUpdaters){const o=mm.find(a=>this.needUpdateDimensionStep(this.dimensionUpdaters[s][a],e,n,r));o&&i.push(this.dimensionUpdaters[s][o].updater.bind(this,n,this.dimensionUpdaters[s]))}return i.length?i:null}getUpdateTriggers(e){const n=e.updateTriggers||{},r={};for(const i in this.dimensionUpdaters){const{accessor:s}=this.dimensionUpdaters[i];r[s]={},mm.forEach(o=>{Object.values(this.dimensionUpdaters[i][o].triggers).forEach(({prop:a,updateTrigger:l})=>{if(l){const c=n[l];typeof c=="object"&&!Array.isArray(c)?Object.assign(r[s],c):c!==void 0&&(r[s][a]=c)}else r[s][a]=e[a]})})}return r}getSortedBins(e){for(const n in this.dimensionUpdaters)this.getDimensionSortedBins(e,this.dimensionUpdaters[n])}getDimensionSortedBins(e,n){const{key:r}=n,{getValue:i}=this.state.dimensions[r],s=new EO(this.state.layerData.data||[],{getValue:i,filterData:e._filterData});this.setDimensionState(r,{sortedBins:s}),this.getDimensionValueDomain(e,n)}getDimensionValueDomain(e,n){const{getDomain:r,key:i}=n,{triggers:{lowerPercentile:s,upperPercentile:o,scaleType:a}}=r,l=this.state.dimensions[i].sortedBins.getValueDomainByScale(e[a.prop],[e[s.prop],e[o.prop]]);this.setDimensionState(i,{valueDomain:l}),this.getDimensionScale(e,n)}getDimensionScale(e,n){const{key:r,getScaleFunc:i,getDomain:s}=n,{domain:o,range:a}=i.triggers,{scaleType:l}=s.triggers,{onSet:c}=i,u=e[a.prop],h=e[o.prop]||this.state.dimensions[r].valueDomain,p=vO(l&&e[l.prop])(h,u);typeof c=="object"&&typeof e[c.props]=="function"&&e[c.props](p.domain()),this.setDimensionState(r,{scaleFunc:p})}getSubLayerDimensionAttribute(e,n){return r=>{const{sortedBins:i,scaleFunc:s}=this.state.dimensions[e],o=i.binMap[r.index];if(o&&o.counts===0)return n;const a=o&&o.value,l=s.domain();return a>=l[0]&&a<=l[l.length-1]?s(a):n}}getSubLayerAccessors(e){const n={};for(const r in this.dimensionUpdaters){const{accessor:i}=this.dimensionUpdaters[r];n[i]=this.getSubLayerDimensionAttribute(e,r)}return n}getPickingInfo({info:e}){const n=e.picked&&e.index>-1;let r=null;if(n){const i=this.state.layerData.data[e.index],s={};for(const o in this.dimensionUpdaters){const{pickingInfo:a}=this.dimensionUpdaters[o],{sortedBins:l}=this.state.dimensions[o],c=l.binMap[i.index]&&l.binMap[i.index].value;s[a]=c}r=Object.assign(s,i,{points:i.filteredPoints||i.points})}return e.picked=!!r,e.object=r,e}getAccessor(e){return this.dimensionUpdaters.hasOwnProperty(e)?this.dimensionUpdaters[e].attributeAccessor:_m}}var Kr=Math.PI/3,DO=[0,Kr,2*Kr,3*Kr,4*Kr,5*Kr];function FO(t){return t[0]}function UO(t){return t[1]}function BO(){var t=0,e=0,n=1,r=1,i=FO,s=UO,o,a,l;function c(h){var f={},p=[],T,v=h.length;for(T=0;T<v;++T)if(!(isNaN(m=+i.call(null,S=h[T],T,h))||isNaN(g=+s.call(null,S,T,h)))){var S,m,g,y=Math.round(g=g/l),R=Math.round(m=m/a-(y&1)/2),P=g-y;if(Math.abs(P)*3>1){var I=m-R,k=R+(m<R?-1:1)/2,N=y+(g<y?-1:1),F=m-k,O=g-N;I*I+P*P>F*F+O*O&&(R=k+(y&1?1:-1)/2,y=N)}var H=R+"-"+y,W=f[H];W?W.push(S):(p.push(W=f[H]=[S]),W.x=(R+(y&1)/2)*a,W.y=y*l)}return p}function u(h){var f=0,p=0;return DO.map(function(T){var v=Math.sin(T)*h,S=-Math.cos(T)*h,m=v-f,g=S-p;return f=v,p=S,[m,g]})}return c.hexagon=function(h){return"m"+u(h==null?o:+h).join("l")+"z"},c.centers=function(){for(var h=[],f=Math.round(e/l),p=Math.round(t/a),T=f*l;T<r+o;T+=l,++f)for(var v=p*a+(f&1)*a/2;v<n+a/2;v+=a)h.push([v,T]);return h},c.mesh=function(){var h=u(o).slice(0,4).join("l");return c.centers().map(function(f){return"M"+f+"m"+h}).join("")},c.x=function(h){return arguments.length?(i=h,c):i},c.y=function(h){return arguments.length?(s=h,c):s},c.radius=function(h){return arguments.length?(o=+h,a=o*2*Math.sin(Kr),l=o*1.5,c):o},c.size=function(h){return arguments.length?(t=e=0,n=+h[0],r=+h[1],c):[n-t,r-e]},c.extent=function(h){return arguments.length?(t=+h[0][0],e=+h[0][1],n=+h[1][0],r=+h[1][1],c):[[t,e],[n,r]]},c.radius(1)}function LO(t,e){const{data:n,radius:r}=t,{viewport:i,attributes:s}=e,o=n.length?VO(n,e):null,a=zO(r,i,o),l=[],{iterable:c,objectInfo:u}=AT(n),h=s.positions.value,{size:f}=s.positions.getAccessor();for(const v of c){u.index++;const S=u.index*f,m=[h[S],h[S+1]];Number.isFinite(m[0])&&Number.isFinite(m[1])?l.push({screenCoord:i.projectFlat(m),source:v,index:u.index}):te.warn("HexagonLayer: invalid position")()}return{hexagons:BO().radius(a).x(v=>v.screenCoord[0]).y(v=>v.screenCoord[1])(l).map((v,S)=>({position:i.unprojectFlat([v.x,v.y]),points:v,index:S})),radiusCommon:a}}function VO(t,e){const{attributes:n}=e,r=n.positions.value,{size:i}=n.positions.getAccessor();let s=1/0,o=1/0,a=-1/0,l=-1/0,c;for(c=0;c<i*t.length;c+=i){const u=r[c],h=r[c+1];Number.isFinite(u)&&Number.isFinite(h)&&(s=Math.min(u,s),a=Math.max(u,a),o=Math.min(h,o),l=Math.max(h,l))}return[s,o,a,l].every(Number.isFinite)?[(s+a)/2,(o+l)/2]:null}function zO(t,e,n){const{unitsPerMeter:r}=e.getDistanceScales(n);return t*r[0]}function vm(){}const jO={colorDomain:null,colorRange:rO,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",value:0,min:0,max:100},upperPercentile:{type:"number",value:100,min:0,max:100},colorScaleType:"quantize",onSetColorDomain:vm,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationLowerPercentile:{type:"number",value:0,min:0,max:100},elevationUpperPercentile:{type:"number",value:100,min:0,max:100},elevationScale:{type:"number",min:0,value:1},elevationScaleType:"linear",onSetElevationDomain:vm,radius:{type:"number",value:1e3,min:1},coverage:{type:"number",min:0,max:1,value:1},extruded:!1,hexagonAggregator:LO,getPosition:{type:"accessor",value:t=>t.position},material:!0,_filterData:{type:"function",value:null,optional:!0}};class Pd extends LT{initializeState(){const e=new OO({getAggregator:r=>r.hexagonAggregator,getCellSize:r=>r.radius});this.state={cpuAggregator:e,aggregatorState:e.state,vertices:null},this.getAttributeManager().add({positions:{size:3,type:"float64",accessor:"getPosition"}})}updateState(e){if(super.updateState(e),e.changeFlags.propsOrDataChanged){const n=this.state.cpuAggregator.updateState(e,{viewport:this.context.viewport,attributes:this.getAttributes()});if(this.state.aggregatorState.layerData!==n.layerData){const{hexagonVertices:r}=n.layerData||{};this.setState({vertices:r&&this.convertLatLngToMeterOffset(r)})}this.setState({aggregatorState:n})}}convertLatLngToMeterOffset(e){const{viewport:n}=this.context;if(Array.isArray(e)&&e.length===6){const r=e[0],i=e[3],s=[(r[0]+i[0])/2,(r[1]+i[1])/2],o=n.projectFlat(s),{metersPerUnit:a}=n.getDistanceScales(s);return e.map(c=>{const u=n.projectFlat(c);return[(u[0]-o[0])*a[0],(u[1]-o[1])*a[1]]})}return te.error("HexagonLayer: hexagonVertices needs to be an array of 6 points")(),null}getPickingInfo({info:e}){return this.state.cpuAggregator.getPickingInfo({info:e})}_onGetSublayerColor(e){return this.state.cpuAggregator.getAccessor("fillColor")(e)}_onGetSublayerElevation(e){return this.state.cpuAggregator.getAccessor("elevation")(e)}_getSublayerUpdateTriggers(){return this.state.cpuAggregator.getUpdateTriggers(this.props)}renderLayers(){const{elevationScale:e,extruded:n,coverage:r,material:i,transitions:s}=this.props,{aggregatorState:o,vertices:a}=this.state,l=this.getSubLayerClass("hexagon-cell",Cd),c=this._getSublayerUpdateTriggers(),u=a?{vertices:a,radius:1}:{radius:o.layerData.radiusCommon||1,radiusUnits:"common",angle:90};return new l({...u,diskResolution:6,elevationScale:e,extruded:n,coverage:r,material:i,getFillColor:this._onGetSublayerColor.bind(this),getElevation:this._onGetSublayerElevation.bind(this),transitions:s&&{getFillColor:s.getColorValue||s.getColorWeight,getElevation:s.getElevationValue||s.getElevationWeight}},this.getSubLayerProps({id:"hexagon-cell",updateTriggers:c}),{data:o.layerData.data})}}Pd.layerName="HexagonLayer";Pd.defaultProps=jO;const HO=typeof window<"u"?L.useLayoutEffect:L.useEffect;function El(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const WO={position:"absolute",zIndex:-1};function XT(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>XT(n,e));if(hc(t)){if($O(t))return e.style=WO,L.cloneElement(t,e);if(XO(t))return L.cloneElement(t,e)}return t}function hc(t){return t&&typeof t=="object"&&"type"in t||!1}function $O(t){var e;return(e=t.props)==null?void 0:e.mapStyle}function XO(t){const e=t.type;return e&&e.deckGLViewProps}function rf(t){if(typeof t=="function")return L.createElement(zi,{},t);if(Array.isArray(t))return t.map(rf);if(hc(t)){if(t.type===L.Fragment)return rf(t.props.children);if(El(t.type,zi))return t}return t}function YO({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return L.Children.forEach(rf(t),o=>{if(hc(o)){const a=o.type;if(El(a,So)){const l=KO(a,o.props);i.push(l)}else r.push(o);if(El(a,zi)&&a!==zi&&o.props.id){const l=new a(o.props);s[l.id]=l}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function KO(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function qO({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,l=o;hc(o)&&El(o.type,zi)&&(a=o.props.id||s,l=o.props.children);const c=r.getViewport(a),u=r.getViewState(a);if(c){u.padding=c.padding;const{x:h,y:f,width:p,height:T}=c;l=XT(l,{x:h,y:f,width:p,height:T,viewport:c,viewState:u}),i[a]||(i[a]={viewport:c,children:[]}),i[a].children.push(l)}}return Object.keys(i).map(o=>{const{viewport:a,children:l}=i[o],{x:c,y:u,width:h,height:f}=a,p={position:"absolute",left:c,top:u,width:h,height:f},T=`view-${o}`,v=L.createElement("div",{key:T,id:T,style:p},...l);if(n){const S={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:m=>{m.viewId=o,e._onViewStateChange(m)}};return L.createElement(n,{key:T,value:S},v)}return v})}const ZO={mixBlendMode:null};function QO({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in ZO?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function JO(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function YT(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function GO(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():YT(t)}});return r}function eD(t,e){const[n,r]=L.useState(0),s=L.useRef({control:null,version:n,forceUpdate:()=>r(P=>P+1)}).current,o=L.useRef(null),a=L.useRef(null),l=L.useMemo(()=>YO(t),[t.layers,t.views,t.children]);let c=!0;const u=P=>{var I;return c&&t.viewState?(s.viewStateUpdateRequested=P,null):(s.viewStateUpdateRequested=null,(I=t.onViewStateChange)==null?void 0:I.call(t,P))},h=P=>{var I;c?s.interactionStateUpdateRequested=P:(s.interactionStateUpdateRequested=null,(I=t.onInteractionStateChange)==null||I.call(t,P))},f=L.useMemo(()=>{const P={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:u,onInteractionStateChange:h};return delete P._customRender,s.deck&&s.deck.setProps(P),P},[t]);L.useEffect(()=>{const P=t.Deck||Ad;return s.deck=GO(s,P,{...f,parent:o.current,canvas:a.current}),()=>{var I;return(I=s.deck)==null?void 0:I.finalize()}},[]),HO(()=>{YT(s);const{viewStateUpdateRequested:P,interactionStateUpdateRequested:I}=s;P&&u(P),I&&h(I)}),L.useImperativeHandle(e,()=>JO(s),[]);const p=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:T,width:v="100%",height:S="100%",id:m,style:g}=t,{containerStyle:y,canvasStyle:R}=L.useMemo(()=>QO({width:v,height:S,style:g}),[v,S,g]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===p||s.version!==n){s.lastRenderedViewports=p,s.version=n;const P=qO({children:l.children,deck:s.deck,ContextProvider:T}),I=L.createElement("canvas",{key:"canvas",id:m||"deckgl-overlay",ref:a,style:R});s.control=L.createElement("div",{id:`${m||"deckgl"}-wrapper`,ref:o,style:y},[I,P])}return c=!1,s.control}const tD=L.forwardRef(eD);/* @license
Papa Parse
v5.0.0-beta.0
https://github.com/mholt/PapaParse
License: MIT
*/const Tm="\uFEFF";function nD(t,e={},n=iD){e=e||{};var r=e.dynamicTyping||!1;Mt(r)&&(e.dynamicTypingFunction=r,r={}),e.dynamicTyping=r,e.transform=Mt(e.transform)?e.transform:!1;var i=new n(e);return i.stream(t)}function rD(t,e){var n=!1,r=!0,i=",",s=`\r
`,o='"',a=o+o,l=!1,c=null;h();var u=new RegExp(lo(o),"g");if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return f(null,t,l);if(typeof t[0]=="object")return f(c||Object.keys(t[0]),t,l)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:Object.keys(t.data[0])),!Array.isArray(t.data[0])&&typeof t.data[0]!="object"&&(t.data=[t.data])),f(t.fields||[],t.data||[],l);throw new Error("Unable to serialize unrecognized input");function h(){if(typeof e=="object"){if(typeof e.delimiter=="string"&&!_t.BAD_DELIMITERS.filter(function(v){return e.delimiter.indexOf(v)!==-1}).length&&(i=e.delimiter),(typeof e.quotes=="boolean"||Array.isArray(e.quotes))&&(n=e.quotes),(typeof e.skipEmptyLines=="boolean"||typeof e.skipEmptyLines=="string")&&(l=e.skipEmptyLines),typeof e.newline=="string"&&(s=e.newline),typeof e.quoteChar=="string"&&(o=e.quoteChar),typeof e.header=="boolean"&&(r=e.header),Array.isArray(e.columns)){if(e.columns.length===0)throw new Error("Option columns is empty");c=e.columns}e.escapeChar!==void 0&&(a=e.escapeChar+o)}}function f(v,S,m){var g="";typeof v=="string"&&(v=JSON.parse(v)),typeof S=="string"&&(S=JSON.parse(S));var y=Array.isArray(v)&&v.length>0,R=!Array.isArray(S[0]);if(y&&r){for(var P=0;P<v.length;P++)P>0&&(g+=i),g+=p(v[P],P);S.length>0&&(g+=s)}for(var I=0;I<S.length;I++){var k=y?v.length:S[I].length,N=!1,F=y?Object.keys(S[I]).length===0:S[I].length===0;if(m&&!y&&(N=m==="greedy"?S[I].join("").trim()==="":S[I].length===1&&S[I][0].length===0),m==="greedy"&&y){for(var O=[],H=0;H<k;H++){var W=R?v[H]:H;O.push(S[I][W])}N=O.join("").trim()===""}if(!N){for(var q=0;q<k;q++){q>0&&!F&&(g+=i);var K=y&&R?v[q]:q;g+=p(S[I][K],q)}I<S.length-1&&(!m||k>0&&!F)&&(g+=s)}}return g}function p(v,S){if(typeof v>"u"||v===null)return"";if(v.constructor===Date)return JSON.stringify(v).slice(1,25);v=v.toString().replace(u,a);var m=typeof n=="boolean"&&n||Array.isArray(n)&&n[S]||T(v,_t.BAD_DELIMITERS)||v.indexOf(i)>-1||v.charAt(0)===" "||v.charAt(v.length-1)===" ";return m?o+v+o:v}function T(v,S){for(var m=0;m<S.length;m++)if(v.indexOf(S[m])>-1)return!0;return!1}}let KT=class{constructor(e){d(this,"_handle");d(this,"_config");d(this,"_finished",!1);d(this,"_completed",!1);d(this,"_input",null);d(this,"_baseIndex",0);d(this,"_partialLine","");d(this,"_rowCount",0);d(this,"_start",0);d(this,"isFirstChunk",!0);d(this,"_completeResults",{data:[],errors:[],meta:{}});var n={...e};n.chunkSize=parseInt(n.chunkSize),!e.step&&!e.chunk&&(n.chunkSize=null),this._handle=new qT(n),this._handle.streamer=this,this._config=n}parseChunk(e,n){if(this.isFirstChunk&&Mt(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);r!==void 0&&(e=r)}this.isFirstChunk=!1;var i=this._partialLine+e;this._partialLine="";var s=this._handle.parse(i,this._baseIndex,!this._finished);if(!(this._handle.paused()||this._handle.aborted())){var o=s.meta.cursor;this._finished||(this._partialLine=i.substring(o-this._baseIndex),this._baseIndex=o),s&&s.data&&(this._rowCount+=s.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(Mt(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return;s=void 0,this._completeResults=void 0}return!this._config.step&&!this._config.chunk&&(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),!this._completed&&a&&Mt(this._config.complete)&&(!s||!s.meta.aborted)&&(this._config.complete(this._completeResults,this._input),this._completed=!0),s}}_sendError(e){Mt(this._config.error)&&this._config.error(e)}};class iD extends KT{constructor(n={}){super(n);d(this,"remaining")}stream(n){return this.remaining=n,this._nextChunk()}_nextChunk(){if(!this._finished){var n=this._config.chunkSize,r=n?this.remaining.substr(0,n):this.remaining;return this.remaining=n?this.remaining.substr(n):"",this._finished=!this.remaining,this.parseChunk(r)}}}const sD=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,oD=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/;class qT{constructor(e){d(this,"_config");d(this,"_stepCounter",0);d(this,"_rowCounter",0);d(this,"_input");d(this,"_parser");d(this,"_paused",!1);d(this,"_aborted",!1);d(this,"_delimiterError",!1);d(this,"_fields",[]);d(this,"_results",{data:[],errors:[],meta:{}});if(Mt(e.step)){var n=e.step;e.step=r=>{if(this._results=r,this.needsHeaderRow())this.processResults();else{if(this.processResults(),!this._results.data||this._results.data.length===0)return;this._stepCounter+=r.data.length,e.preview&&this._stepCounter>e.preview?this._parser.abort():n(this._results,this)}}}this._config=e}parse(e,n,r){var i=this._config.quoteChar||'"';if(this._config.newline||(this._config.newline=aD(e,i)),this._delimiterError=!1,this._config.delimiter)Mt(this._config.delimiter)&&(this._config.delimiter=this._config.delimiter(e),this._results.meta.delimiter=this._config.delimiter);else{var s=this.guessDelimiter(e,this._config.newline,this._config.skipEmptyLines,this._config.comments,this._config.delimitersToGuess);s.successful?this._config.delimiter=s.bestDelimiter:(this._delimiterError=!0,this._config.delimiter=_t.DefaultDelimiter),this._results.meta.delimiter=this._config.delimiter}var o=ZT(this._config);return this._config.preview&&this._config.header&&o.preview++,this._input=e,this._parser=new sf(o),this._results=this._parser.parse(this._input,n,r),this.processResults(),this._paused?{meta:{paused:!0}}:this._results||{meta:{paused:!1}}}paused(){return this._paused}pause(){this._paused=!0,this._parser.abort(),this._input=this._input.substr(this._parser.getCharIndex())}resume(){this._paused=!1,this.streamer.parseChunk(this._input,!0)}aborted(){return this._aborted}abort(){this._aborted=!0,this._parser.abort(),this._results.meta.aborted=!0,Mt(this._config.complete)&&this._config.complete(this._results),this._input=""}testEmptyLine(e){return this._config.skipEmptyLines==="greedy"?e.join("").trim()==="":e.length===1&&e[0].length===0}processResults(){if(this._results&&this._delimiterError&&(this.addError("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+_t.DefaultDelimiter+"'"),this._delimiterError=!1),this._config.skipEmptyLines)for(var e=0;e<this._results.data.length;e++)this.testEmptyLine(this._results.data[e])&&this._results.data.splice(e--,1);return this.needsHeaderRow()&&this.fillHeaderFields(),this.applyHeaderAndDynamicTypingAndTransformation()}needsHeaderRow(){return this._config.header&&this._fields.length===0}fillHeaderFields(){if(!this._results)return;const e=r=>{Mt(this._config.transformHeader)&&(r=this._config.transformHeader(r)),this._fields.push(r)};if(Array.isArray(this._results.data[0])){for(var n=0;this.needsHeaderRow()&&n<this._results.data.length;n++)this._results.data[n].forEach(e);this._results.data.splice(0,1)}else this._results.data.forEach(e)}shouldApplyDynamicTyping(e){return this._config.dynamicTypingFunction&&this._config.dynamicTyping[e]===void 0&&(this._config.dynamicTyping[e]=this._config.dynamicTypingFunction(e)),(this._config.dynamicTyping[e]||this._config.dynamicTyping)===!0}parseDynamic(e,n){return this.shouldApplyDynamicTyping(e)?n==="true"||n==="TRUE"?!0:n==="false"||n==="FALSE"?!1:sD.test(n)?parseFloat(n):oD.test(n)?new Date(n):n===""?null:n:n}applyHeaderAndDynamicTypingAndTransformation(){if(!this._results||!this._results.data||!this._config.header&&!this._config.dynamicTyping&&!this._config.transform)return this._results;var e=1;return!this._results.data[0]||Array.isArray(this._results.data[0])?(this._results.data=this._results.data.map(this.processRow.bind(this)),e=this._results.data.length):this._results.data=this.processRow(this._results.data,0),this._config.header&&this._results.meta&&(this._results.meta.fields=this._fields),this._rowCounter+=e,this._results}processRow(e,n){var r=this._config.header?{}:[],i;for(i=0;i<e.length;i++){var s=i,o=e[i];this._config.header&&(s=i>=this._fields.length?"__parsed_extra":this._fields[i]),this._config.transform&&(o=this._config.transform(o,s)),o=this.parseDynamic(s,o),s==="__parsed_extra"?(r[s]=r[s]||[],r[s].push(o)):r[s]=o}return this._config.header&&(i>this._fields.length?this.addError("FieldMismatch","TooManyFields","Too many fields: expected "+this._fields.length+" fields but parsed "+i,this._rowCounter+n):i<this._fields.length&&this.addError("FieldMismatch","TooFewFields","Too few fields: expected "+this._fields.length+" fields but parsed "+i,this._rowCounter+n)),r}guessDelimiter(e,n,r,i,s){var o,a,l;s=s||[",","	","|",";",_t.RECORD_SEP,_t.UNIT_SEP];for(var c=0;c<s.length;c++){var u=s[c],h=0,f=0,p=0;l=void 0;for(var T=new sf({comments:i,delimiter:u,newline:n,preview:10}).parse(e),v=0;v<T.data.length;v++){if(r&&this.testEmptyLine(T.data[v])){p++;continue}var S=T.data[v].length;if(f+=S,typeof l>"u"){l=0;continue}else S>1&&(h+=Math.abs(S-l),l=S)}T.data.length>0&&(f/=T.data.length-p),(typeof a>"u"||h>a)&&f>1.99&&(a=h,o=u)}return this._config.delimiter=o,{successful:!!o,bestDelimiter:o}}addError(e,n,r,i){this._results.errors.push({type:e,code:n,message:r,row:i})}}function aD(t,e){t=t.substr(0,1024*1024);var n=new RegExp(lo(e)+"([^]*?)"+lo(e),"gm");t=t.replace(n,"");var r=t.split("\r"),i=t.split(`
`),s=i.length>1&&i[0].length<r[0].length;if(r.length===1||s)return`
`;for(var o=0,a=0;a<r.length;a++)r[a][0]===`
`&&o++;return o>=r.length/2?`\r
`:"\r"}function lo(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function sf(t){t=t||{};var e=t.delimiter,n=t.newline,r=t.comments,i=t.step,s=t.preview,o=t.fastMode,a;t.quoteChar===void 0?a='"':a=t.quoteChar;var l=a;if(t.escapeChar!==void 0&&(l=t.escapeChar),(typeof e!="string"||_t.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),r===e)throw new Error("Comment character same as delimiter");r===!0?r="#":(typeof r!="string"||_t.BAD_DELIMITERS.indexOf(r)>-1)&&(r=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var c=0,u=!1;this.parse=function(h,f,p){if(typeof h!="string")throw new Error("Input must be a string");var T=h.length,v=e.length,S=n.length,m=r.length,g=Mt(i);c=0;var y=[],R=[],P=[],I=0;if(!h)return Y();if(o||o!==!1&&h.indexOf(a)===-1){for(var k=h.split(n),N=0;N<k.length;N++){const he=k[N];if(c+=he.length,N!==k.length-1)c+=n.length;else if(p)return Y();if(!(r&&he.substr(0,m)===r)){if(g){if(y=[],Et(he.split(e)),G(),u)return Y()}else Et(he.split(e));if(s&&N>=s)return y=y.slice(0,s),Y(!0)}}return Y()}for(var F=h.indexOf(e,c),O=h.indexOf(n,c),H=new RegExp(lo(l)+lo(a),"g"),W;;){if(h[c]===a){for(W=c,c++;;){if(W=h.indexOf(a,W+1),W===-1)return p||R.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:y.length,index:c}),$();if(W===T-1){var q=h.substring(c,W).replace(H,a);return $(q)}if(a===l&&h[W+1]===l){W++;continue}if(!(a!==l&&W!==0&&h[W-1]===l)){var K=O===-1?F:Math.min(F,O),We=V(K);if(h[W+1+We]===e){if(P.push(h.substring(c,W).replace(H,a)),c=W+1+We+v,F=h.indexOf(e,c),O=h.indexOf(n,c),g&&(G(),u))return Y();if(s&&y.length>=s)return Y(!0);break}var vn=V(O);if(h.substr(W+1+vn,S)===n){if(P.push(h.substring(c,W).replace(H,a)),X(W+1+vn+S),F=h.indexOf(e,c),g&&(G(),u))return Y();if(s&&y.length>=s)return Y(!0);break}R.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:y.length,index:c}),W++}}if(g&&(G(),u))return Y();if(s&&y.length>=s)return Y(!0);continue}if(r&&P.length===0&&h.substr(c,m)===r){if(O===-1)return Y();c=O+S,O=h.indexOf(n,c),F=h.indexOf(e,c);continue}if(F!==-1&&(F<O||O===-1)){P.push(h.substring(c,F)),c=F+v,F=h.indexOf(e,c);continue}if(O!==-1){if(P.push(h.substring(c,O)),X(O+S),g&&(G(),u))return Y();if(s&&y.length>=s)return Y(!0);continue}break}return $();function Et(he){y.push(he),I=c}function V(he){var Fe=0;if(he!==-1){var St=h.substring(W+1,he);St&&St.trim()===""&&(Fe=St.length)}return Fe}function $(he){return p||(typeof he>"u"&&(he=h.substr(c)),P.push(he),c=T,Et(P),g&&G()),Y()}function X(he){c=he,Et(P),P=[],O=h.indexOf(n,c)}function Y(he,Fe){var St=Fe||!1;return{data:St?y[0]:y,errors:R,meta:{delimiter:e,linebreak:n,aborted:u,truncated:!!he,cursor:I+(f||0)}}}function G(){i(Y(void 0,!0)),y=[],R=[]}},this.abort=function(){u=!0},this.getCharIndex=function(){return c}}function ZT(t){if(typeof t!="object"||t===null)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=ZT(t[n]);return e}function Mt(t){return typeof t=="function"}const _t={parse:nD,unparse:rD,RECORD_SEP:"",UNIT_SEP:"",BYTE_ORDER_MARK:Tm,BAD_DELIMITERS:["\r",`
`,'"',Tm],WORKERS_SUPPORTED:!1,NODE_STREAM_INPUT:1,LocalChunkSize:1024*1024*10,RemoteChunkSize:1024*1024*5,DefaultDelimiter:",",Parser:sf,ParserHandle:qT,ChunkStreamer:KT},{ChunkStreamer:lD}=_t;class cD extends lD{constructor(n={}){super(n);d(this,"textDecoder",new TextDecoder(this._config.encoding))}async stream(n){this._input=n;try{for await(const r of n)this.parseChunk(this.getStringChunk(r));this._finished=!0,this.parseChunk("")}catch(r){this._sendError(r)}}_nextChunk(){}getStringChunk(n){return typeof n=="string"?n:this.textDecoder.decode(n,{stream:!0})}}const uD="4.3.1",xd="object-row-table",Id={dataType:null,batchType:null,id:"csv",module:"csv",name:"CSV",version:uD,extensions:["csv","tsv","dsv"],mimeTypes:["text/csv","text/tab-separated-values","text/dsv"],category:"table",parse:async(t,e)=>wm(new TextDecoder().decode(t),e),parseText:(t,e)=>wm(t,e),parseInBatches:hD,options:{csv:{shape:xd,optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","	","|",";"]}}};async function wm(t,e){const n={...Id.options.csv,...e==null?void 0:e.csv},r=fD(t),s=n.header==="auto"?QT(r):!!n.header,o={...n,header:s,download:!1,transformHeader:s?JT():void 0,error:h=>{throw new Error(h)}},a=_t.parse(t,o),l=a.data,c=a.meta.fields||GT(n.columnPrefix,r.length),u=n.shape||xd;switch(u){case"object-row-table":return{shape:"object-row-table",data:l.map(h=>Array.isArray(h)?nv(h,c):h)};case"array-row-table":return{shape:"array-row-table",data:l.map(h=>Array.isArray(h)?h:rv(h,c))};default:throw new Error(u)}}function hD(t,e){e={...e},e.batchSize==="auto"&&(e.batchSize=4e3);const n={...Id.options.csv,...e==null?void 0:e.csv},r=new wR;let i=!0,s=null,o=null,a=null;const l={...n,header:!1,download:!1,chunkSize:1024*1024*5,skipEmptyLines:!1,step(c){let u=c.data;if(n.skipEmptyLines&&u.flat().join("").trim()==="")return;const h=c.meta.cursor;if(i&&!s&&(n.header==="auto"?QT(u):!!n.header)){s=u.map(JT());return}i&&(i=!1,s||(s=GT(n.columnPrefix,u.length)),a=dD(u,s)),n.optimizeMemoryUsage&&(u=JSON.parse(JSON.stringify(u)));const f=n.shape||xd;o=o||new Th(a,{shape:f,...e});try{o.addRow(u);const p=o&&o.getFullBatch({bytesUsed:h});p&&r.enqueue(p)}catch(p){r.enqueue(p)}},complete(c){try{const u=c.meta.cursor,h=o&&o.getFinalBatch({bytesUsed:u});h&&r.enqueue(h)}catch(u){r.enqueue(u)}r.close()}};return _t.parse(t,l,cD),r}function QT(t){return t&&t.every(e=>typeof e=="string")}function fD(t){return _t.parse(t,{dynamicTyping:!0,preview:1}).data[0]}function JT(){const t=new Set;return e=>{let n=e,r=1;for(;t.has(n);)n=`${e}.${r}`,r++;return t.add(n),n}}function GT(t,e=0){const n=[];for(let r=0;r<e;r++)n.push(`${t}${r+1}`);return n}function dD(t,e){const n=e?{}:[];for(let r=0;r<t.length;r++){const i=e&&e[r]||r;switch(typeof t[r]){case"number":case"boolean":n[i]={name:String(i),index:r,type:Float32Array};break;case"string":default:n[i]={name:String(i),index:r,type:Array}}}return n}const pD=({value:t,min:e,max:n,step:r,onChange:i})=>{L.useEffect(()=>{const p=document.getElementsByClassName("tick-slider-input");for(let T of p)o(T),a(T),l(T),c(T),h(T);return window.addEventListener("resize",f),()=>window.removeEventListener("resize",f)},[]);const s=p=>{const T=p.target;o(T),a(T),l(T),c(T),i(T.value)},o=p=>{let T=document.getElementById(p.dataset.valueId);T.innerHTML="<div>"+p.value+"</div>"},a=p=>{let T=document.getElementById(p.dataset.valueId);const v=u(p),S=p.getBoundingClientRect().width,m=T.getBoundingClientRect().width,g=p.dataset.handleSize;let y=v*(S-g)+g/2-m/2;y=Math.min(y,S-m),y=p.value===p.min?0:y,T.style.left=y+"px"},l=p=>{const T=document.getElementById(p.dataset.valueId),v=document.getElementById(p.dataset.minLabelId),S=document.getElementById(p.dataset.maxLabelId),m=T.getBoundingClientRect(),g=v.getBoundingClientRect(),y=S.getBoundingClientRect(),R=m.left-g.left,P=y.left-m.left,I=32;R<I?v.classList.add("hidden"):v.classList.remove("hidden"),P<I?S.classList.add("hidden"):S.classList.remove("hidden")},c=p=>{let T=document.getElementById(p.dataset.progressId);const v=u(p);T.style.width=v*100+"%"},u=p=>{const T=p.max-p.min;return(p.value-p.min)/T},h=p=>{let T=document.getElementById(p.dataset.tickId);const v=parseFloat(p.dataset.tickStep),m=(p.max-p.min)/v+1;for(let g=0;g<m;g++){let y=document.createElement("span");y.className="tick-slider-tick",T.appendChild(y)}},f=()=>{const p=document.getElementsByClassName("tick-slider-input");for(let T of p)a(T)};return oe.jsx("div",{id:"wrapper",children:oe.jsx("div",{id:"sliderContainer",children:oe.jsxs("div",{className:"tick-slider",children:[oe.jsxs("div",{className:"tick-slider-header",children:[oe.jsx("h5",{children:oe.jsx("label",{htmlFor:"radiusSlider",children:"Raio"})}),oe.jsx("h5",{children:"metros"})]}),oe.jsxs("div",{className:"tick-slider-value-container",children:[oe.jsx("div",{id:"radiusLabelMin",className:"tick-slider-label",children:e}),oe.jsx("div",{id:"radiusLabelMax",className:"tick-slider-label",children:n}),oe.jsx("div",{id:"radiusValue",className:"tick-slider-value"})]}),oe.jsx("div",{className:"tick-slider-background"}),oe.jsx("div",{id:"radiusProgress",className:"tick-slider-progress"}),oe.jsx("div",{id:"radiusTicks",className:"tick-slider-tick-container"}),oe.jsx("input",{id:"radiusSlider",className:"tick-slider-input",type:"range",min:e,max:n,step:r,value:t,"data-tick-step":r,"data-tick-id":"radiusTicks","data-value-id":"radiusValue","data-progress-id":"radiusProgress","data-handle-size":"18","data-min-label-id":"radiusLabelMin","data-max-label-id":"radiusLabelMax",onInput:s})]})})})},gD="https://docs.google.com/spreadsheets/d/e/2PACX-1vTuxVeI--E1Jue1Ir2qdwwefyGhF77WCaTOcR2iHJ81ylB1VjjfVpxALN8wVJqTmQ/pub?gid=1334782578&single=true&output=csv",_D=new qv({color:[255,255,255],intensity:1}),mD=new Gv({color:[255,255,255],intensity:.8,position:[-.144528,49.739968,8e4]}),yD=new Gv({color:[255,255,255],intensity:.8,position:[-3.807751,54.104682,8e3]}),vD=new md({ambientLight:_D,pointLight1:mD,pointLight2:yD}),ha=window.innerWidth<=768,TD={longitude:ha?-43.0995390451405:-43.0989390451405,latitude:-22.934947215826018,zoom:ha?14.9:16.4,minZoom:5,maxZoom:18.4,pitch:ha?40:40.5,bearing:-27},wD="https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",ED=[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]];function SD({object:t}){if(!t)return null;const e=t.points.reduce((n,r)=>{const i=r.source.status;return n[i]=(n[i]||0)+1,n},{});return{html:`
      <div style="padding: 10px; font-size: 14px;">
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
          <span style="width: 10px; height: 10px; background-color: #4caf50; border-radius: 50%; margin-right: 8px;"></span>
          <span>Quitado:  <b>${e.QUITADO||0}</b></span>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
          <span style="width: 10px; height: 10px; background-color: #2196f3; border-radius: 50%; margin-right: 8px;"></span>
          <span>Pagando:  <b>${e.PAGANDO||0}</b></span>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
          <span style="width: 10px; height: 10px; background-color: #f44336; border-radius: 50%; margin-right: 8px;"></span>
          <span>Cancelado:  <b>${e.CANCELADO||0}</b></span>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
          <span style="width: 10px; height: 10px; background-color: #ff9800; border-radius: 50%; margin-right: 8px;"></span>
          <span>Pg.Juros/Parc.:  <b>${e["PAGO COM JUROS/PAGO PARCIAL"]||0}</b></span>
        </div>
        <div style="display: flex; align-items: center; margin-bottom: 5px;">
          <span style="width: 10px; height: 10px; background-color: #9c27b0; border-radius: 50%; margin-right: 8px;"></span>
          <span>Solic. Repr.:  <b>${e["SOLICITAO REPROVADA"]||0}</b></span>
        </div>
        <div style="display: flex; align-items: center;">
          <span style="width: 10px; height: 10px; background-color: #ff5722; border-radius: 50%; margin-right: 8px;"></span>
          <span>Inadimplente: <b>${e.INADIMPLENTE||0}</b></span>
        </div>
      </div>
    `}}const AD=({data:t=null,mapStyle:e=wD,radius:n=50,upperPercentile:r=100,coverage:i=1})=>{const[s,o]=L.useState(null),[a,l]=L.useState(n);L.useEffect(()=>{(async()=>{const f=(await tl(gD,Id)).data.map(p=>({lng:p.lng,lat:p.lat,status:p.status}));o(f)})()},[]);const c=[new Pd({id:"heatmap",colorRange:ED,coverage:i,data:s,elevationRange:[0,100],elevationScale:s&&s.length?5:0,opacity:.5,extruded:!0,getPosition:u=>[u.lng,u.lat],pickable:!0,radius:a,upperPercentile:r,material:{ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]},transitions:{elevationScale:3e3}})];return oe.jsxs("div",{children:[oe.jsx(tD,{layers:c,effects:[vD],initialViewState:TD,controller:!0,getTooltip:SD,children:oe.jsx(P1,{reuseMaps:!0,mapStyle:e})}),oe.jsx("div",{className:"icon",style:{position:"fixed",zIndex:1},children:oe.jsx("a",{href:"https://www.instagram.com/bancopreve/",target:"_blank",children:oe.jsx("img",{src:"icon.png",alt:"Map Overlay",style:{width:"40px",height:"auto"}})})}),oe.jsx("div",{style:{position:"fixed",bottom:80,left:"50%",transform:"translateX(-50%)",width:"80%",maxWidth:"600px",zIndex:1},children:oe.jsx(pD,{value:a,min:50,max:300,step:10,onChange:l})})]})},RD=()=>oe.jsx(AD,{});D0(document.getElementById("root")).render(oe.jsx(L.StrictMode,{children:oe.jsx(RD,{})}));export{CD as c,Iw as g};
